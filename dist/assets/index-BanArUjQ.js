var Ii=Object.defineProperty;var ki=(C,e,t)=>e in C?Ii(C,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):C[e]=t;var d=(C,e,t)=>ki(C,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();class Bs{constructor(){d(this,"entries",{});d(this,"size",0)}add(e){let t=this.entries[e];return this.entries[e]=!0,t?!1:(this.size++,!0)}addAll(e){let t=this.size;for(var i=0,s=e.length;i<s;i++)this.add(e[i]);return t!=this.size}contains(e){return this.entries[e]}clear(){this.entries={},this.size=0}}const Le=class Le{constructor(e=0,t=0,i=0,s=0){d(this,"r");d(this,"g");d(this,"b");d(this,"a");this.r=e,this.g=t,this.b=i,this.a=s}set(e,t,i,s){return this.r=e,this.g=t,this.b=i,this.a=s,this.clamp()}setFromColor(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}setFromString(e){return e=e.charAt(0)=="#"?e.substr(1):e,this.r=parseInt(e.substr(0,2),16)/255,this.g=parseInt(e.substr(2,2),16)/255,this.b=parseInt(e.substr(4,2),16)/255,this.a=e.length!=8?1:parseInt(e.substr(6,2),16)/255,this}add(e,t,i,s){return this.r+=e,this.g+=t,this.b+=i,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(e,t){e.r=((t&4278190080)>>>24)/255,e.g=((t&16711680)>>>16)/255,e.b=((t&65280)>>>8)/255,e.a=(t&255)/255}static rgb888ToColor(e,t){e.r=((t&16711680)>>>16)/255,e.g=((t&65280)>>>8)/255,e.b=(t&255)/255}toRgb888(){const e=t=>("0"+(t*255).toString(16)).slice(-2);return+("0x"+e(this.r)+e(this.g)+e(this.b))}static fromString(e){return new Le().setFromString(e)}};d(Le,"WHITE",new Le(1,1,1,1)),d(Le,"RED",new Le(1,0,0,1)),d(Le,"GREEN",new Le(0,1,0,1)),d(Le,"BLUE",new Le(0,0,1,1)),d(Le,"MAGENTA",new Le(1,0,1,1));let N=Le;const ye=class ye{static clamp(e,t,i){return e<t?t:e>i?i:e}static cosDeg(e){return Math.cos(e*ye.degRad)}static sinDeg(e){return Math.sin(e*ye.degRad)}static atan2Deg(e,t){return Math.atan2(e,t)*ye.degRad}static signum(e){return e>0?1:e<0?-1:0}static toInt(e){return e>0?Math.floor(e):Math.ceil(e)}static cbrt(e){let t=Math.pow(Math.abs(e),.3333333333333333);return e<0?-t:t}static randomTriangular(e,t){return ye.randomTriangularWith(e,t,(e+t)*.5)}static randomTriangularWith(e,t,i){let s=Math.random(),r=t-e;return s<=(i-e)/r?e+Math.sqrt(s*r*(i-e)):t-Math.sqrt((1-s)*r*(t-i))}static isPowerOfTwo(e){return e&&(e&e-1)===0}};d(ye,"PI",3.1415927),d(ye,"PI2",ye.PI*2),d(ye,"invPI2",1/ye.PI2),d(ye,"radiansToDegrees",180/ye.PI),d(ye,"radDeg",ye.radiansToDegrees),d(ye,"degreesToRadians",ye.PI/180),d(ye,"degRad",ye.degreesToRadians);let V=ye;const _e=class _e{static arrayCopy(e,t,i,s,r){for(let o=t,a=s;o<t+r;o++,a++)i[a]=e[o]}static arrayFill(e,t,i,s){for(let r=t;r<i;r++)e[r]=s}static setArraySize(e,t,i=0){let s=e.length;if(s==t)return e;if(e.length=t,s<t)for(let r=s;r<t;r++)e[r]=i;return e}static ensureArrayCapacity(e,t,i=0){return e.length>=t?e:_e.setArraySize(e,t,i)}static newArray(e,t){let i=new Array(e);for(let s=0;s<e;s++)i[s]=t;return i}static newFloatArray(e){if(_e.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);{let t=new Array(e);for(let i=0;i<t.length;i++)t[i]=0;return t}}static newShortArray(e){if(_e.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);{let t=new Array(e);for(let i=0;i<t.length;i++)t[i]=0;return t}}static toFloatArray(e){return _e.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}static toSinglePrecision(e){return _e.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}static webkit602BugfixHelper(e,t){}static contains(e,t,i=!0){for(var s=0;s<e.length;s++)if(e[s]==t)return!0;return!1}static enumValue(e,t){return e[t[0].toUpperCase()+t.slice(1)]}};d(_e,"SUPPORTS_TYPED_ARRAYS",typeof Float32Array<"u");let O=_e;class Bt{constructor(e){d(this,"items",new Array);d(this,"instantiator");this.instantiator=e}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(e){e.reset&&e.reset(),this.items.push(e)}freeAll(e){for(let t=0;t<e.length;t++)this.free(e[t])}clear(){this.items.length=0}}class qe{constructor(e=0,t=0){d(this,"x");d(this,"y");this.x=e,this.y=t}set(e,t){return this.x=e,this.y=t,this}length(){let e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}normalize(){let e=this.length();return e!=0&&(this.x/=e,this.y/=e),this}}class Ps{constructor(){d(this,"maxDelta",.064);d(this,"framesPerSecond",0);d(this,"delta",0);d(this,"totalTime",0);d(this,"lastTime",Date.now()/1e3);d(this,"frameCount",0);d(this,"frameTime",0)}update(){let e=Date.now()/1e3;this.delta=e-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=e,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}class Vs{constructor(e){d(this,"name");if(!e)throw new Error("name cannot be null.");this.name=e}}const zt=class zt extends Vs{constructor(t){super(t);d(this,"id",zt.nextID++);d(this,"bones",null);d(this,"vertices",[]);d(this,"worldVerticesLength",0);d(this,"timelineAttachment",this)}computeWorldVertices(t,i,s,r,o,a){s=o+(s>>1)*a;let h=t.bone.skeleton,n=t.deform,l=this.vertices,c=this.bones;if(!c){n.length>0&&(l=n);let g=t.bone,p=g.worldX,b=g.worldY,y=g.a,w=g.b,x=g.c,A=g.d;for(let v=i,S=o;S<s;v+=2,S+=a){let E=l[v],I=l[v+1];r[S]=E*y+I*w+p,r[S+1]=E*x+I*A+b}return}let u=0,f=0;for(let g=0;g<i;g+=2){let p=c[u];u+=p+1,f+=p}let m=h.bones;if(n.length==0)for(let g=o,p=f*3;g<s;g+=a){let b=0,y=0,w=c[u++];for(w+=u;u<w;u++,p+=3){let x=m[c[u]],A=l[p],v=l[p+1],S=l[p+2];b+=(A*x.a+v*x.b+x.worldX)*S,y+=(A*x.c+v*x.d+x.worldY)*S}r[g]=b,r[g+1]=y}else{let g=n;for(let p=o,b=f*3,y=f<<1;p<s;p+=a){let w=0,x=0,A=c[u++];for(A+=u;u<A;u++,b+=3,y+=2){let v=m[c[u]],S=l[b]+g[y],E=l[b+1]+g[y+1],I=l[b+2];w+=(S*v.a+E*v.b+v.worldX)*I,x+=(S*v.c+E*v.d+v.worldY)*I}r[p]=w,r[p+1]=x}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),O.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=O.newFloatArray(this.vertices.length),O.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}};d(zt,"nextID",0);let De=zt;const ft=class ft{constructor(e){d(this,"id",ft.nextID());d(this,"regions");d(this,"start",0);d(this,"digits",0);d(this,"setupIndex",0);this.regions=new Array(e)}copy(){let e=new ft(this.regions.length);return O.arrayCopy(this.regions,0,e.regions,0,this.regions.length),e.start=this.start,e.digits=this.digits,e.setupIndex=this.setupIndex,e}apply(e,t){let i=e.sequenceIndex;i==-1&&(i=this.setupIndex),i>=this.regions.length&&(i=this.regions.length-1);let s=this.regions[i];t.region!=s&&(t.region=s,t.updateRegion())}getPath(e,t){let i=e,s=(this.start+t).toString();for(let r=this.digits-s.length;r>0;r--)i+="0";return i+=s,i}static nextID(){return ft._nextID++}};d(ft,"_nextID",0);let Pt=ft;var Ae;(function(C){C[C.hold=0]="hold",C[C.once=1]="once",C[C.loop=2]="loop",C[C.pingpong=3]="pingpong",C[C.onceReverse=4]="onceReverse",C[C.loopReverse=5]="loopReverse",C[C.pingpongReverse=6]="pingpongReverse"})(Ae||(Ae={}));const Os=[Ae.hold,Ae.once,Ae.loop,Ae.pingpong,Ae.onceReverse,Ae.loopReverse,Ae.pingpongReverse];class fs{constructor(e,t,i){d(this,"name");d(this,"timelines",[]);d(this,"timelineIds",new Bs);d(this,"duration");if(!e)throw new Error("name cannot be null.");this.name=e,this.setTimelines(t),this.duration=i}setTimelines(e){if(!e)throw new Error("timelines cannot be null.");this.timelines=e,this.timelineIds.clear();for(var t=0;t<e.length;t++)this.timelineIds.addAll(e[t].getPropertyIds())}hasTimeline(e){for(let t=0;t<e.length;t++)if(this.timelineIds.contains(e[t]))return!0;return!1}apply(e,t,i,s,r,o,a,h){if(!e)throw new Error("skeleton cannot be null.");s&&this.duration!=0&&(i%=this.duration,t>0&&(t%=this.duration));let n=this.timelines;for(let l=0,c=n.length;l<c;l++)n[l].apply(e,t,i,r,o,a,h)}}var P;(function(C){C[C.setup=0]="setup",C[C.first=1]="first",C[C.replace=2]="replace",C[C.add=3]="add"})(P||(P={}));var Ce;(function(C){C[C.mixIn=0]="mixIn",C[C.mixOut=1]="mixOut"})(Ce||(Ce={}));const ae={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class pe{constructor(e,t){d(this,"propertyIds");d(this,"frames");this.propertyIds=t,this.frames=O.newFloatArray(e*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(e,t){let i=e.length;for(let s=1;s<i;s++)if(e[s]>t)return s-1;return i-1}static search(e,t,i){let s=e.length;for(let r=i;r<s;r+=i)if(e[r]>t)return r-i;return s-i}}class He extends pe{constructor(t,i,s){super(t,s);d(this,"curves");this.curves=O.newFloatArray(t+i*18),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){let i=this.getFrameCount()+t*18;if(this.curves.length>i){let s=O.newFloatArray(i);O.arrayCopy(this.curves,0,s,0,i),this.curves=s}}setBezier(t,i,s,r,o,a,h,n,l,c,u){let f=this.curves,m=this.getFrameCount()+t*18;s==0&&(f[i]=2+m);let g=(r-a*2+n)*.03,p=(o-h*2+l)*.03,b=((a-n)*3-r+c)*.006,y=((h-l)*3-o+u)*.006,w=g*2+b,x=p*2+y,A=(a-r)*.3+g+b*.16666667,v=(h-o)*.3+p+y*.16666667,S=r+A,E=o+v;for(let I=m+18;m<I;m+=2)f[m]=S,f[m+1]=E,A+=w,v+=x,w+=b,x+=y,S+=A,E+=v}getBezierValue(t,i,s,r){let o=this.curves;if(o[r]>t){let l=this.frames[i],c=this.frames[i+s];return c+(t-l)/(o[r]-l)*(o[r+1]-c)}let a=r+18;for(r+=2;r<a;r+=2)if(o[r]>=t){let l=o[r-2],c=o[r-1];return c+(t-l)/(o[r]-l)*(o[r+1]-c)}i+=this.getFrameEntries();let h=o[a-2],n=o[a-1];return n+(t-h)/(this.frames[i]-h)*(this.frames[i+s]-n)}}class Ue extends He{constructor(e,t,i){super(e,t,[i])}getFrameEntries(){return 2}setFrame(e,t,i){e<<=1,this.frames[e]=t,this.frames[e+1]=i}getCurveValue(e){let t=this.frames,i=t.length-2;for(let r=2;r<=i;r+=2)if(t[r]>e){i=r-2;break}let s=this.curves[i>>1];switch(s){case 0:let r=t[i],o=t[i+1];return o+(e-r)/(t[i+2]-r)*(t[i+2+1]-o);case 1:return t[i+1]}return this.getBezierValue(e,i,1,s-2)}getRelativeValue(e,t,i,s,r){if(e<this.frames[0]){switch(i){case P.setup:return r;case P.first:return s+(r-s)*t}return s}let o=this.getCurveValue(e);switch(i){case P.setup:return r+o*t;case P.first:case P.replace:o+=r-s}return s+o*t}getAbsoluteValue(e,t,i,s,r){if(e<this.frames[0]){switch(i){case P.setup:return r;case P.first:return s+(r-s)*t}return s}let o=this.getCurveValue(e);return i==P.setup?r+(o-r)*t:s+(o-s)*t}getAbsoluteValue2(e,t,i,s,r,o){if(e<this.frames[0]){switch(i){case P.setup:return r;case P.first:return s+(r-s)*t}return s}return i==P.setup?r+(o-r)*t:s+(o-s)*t}getScaleValue(e,t,i,s,r,o){const a=this.frames;if(e<a[0]){switch(i){case P.setup:return o;case P.first:return r+(o-r)*t}return r}let h=this.getCurveValue(e)*o;if(t==1)return i==P.add?r+h-o:h;if(s==Ce.mixOut)switch(i){case P.setup:return o+(Math.abs(h)*V.signum(o)-o)*t;case P.first:case P.replace:return r+(Math.abs(h)*V.signum(r)-r)*t}else{let n=0;switch(i){case P.setup:return n=Math.abs(o)*V.signum(h),n+(h-n)*t;case P.first:case P.replace:return n=Math.abs(r)*V.signum(h),n+(h-n)*t}}return r+(h-o)*t}}class us extends He{constructor(e,t,i,s){super(e,t,[i,s])}getFrameEntries(){return 3}setFrame(e,t,i,s){e*=3,this.frames[e]=t,this.frames[e+1]=i,this.frames[e+2]=s}}class Vt extends Ue{constructor(t,i,s){super(t,i,ae.rotate+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];n.active&&(n.rotation=this.getRelativeValue(s,o,a,n.rotation,n.data.rotation))}}class Ns extends us{constructor(t,i,s){super(t,i,ae.x+"|"+s,ae.y+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];if(!n.active)return;let l=this.frames;if(s<l[0]){switch(a){case P.setup:n.x=n.data.x,n.y=n.data.y;return;case P.first:n.x+=(n.data.x-n.x)*o,n.y+=(n.data.y-n.y)*o}return}let c=0,u=0,f=pe.search(l,s,3),m=this.curves[f/3];switch(m){case 0:let g=l[f];c=l[f+1],u=l[f+2];let p=(s-g)/(l[f+3]-g);c+=(l[f+3+1]-c)*p,u+=(l[f+3+2]-u)*p;break;case 1:c=l[f+1],u=l[f+2];break;default:c=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}switch(a){case P.setup:n.x=n.data.x+c*o,n.y=n.data.y+u*o;break;case P.first:case P.replace:n.x+=(n.data.x+c-n.x)*o,n.y+=(n.data.y+u-n.y)*o;break;case P.add:n.x+=c*o,n.y+=u*o}}}class Ds extends Ue{constructor(t,i,s){super(t,i,ae.x+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];n.active&&(n.x=this.getRelativeValue(s,o,a,n.x,n.data.x))}}class Us extends Ue{constructor(t,i,s){super(t,i,ae.y+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];n.active&&(n.y=this.getRelativeValue(s,o,a,n.y,n.data.y))}}class zs extends us{constructor(t,i,s){super(t,i,ae.scaleX+"|"+s,ae.scaleY+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];if(!n.active)return;let l=this.frames;if(s<l[0]){switch(a){case P.setup:n.scaleX=n.data.scaleX,n.scaleY=n.data.scaleY;return;case P.first:n.scaleX+=(n.data.scaleX-n.scaleX)*o,n.scaleY+=(n.data.scaleY-n.scaleY)*o}return}let c,u,f=pe.search(l,s,3),m=this.curves[f/3];switch(m){case 0:let g=l[f];c=l[f+1],u=l[f+2];let p=(s-g)/(l[f+3]-g);c+=(l[f+3+1]-c)*p,u+=(l[f+3+2]-u)*p;break;case 1:c=l[f+1],u=l[f+2];break;default:c=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}if(c*=n.data.scaleX,u*=n.data.scaleY,o==1)a==P.add?(n.scaleX+=c-n.data.scaleX,n.scaleY+=u-n.data.scaleY):(n.scaleX=c,n.scaleY=u);else{let g=0,p=0;if(h==Ce.mixOut)switch(a){case P.setup:g=n.data.scaleX,p=n.data.scaleY,n.scaleX=g+(Math.abs(c)*V.signum(g)-g)*o,n.scaleY=p+(Math.abs(u)*V.signum(p)-p)*o;break;case P.first:case P.replace:g=n.scaleX,p=n.scaleY,n.scaleX=g+(Math.abs(c)*V.signum(g)-g)*o,n.scaleY=p+(Math.abs(u)*V.signum(p)-p)*o;break;case P.add:n.scaleX+=(c-n.data.scaleX)*o,n.scaleY+=(u-n.data.scaleY)*o}else switch(a){case P.setup:g=Math.abs(n.data.scaleX)*V.signum(c),p=Math.abs(n.data.scaleY)*V.signum(u),n.scaleX=g+(c-g)*o,n.scaleY=p+(u-p)*o;break;case P.first:case P.replace:g=Math.abs(n.scaleX)*V.signum(c),p=Math.abs(n.scaleY)*V.signum(u),n.scaleX=g+(c-g)*o,n.scaleY=p+(u-p)*o;break;case P.add:n.scaleX+=(c-n.data.scaleX)*o,n.scaleY+=(u-n.data.scaleY)*o}}}}class Ws extends Ue{constructor(t,i,s){super(t,i,ae.scaleX+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];n.active&&(n.scaleX=this.getScaleValue(s,o,a,h,n.scaleX,n.data.scaleX))}}class qs extends Ue{constructor(t,i,s){super(t,i,ae.scaleY+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];n.active&&(n.scaleY=this.getScaleValue(s,o,a,h,n.scaleY,n.data.scaleY))}}class Gs extends us{constructor(t,i,s){super(t,i,ae.shearX+"|"+s,ae.shearY+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];if(!n.active)return;let l=this.frames;if(s<l[0]){switch(a){case P.setup:n.shearX=n.data.shearX,n.shearY=n.data.shearY;return;case P.first:n.shearX+=(n.data.shearX-n.shearX)*o,n.shearY+=(n.data.shearY-n.shearY)*o}return}let c=0,u=0,f=pe.search(l,s,3),m=this.curves[f/3];switch(m){case 0:let g=l[f];c=l[f+1],u=l[f+2];let p=(s-g)/(l[f+3]-g);c+=(l[f+3+1]-c)*p,u+=(l[f+3+2]-u)*p;break;case 1:c=l[f+1],u=l[f+2];break;default:c=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}switch(a){case P.setup:n.shearX=n.data.shearX+c*o,n.shearY=n.data.shearY+u*o;break;case P.first:case P.replace:n.shearX+=(n.data.shearX+c-n.shearX)*o,n.shearY+=(n.data.shearY+u-n.shearY)*o;break;case P.add:n.shearX+=c*o,n.shearY+=u*o}}}class Hs extends Ue{constructor(t,i,s){super(t,i,ae.shearX+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];n.active&&(n.shearX=this.getRelativeValue(s,o,a,n.shearX,n.data.shearX))}}class js extends Ue{constructor(t,i,s){super(t,i,ae.shearY+"|"+s);d(this,"boneIndex",0);this.boneIndex=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];n.active&&(n.shearY=this.getRelativeValue(s,o,a,n.shearY,n.data.shearY))}}class Zs extends pe{constructor(t,i){super(t,[ae.inherit+"|"+i]);d(this,"boneIndex",0);this.boneIndex=i}getFrameEntries(){return 2}setFrame(t,i,s){t*=2,this.frames[t]=i,this.frames[t+1]=s}apply(t,i,s,r,o,a,h){let n=t.bones[this.boneIndex];if(!n.active)return;if(h==Ce.mixOut){a==P.setup&&(n.inherit=n.data.inherit);return}let l=this.frames;if(s<l[0]){(a==P.setup||a==P.first)&&(n.inherit=n.data.inherit);return}n.inherit=this.frames[pe.search(l,s,2)+1]}}class Js extends He{constructor(t,i,s){super(t,i,[ae.rgb+"|"+s,ae.alpha+"|"+s]);d(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 5}setFrame(t,i,s,r,o,a){t*=5,this.frames[t]=i,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=o,this.frames[t+4]=a}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(!n.bone.active)return;let l=this.frames,c=n.color;if(s<l[0]){let y=n.data.color;switch(a){case P.setup:c.setFromColor(y);return;case P.first:c.add((y.r-c.r)*o,(y.g-c.g)*o,(y.b-c.b)*o,(y.a-c.a)*o)}return}let u=0,f=0,m=0,g=0,p=pe.search(l,s,5),b=this.curves[p/5];switch(b){case 0:let y=l[p];u=l[p+1],f=l[p+2],m=l[p+3],g=l[p+4];let w=(s-y)/(l[p+5]-y);u+=(l[p+5+1]-u)*w,f+=(l[p+5+2]-f)*w,m+=(l[p+5+3]-m)*w,g+=(l[p+5+4]-g)*w;break;case 1:u=l[p+1],f=l[p+2],m=l[p+3],g=l[p+4];break;default:u=this.getBezierValue(s,p,1,b-2),f=this.getBezierValue(s,p,2,b+18-2),m=this.getBezierValue(s,p,3,b+18*2-2),g=this.getBezierValue(s,p,4,b+18*3-2)}o==1?c.set(u,f,m,g):(a==P.setup&&c.setFromColor(n.data.color),c.add((u-c.r)*o,(f-c.g)*o,(m-c.b)*o,(g-c.a)*o))}}class Ks extends He{constructor(t,i,s){super(t,i,[ae.rgb+"|"+s]);d(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 4}setFrame(t,i,s,r,o){t<<=2,this.frames[t]=i,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=o}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(!n.bone.active)return;let l=this.frames,c=n.color;if(s<l[0]){let b=n.data.color;switch(a){case P.setup:c.r=b.r,c.g=b.g,c.b=b.b;return;case P.first:c.r+=(b.r-c.r)*o,c.g+=(b.g-c.g)*o,c.b+=(b.b-c.b)*o}return}let u=0,f=0,m=0,g=pe.search(l,s,4),p=this.curves[g>>2];switch(p){case 0:let b=l[g];u=l[g+1],f=l[g+2],m=l[g+3];let y=(s-b)/(l[g+4]-b);u+=(l[g+4+1]-u)*y,f+=(l[g+4+2]-f)*y,m+=(l[g+4+3]-m)*y;break;case 1:u=l[g+1],f=l[g+2],m=l[g+3];break;default:u=this.getBezierValue(s,g,1,p-2),f=this.getBezierValue(s,g,2,p+18-2),m=this.getBezierValue(s,g,3,p+18*2-2)}if(o==1)c.r=u,c.g=f,c.b=m;else{if(a==P.setup){let b=n.data.color;c.r=b.r,c.g=b.g,c.b=b.b}c.r+=(u-c.r)*o,c.g+=(f-c.g)*o,c.b+=(m-c.b)*o}}}class Qs extends Ue{constructor(t,i,s){super(t,i,ae.alpha+"|"+s);d(this,"slotIndex",0);this.slotIndex=s}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(!n.bone.active)return;let l=n.color;if(s<this.frames[0]){let u=n.data.color;switch(a){case P.setup:l.a=u.a;return;case P.first:l.a+=(u.a-l.a)*o}return}let c=this.getCurveValue(s);o==1?l.a=c:(a==P.setup&&(l.a=n.data.color.a),l.a+=(c-l.a)*o)}}class _s extends He{constructor(t,i,s){super(t,i,[ae.rgb+"|"+s,ae.alpha+"|"+s,ae.rgb2+"|"+s]);d(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 8}setFrame(t,i,s,r,o,a,h,n,l){t<<=3,this.frames[t]=i,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=o,this.frames[t+4]=a,this.frames[t+5]=h,this.frames[t+6]=n,this.frames[t+7]=l}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(!n.bone.active)return;let l=this.frames,c=n.color,u=n.darkColor;if(s<l[0]){let v=n.data.color,S=n.data.darkColor;switch(a){case P.setup:c.setFromColor(v),u.r=S.r,u.g=S.g,u.b=S.b;return;case P.first:c.add((v.r-c.r)*o,(v.g-c.g)*o,(v.b-c.b)*o,(v.a-c.a)*o),u.r+=(S.r-u.r)*o,u.g+=(S.g-u.g)*o,u.b+=(S.b-u.b)*o}return}let f=0,m=0,g=0,p=0,b=0,y=0,w=0,x=pe.search(l,s,8),A=this.curves[x>>3];switch(A){case 0:let v=l[x];f=l[x+1],m=l[x+2],g=l[x+3],p=l[x+4],b=l[x+5],y=l[x+6],w=l[x+7];let S=(s-v)/(l[x+8]-v);f+=(l[x+8+1]-f)*S,m+=(l[x+8+2]-m)*S,g+=(l[x+8+3]-g)*S,p+=(l[x+8+4]-p)*S,b+=(l[x+8+5]-b)*S,y+=(l[x+8+6]-y)*S,w+=(l[x+8+7]-w)*S;break;case 1:f=l[x+1],m=l[x+2],g=l[x+3],p=l[x+4],b=l[x+5],y=l[x+6],w=l[x+7];break;default:f=this.getBezierValue(s,x,1,A-2),m=this.getBezierValue(s,x,2,A+18-2),g=this.getBezierValue(s,x,3,A+18*2-2),p=this.getBezierValue(s,x,4,A+18*3-2),b=this.getBezierValue(s,x,5,A+18*4-2),y=this.getBezierValue(s,x,6,A+18*5-2),w=this.getBezierValue(s,x,7,A+18*6-2)}if(o==1)c.set(f,m,g,p),u.r=b,u.g=y,u.b=w;else{if(a==P.setup){c.setFromColor(n.data.color);let v=n.data.darkColor;u.r=v.r,u.g=v.g,u.b=v.b}c.add((f-c.r)*o,(m-c.g)*o,(g-c.b)*o,(p-c.a)*o),u.r+=(b-u.r)*o,u.g+=(y-u.g)*o,u.b+=(w-u.b)*o}}}class $s extends He{constructor(t,i,s){super(t,i,[ae.rgb+"|"+s,ae.rgb2+"|"+s]);d(this,"slotIndex",0);this.slotIndex=s}getFrameEntries(){return 7}setFrame(t,i,s,r,o,a,h,n){t*=7,this.frames[t]=i,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=o,this.frames[t+4]=a,this.frames[t+5]=h,this.frames[t+6]=n}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(!n.bone.active)return;let l=this.frames,c=n.color,u=n.darkColor;if(s<l[0]){let A=n.data.color,v=n.data.darkColor;switch(a){case P.setup:c.r=A.r,c.g=A.g,c.b=A.b,u.r=v.r,u.g=v.g,u.b=v.b;return;case P.first:c.r+=(A.r-c.r)*o,c.g+=(A.g-c.g)*o,c.b+=(A.b-c.b)*o,u.r+=(v.r-u.r)*o,u.g+=(v.g-u.g)*o,u.b+=(v.b-u.b)*o}return}let f=0,m=0,g=0,p=0,b=0,y=0,w=pe.search(l,s,7),x=this.curves[w/7];switch(x){case 0:let A=l[w];f=l[w+1],m=l[w+2],g=l[w+3],p=l[w+4],b=l[w+5],y=l[w+6];let v=(s-A)/(l[w+7]-A);f+=(l[w+7+1]-f)*v,m+=(l[w+7+2]-m)*v,g+=(l[w+7+3]-g)*v,p+=(l[w+7+4]-p)*v,b+=(l[w+7+5]-b)*v,y+=(l[w+7+6]-y)*v;break;case 1:f=l[w+1],m=l[w+2],g=l[w+3],p=l[w+4],b=l[w+5],y=l[w+6];break;default:f=this.getBezierValue(s,w,1,x-2),m=this.getBezierValue(s,w,2,x+18-2),g=this.getBezierValue(s,w,3,x+18*2-2),p=this.getBezierValue(s,w,4,x+18*3-2),b=this.getBezierValue(s,w,5,x+18*4-2),y=this.getBezierValue(s,w,6,x+18*5-2)}if(o==1)c.r=f,c.g=m,c.b=g,u.r=p,u.g=b,u.b=y;else{if(a==P.setup){let A=n.data.color,v=n.data.darkColor;c.r=A.r,c.g=A.g,c.b=A.b,u.r=v.r,u.g=v.g,u.b=v.b}c.r+=(f-c.r)*o,c.g+=(m-c.g)*o,c.b+=(g-c.b)*o,u.r+=(p-u.r)*o,u.g+=(b-u.g)*o,u.b+=(y-u.b)*o}}}class ht extends pe{constructor(t,i){super(t,[ae.attachment+"|"+i]);d(this,"slotIndex",0);d(this,"attachmentNames");this.slotIndex=i,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,i,s){this.frames[t]=i,this.attachmentNames[t]=s}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(n.bone.active){if(h==Ce.mixOut){a==P.setup&&this.setAttachment(t,n,n.data.attachmentName);return}if(s<this.frames[0]){(a==P.setup||a==P.first)&&this.setAttachment(t,n,n.data.attachmentName);return}this.setAttachment(t,n,this.attachmentNames[pe.search1(this.frames,s)])}}setAttachment(t,i,s){i.setAttachment(s?t.getAttachment(this.slotIndex,s):null)}}class ei extends He{constructor(t,i,s,r){super(t,i,[ae.deform+"|"+s+"|"+r.id]);d(this,"slotIndex",0);d(this,"attachment");d(this,"vertices");this.slotIndex=s,this.attachment=r,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,i,s){this.frames[t]=i,this.vertices[t]=s}setBezier(t,i,s,r,o,a,h,n,l,c,u){let f=this.curves,m=this.getFrameCount()+t*18;s==0&&(f[i]=2+m);let g=(r-a*2+n)*.03,p=l*.03-h*.06,b=((a-n)*3-r+c)*.006,y=(h-l+.33333333)*.018,w=g*2+b,x=p*2+y,A=(a-r)*.3+g+b*.16666667,v=h*.3+p+y*.16666667,S=r+A,E=v;for(let I=m+18;m<I;m+=2)f[m]=S,f[m+1]=E,A+=w,v+=x,w+=b,x+=y,S+=A,E+=v}getCurvePercent(t,i){let s=this.curves,r=s[i];switch(r){case 0:let n=this.frames[i];return(t-n)/(this.frames[i+this.getFrameEntries()]-n);case 1:return 0}if(r-=2,s[r]>t){let n=this.frames[i];return s[r+1]*(t-n)/(s[r]-n)}let o=r+18;for(r+=2;r<o;r+=2)if(s[r]>=t){let n=s[r-2],l=s[r-1];return l+(t-n)/(s[r]-n)*(s[r+1]-l)}let a=s[o-2],h=s[o-1];return h+(1-h)*(t-a)/(this.frames[i+this.getFrameEntries()]-a)}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(!n.bone.active)return;let l=n.getAttachment();if(!l||!(l instanceof De)||l.timelineAttachment!=this.attachment)return;let c=n.deform;c.length==0&&(a=P.setup);let u=this.vertices,f=u[0].length,m=this.frames;if(s<m[0]){switch(a){case P.setup:c.length=0;return;case P.first:if(o==1){c.length=0;return}c.length=f;let x=l;if(x.bones){o=1-o;for(var g=0;g<f;g++)c[g]*=o}else{let A=x.vertices;for(var g=0;g<f;g++)c[g]+=(A[g]-c[g])*o}}return}if(c.length=f,s>=m[m.length-1]){let x=u[m.length-1];if(o==1)if(a==P.add){let A=l;if(A.bones)for(let v=0;v<f;v++)c[v]+=x[v];else{let v=A.vertices;for(let S=0;S<f;S++)c[S]+=x[S]-v[S]}}else O.arrayCopy(x,0,c,0,f);else switch(a){case P.setup:{let v=l;if(v.bones)for(let S=0;S<f;S++)c[S]=x[S]*o;else{let S=v.vertices;for(let E=0;E<f;E++){let I=S[E];c[E]=I+(x[E]-I)*o}}break}case P.first:case P.replace:for(let v=0;v<f;v++)c[v]+=(x[v]-c[v])*o;break;case P.add:let A=l;if(A.bones)for(let v=0;v<f;v++)c[v]+=x[v]*o;else{let v=A.vertices;for(let S=0;S<f;S++)c[S]+=(x[S]-v[S])*o}}return}let p=pe.search1(m,s),b=this.getCurvePercent(s,p),y=u[p],w=u[p+1];if(o==1)if(a==P.add){let x=l;if(x.bones)for(let A=0;A<f;A++){let v=y[A];c[A]+=v+(w[A]-v)*b}else{let A=x.vertices;for(let v=0;v<f;v++){let S=y[v];c[v]+=S+(w[v]-S)*b-A[v]}}}else for(let x=0;x<f;x++){let A=y[x];c[x]=A+(w[x]-A)*b}else switch(a){case P.setup:{let A=l;if(A.bones)for(let v=0;v<f;v++){let S=y[v];c[v]=(S+(w[v]-S)*b)*o}else{let v=A.vertices;for(let S=0;S<f;S++){let E=y[S],I=v[S];c[S]=I+(E+(w[S]-E)*b-I)*o}}break}case P.first:case P.replace:for(let A=0;A<f;A++){let v=y[A];c[A]+=(v+(w[A]-v)*b-c[A])*o}break;case P.add:let x=l;if(x.bones)for(let A=0;A<f;A++){let v=y[A];c[A]+=(v+(w[A]-v)*b)*o}else{let A=x.vertices;for(let v=0;v<f;v++){let S=y[v];c[v]+=(S+(w[v]-S)*b-A[v])*o}}}}}const Wt=class Wt extends pe{constructor(t){super(t,Wt.propertyIds);d(this,"events");this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,i){this.frames[t]=i.time,this.events[t]=i}apply(t,i,s,r,o,a,h){if(!r)return;let n=this.frames,l=this.frames.length;if(i>s)this.apply(t,i,Number.MAX_VALUE,r,o,a,h),i=-1;else if(i>=n[l-1])return;if(s<n[0])return;let c=0;if(i<n[0])c=0;else{c=pe.search1(n,i)+1;let u=n[c];for(;c>0&&n[c-1]==u;)c--}for(;c<l&&s>=n[c];c++)r.push(this.events[c])}};d(Wt,"propertyIds",[""+ae.event]);let It=Wt;const qt=class qt extends pe{constructor(t){super(t,qt.propertyIds);d(this,"drawOrders");this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,i,s){this.frames[t]=i,this.drawOrders[t]=s}apply(t,i,s,r,o,a,h){if(h==Ce.mixOut){a==P.setup&&O.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}if(s<this.frames[0]){(a==P.setup||a==P.first)&&O.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let n=pe.search1(this.frames,s),l=this.drawOrders[n];if(!l)O.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else{let c=t.drawOrder,u=t.slots;for(let f=0,m=l.length;f<m;f++)c[f]=u[l[f]]}}};d(qt,"propertyIds",[""+ae.drawOrder]);let it=qt;class ti extends He{constructor(t,i,s){super(t,i,[ae.ikConstraint+"|"+s]);d(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 6}setFrame(t,i,s,r,o,a,h){t*=6,this.frames[t]=i,this.frames[t+1]=s,this.frames[t+2]=r,this.frames[t+3]=o,this.frames[t+4]=a?1:0,this.frames[t+5]=h?1:0}apply(t,i,s,r,o,a,h){let n=t.ikConstraints[this.constraintIndex];if(!n.active)return;let l=this.frames;if(s<l[0]){switch(a){case P.setup:n.mix=n.data.mix,n.softness=n.data.softness,n.bendDirection=n.data.bendDirection,n.compress=n.data.compress,n.stretch=n.data.stretch;return;case P.first:n.mix+=(n.data.mix-n.mix)*o,n.softness+=(n.data.softness-n.softness)*o,n.bendDirection=n.data.bendDirection,n.compress=n.data.compress,n.stretch=n.data.stretch}return}let c=0,u=0,f=pe.search(l,s,6),m=this.curves[f/6];switch(m){case 0:let g=l[f];c=l[f+1],u=l[f+2];let p=(s-g)/(l[f+6]-g);c+=(l[f+6+1]-c)*p,u+=(l[f+6+2]-u)*p;break;case 1:c=l[f+1],u=l[f+2];break;default:c=this.getBezierValue(s,f,1,m-2),u=this.getBezierValue(s,f,2,m+18-2)}a==P.setup?(n.mix=n.data.mix+(c-n.data.mix)*o,n.softness=n.data.softness+(u-n.data.softness)*o,h==Ce.mixOut?(n.bendDirection=n.data.bendDirection,n.compress=n.data.compress,n.stretch=n.data.stretch):(n.bendDirection=l[f+3],n.compress=l[f+4]!=0,n.stretch=l[f+5]!=0)):(n.mix+=(c-n.mix)*o,n.softness+=(u-n.softness)*o,h==Ce.mixIn&&(n.bendDirection=l[f+3],n.compress=l[f+4]!=0,n.stretch=l[f+5]!=0))}}class si extends He{constructor(t,i,s){super(t,i,[ae.transformConstraint+"|"+s]);d(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 7}setFrame(t,i,s,r,o,a,h,n){let l=this.frames;t*=7,l[t]=i,l[t+1]=s,l[t+2]=r,l[t+3]=o,l[t+4]=a,l[t+5]=h,l[t+6]=n}apply(t,i,s,r,o,a,h){let n=t.transformConstraints[this.constraintIndex];if(!n.active)return;let l=this.frames;if(s<l[0]){let w=n.data;switch(a){case P.setup:n.mixRotate=w.mixRotate,n.mixX=w.mixX,n.mixY=w.mixY,n.mixScaleX=w.mixScaleX,n.mixScaleY=w.mixScaleY,n.mixShearY=w.mixShearY;return;case P.first:n.mixRotate+=(w.mixRotate-n.mixRotate)*o,n.mixX+=(w.mixX-n.mixX)*o,n.mixY+=(w.mixY-n.mixY)*o,n.mixScaleX+=(w.mixScaleX-n.mixScaleX)*o,n.mixScaleY+=(w.mixScaleY-n.mixScaleY)*o,n.mixShearY+=(w.mixShearY-n.mixShearY)*o}return}let c,u,f,m,g,p,b=pe.search(l,s,7),y=this.curves[b/7];switch(y){case 0:let w=l[b];c=l[b+1],u=l[b+2],f=l[b+3],m=l[b+4],g=l[b+5],p=l[b+6];let x=(s-w)/(l[b+7]-w);c+=(l[b+7+1]-c)*x,u+=(l[b+7+2]-u)*x,f+=(l[b+7+3]-f)*x,m+=(l[b+7+4]-m)*x,g+=(l[b+7+5]-g)*x,p+=(l[b+7+6]-p)*x;break;case 1:c=l[b+1],u=l[b+2],f=l[b+3],m=l[b+4],g=l[b+5],p=l[b+6];break;default:c=this.getBezierValue(s,b,1,y-2),u=this.getBezierValue(s,b,2,y+18-2),f=this.getBezierValue(s,b,3,y+18*2-2),m=this.getBezierValue(s,b,4,y+18*3-2),g=this.getBezierValue(s,b,5,y+18*4-2),p=this.getBezierValue(s,b,6,y+18*5-2)}if(a==P.setup){let w=n.data;n.mixRotate=w.mixRotate+(c-w.mixRotate)*o,n.mixX=w.mixX+(u-w.mixX)*o,n.mixY=w.mixY+(f-w.mixY)*o,n.mixScaleX=w.mixScaleX+(m-w.mixScaleX)*o,n.mixScaleY=w.mixScaleY+(g-w.mixScaleY)*o,n.mixShearY=w.mixShearY+(p-w.mixShearY)*o}else n.mixRotate+=(c-n.mixRotate)*o,n.mixX+=(u-n.mixX)*o,n.mixY+=(f-n.mixY)*o,n.mixScaleX+=(m-n.mixScaleX)*o,n.mixScaleY+=(g-n.mixScaleY)*o,n.mixShearY+=(p-n.mixShearY)*o}}class ii extends Ue{constructor(t,i,s){super(t,i,ae.pathConstraintPosition+"|"+s);d(this,"constraintIndex",0);this.constraintIndex=s}apply(t,i,s,r,o,a,h){let n=t.pathConstraints[this.constraintIndex];n.active&&(n.position=this.getAbsoluteValue(s,o,a,n.position,n.data.position))}}class ri extends Ue{constructor(t,i,s){super(t,i,ae.pathConstraintSpacing+"|"+s);d(this,"constraintIndex",0);this.constraintIndex=s}apply(t,i,s,r,o,a,h){let n=t.pathConstraints[this.constraintIndex];n.active&&(n.spacing=this.getAbsoluteValue(s,o,a,n.spacing,n.data.spacing))}}class ni extends He{constructor(t,i,s){super(t,i,[ae.pathConstraintMix+"|"+s]);d(this,"constraintIndex",0);this.constraintIndex=s}getFrameEntries(){return 4}setFrame(t,i,s,r,o){let a=this.frames;t<<=2,a[t]=i,a[t+1]=s,a[t+2]=r,a[t+3]=o}apply(t,i,s,r,o,a,h){let n=t.pathConstraints[this.constraintIndex];if(!n.active)return;let l=this.frames;if(s<l[0]){switch(a){case P.setup:n.mixRotate=n.data.mixRotate,n.mixX=n.data.mixX,n.mixY=n.data.mixY;return;case P.first:n.mixRotate+=(n.data.mixRotate-n.mixRotate)*o,n.mixX+=(n.data.mixX-n.mixX)*o,n.mixY+=(n.data.mixY-n.mixY)*o}return}let c,u,f,m=pe.search(l,s,4),g=this.curves[m>>2];switch(g){case 0:let p=l[m];c=l[m+1],u=l[m+2],f=l[m+3];let b=(s-p)/(l[m+4]-p);c+=(l[m+4+1]-c)*b,u+=(l[m+4+2]-u)*b,f+=(l[m+4+3]-f)*b;break;case 1:c=l[m+1],u=l[m+2],f=l[m+3];break;default:c=this.getBezierValue(s,m,1,g-2),u=this.getBezierValue(s,m,2,g+18-2),f=this.getBezierValue(s,m,3,g+18*2-2)}if(a==P.setup){let p=n.data;n.mixRotate=p.mixRotate+(c-p.mixRotate)*o,n.mixX=p.mixX+(u-p.mixX)*o,n.mixY=p.mixY+(f-p.mixY)*o}else n.mixRotate+=(c-n.mixRotate)*o,n.mixX+=(u-n.mixX)*o,n.mixY+=(f-n.mixY)*o}}class at extends Ue{constructor(t,i,s,r){super(t,i,r+"|"+s);d(this,"constraintIndex",0);this.constraintIndex=s}apply(t,i,s,r,o,a,h){let n;if(this.constraintIndex==-1){const l=s>=this.frames[0]?this.getCurveValue(s):0;for(const c of t.physicsConstraints)c.active&&this.global(c.data)&&this.set(c,this.getAbsoluteValue2(s,o,a,this.get(c),this.setup(c),l))}else n=t.physicsConstraints[this.constraintIndex],n.active&&this.set(n,this.getAbsoluteValue(s,o,a,this.get(n),this.setup(n)))}}class ai extends at{constructor(e,t,i){super(e,t,i,ae.physicsConstraintInertia)}setup(e){return e.data.inertia}get(e){return e.inertia}set(e,t){e.inertia=t}global(e){return e.inertiaGlobal}}class li extends at{constructor(e,t,i){super(e,t,i,ae.physicsConstraintStrength)}setup(e){return e.data.strength}get(e){return e.strength}set(e,t){e.strength=t}global(e){return e.strengthGlobal}}class oi extends at{constructor(e,t,i){super(e,t,i,ae.physicsConstraintDamping)}setup(e){return e.data.damping}get(e){return e.damping}set(e,t){e.damping=t}global(e){return e.dampingGlobal}}class hi extends at{constructor(e,t,i){super(e,t,i,ae.physicsConstraintMass)}setup(e){return 1/e.data.massInverse}get(e){return 1/e.massInverse}set(e,t){e.massInverse=1/t}global(e){return e.massGlobal}}class ci extends at{constructor(e,t,i){super(e,t,i,ae.physicsConstraintWind)}setup(e){return e.data.wind}get(e){return e.wind}set(e,t){e.wind=t}global(e){return e.windGlobal}}class di extends at{constructor(e,t,i){super(e,t,i,ae.physicsConstraintGravity)}setup(e){return e.data.gravity}get(e){return e.gravity}set(e,t){e.gravity=t}global(e){return e.gravityGlobal}}class fi extends at{constructor(e,t,i){super(e,t,i,ae.physicsConstraintMix)}setup(e){return e.data.mix}get(e){return e.mix}set(e,t){e.mix=t}global(e){return e.mixGlobal}}const Gt=class Gt extends pe{constructor(t,i){super(t,Gt.propertyIds);d(this,"constraintIndex");this.constraintIndex=i}getFrameCount(){return this.frames.length}setFrame(t,i){this.frames[t]=i}apply(t,i,s,r,o,a,h){let n;if(this.constraintIndex!=-1&&(n=t.physicsConstraints[this.constraintIndex],!n.active))return;const l=this.frames;if(i>s)this.apply(t,i,Number.MAX_VALUE,[],o,a,h),i=-1;else if(i>=l[l.length-1])return;if(!(s<l[0])&&(i<l[0]||s>=l[pe.search1(l,i)+1]))if(n!=null)n.reset();else for(const c of t.physicsConstraints)c.active&&c.reset()}};d(Gt,"propertyIds",[ae.physicsConstraintReset.toString()]);let Ot=Gt;const Pe=class Pe extends pe{constructor(t,i,s){super(t,[ae.sequence+"|"+i+"|"+s.sequence.id]);d(this,"slotIndex");d(this,"attachment");this.slotIndex=i,this.attachment=s}getFrameEntries(){return Pe.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,i,s,r,o){let a=this.frames;t*=Pe.ENTRIES,a[t]=i,a[t+Pe.MODE]=s|r<<4,a[t+Pe.DELAY]=o}apply(t,i,s,r,o,a,h){let n=t.slots[this.slotIndex];if(!n.bone.active)return;let l=n.attachment,c=this.attachment;if(l!=c&&(!(l instanceof De)||l.timelineAttachment!=c))return;if(h==Ce.mixOut){a==P.setup&&(n.sequenceIndex=-1);return}let u=this.frames;if(s<u[0]){(a==P.setup||a==P.first)&&(n.sequenceIndex=-1);return}let f=pe.search(u,s,Pe.ENTRIES),m=u[f],g=u[f+Pe.MODE],p=u[f+Pe.DELAY];if(!this.attachment.sequence)return;let b=g>>4,y=this.attachment.sequence.regions.length,w=Os[g&15];if(w!=Ae.hold)switch(b+=(s-m)/p+1e-5|0,w){case Ae.once:b=Math.min(y-1,b);break;case Ae.loop:b%=y;break;case Ae.pingpong:{let x=(y<<1)-2;b=x==0?0:b%x,b>=y&&(b=x-b);break}case Ae.onceReverse:b=Math.max(y-1-b,0);break;case Ae.loopReverse:b=y-1-b%y;break;case Ae.pingpongReverse:{let x=(y<<1)-2;b=x==0?0:(b+y-1)%x,b>=y&&(b=x-b)}}n.sequenceIndex=b}};d(Pe,"ENTRIES",3),d(Pe,"MODE",1),d(Pe,"DELAY",2);let Nt=Pe;const ut=class ut{constructor(e){d(this,"data");d(this,"tracks",new Array);d(this,"timeScale",1);d(this,"unkeyedState",0);d(this,"events",new Array);d(this,"listeners",new Array);d(this,"queue",new Mi(this));d(this,"propertyIDs",new Bs);d(this,"animationsChanged",!1);d(this,"trackEntryPool",new Bt(()=>new Ti));this.data=e}static emptyAnimation(){return ut._emptyAnimation}update(e){e*=this.timeScale;let t=this.tracks;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(!r)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let o=e*r.timeScale;if(r.delay>0){if(r.delay-=o,r.delay>0)continue;o=-r.delay,r.delay=0}let a=r.next;if(a){let h=r.trackLast-a.delay;if(h>=0){for(a.delay=0,a.trackTime+=r.timeScale==0?0:(h/r.timeScale+e)*a.timeScale,r.trackTime+=o,this.setCurrent(i,a,!0);a.mixingFrom;)a.mixTime+=e,a=a.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){t[i]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,e)){let h=r.mixingFrom;for(r.mixingFrom=null,h&&(h.mixingTo=null);h;)this.queue.end(h),h=h.mixingFrom}r.trackTime+=o}this.queue.drain()}updateMixingFrom(e,t){let i=e.mixingFrom;if(!i)return!0;let s=this.updateMixingFrom(i,t);return i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,e.nextTrackLast!=-1&&e.mixTime>=e.mixDuration?((i.totalAlpha==0||e.mixDuration==0)&&(e.mixingFrom=i.mixingFrom,i.mixingFrom!=null&&(i.mixingFrom.mixingTo=e),e.interruptAlpha=i.interruptAlpha,this.queue.end(i)),s):(i.trackTime+=t*i.timeScale,e.mixTime+=t,!1)}apply(e){if(!e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let t=this.events,i=this.tracks,s=!1;for(let u=0,f=i.length;u<f;u++){let m=i[u];if(!m||m.delay>0)continue;s=!0;let g=u==0?P.first:m.mixBlend,p=m.alpha;m.mixingFrom?p*=this.applyMixingFrom(m,e,g):m.trackTime>=m.trackEnd&&!m.next&&(p=0);let b=p>=m.alphaAttachmentThreshold,y=m.animationLast,w=m.getAnimationTime(),x=w,A=t;m.reverse&&(x=m.animation.duration-x,A=null);let v=m.animation.timelines,S=v.length;if(u==0&&p==1||g==P.add){u==0&&(b=!0);for(let E=0;E<S;E++){var r=v[E];r instanceof ht?this.applyAttachmentTimeline(r,e,x,g,b):r.apply(e,y,x,A,p,g,Ce.mixIn)}}else{let E=m.timelineMode,I=m.shortestRotation,R=!I&&m.timelinesRotation.length!=S<<1;R&&(m.timelinesRotation.length=S<<1);for(let F=0;F<S;F++){let L=v[F],B=E[F]==_t?g:P.setup;!I&&L instanceof Vt?this.applyRotateTimeline(L,e,x,p,B,m.timelinesRotation,F<<1,R):L instanceof ht?this.applyAttachmentTimeline(L,e,x,g,b):L.apply(e,y,x,A,p,B,Ce.mixIn)}}this.queueEvents(m,w),t.length=0,m.nextAnimationLast=w,m.nextTrackLast=m.trackTime}for(var o=this.unkeyedState+As,a=e.slots,h=0,n=e.slots.length;h<n;h++){var l=a[h];if(l.attachmentState==o){var c=l.data.attachmentName;l.setAttachment(c?e.getAttachment(l.data.index,c):null)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(e,t,i){let s=e.mixingFrom;s.mixingFrom&&this.applyMixingFrom(s,t,i);let r=0;e.mixDuration==0?(r=1,i==P.first&&(i=P.setup)):(r=e.mixTime/e.mixDuration,r>1&&(r=1),i!=P.first&&(i=s.mixBlend));let o=r<s.mixAttachmentThreshold,a=r<s.mixDrawOrderThreshold,h=s.animation.timelines,n=h.length,l=s.alpha*e.interruptAlpha,c=l*(1-r),u=s.animationLast,f=s.getAnimationTime(),m=f,g=null;if(s.reverse?m=s.animation.duration-m:r<s.eventThreshold&&(g=this.events),i==P.add)for(let p=0;p<n;p++)h[p].apply(t,u,m,g,c,i,Ce.mixOut);else{let p=s.timelineMode,b=s.timelineHoldMix,y=s.shortestRotation,w=!y&&s.timelinesRotation.length!=n<<1;w&&(s.timelinesRotation.length=n<<1),s.totalAlpha=0;for(let x=0;x<n;x++){let A=h[x],v=Ce.mixOut,S,E=0;switch(p[x]){case _t:if(!a&&A instanceof it)continue;S=i,E=c;break;case ys:S=P.setup,E=c;break;case vs:S=i,E=l;break;case $t:S=P.setup,E=l;break;default:S=P.setup;let I=b[x];E=l*Math.max(0,1-I.mixTime/I.mixDuration);break}s.totalAlpha+=E,!y&&A instanceof Vt?this.applyRotateTimeline(A,t,m,E,S,s.timelinesRotation,x<<1,w):A instanceof ht?this.applyAttachmentTimeline(A,t,m,S,o&&E>=s.alphaAttachmentThreshold):(a&&A instanceof it&&S==P.setup&&(v=Ce.mixIn),A.apply(t,u,m,g,E,S,v))}}return e.mixDuration>0&&this.queueEvents(s,f),this.events.length=0,s.nextAnimationLast=f,s.nextTrackLast=s.trackTime,r}applyAttachmentTimeline(e,t,i,s,r){var o=t.slots[e.slotIndex];o.bone.active&&(i<e.frames[0]?(s==P.setup||s==P.first)&&this.setAttachment(t,o,o.data.attachmentName,r):this.setAttachment(t,o,e.attachmentNames[pe.search1(e.frames,i)],r),o.attachmentState<=this.unkeyedState&&(o.attachmentState=this.unkeyedState+As))}setAttachment(e,t,i,s){t.setAttachment(i?e.getAttachment(t.data.index,i):null),s&&(t.attachmentState=this.unkeyedState+Fi)}applyRotateTimeline(e,t,i,s,r,o,a,h){if(h&&(o[a]=0),s==1){e.apply(t,0,i,null,1,r,Ce.mixIn);return}let n=t.bones[e.boneIndex];if(!n.active)return;let l=e.frames,c=0,u=0;if(i<l[0])switch(r){case P.setup:n.rotation=n.data.rotation;default:return;case P.first:c=n.rotation,u=n.data.rotation}else c=r==P.setup?n.data.rotation:n.rotation,u=n.data.rotation+e.getCurveValue(i);let f=0,m=u-c;if(m-=Math.ceil(m/360-.5)*360,m==0)f=o[a];else{let g=0,p=0;h?(g=0,p=m):(g=o[a],p=o[a+1]);let b=g-g%360;f=m+b;let y=m>=0,w=g>=0;Math.abs(p)<=90&&V.signum(p)!=V.signum(m)&&(Math.abs(g-b)>180?(f+=360*V.signum(g),w=y):b!=0?f-=360*V.signum(g):w=y),w!=y&&(f+=360*V.signum(g)),o[a]=f}o[a+1]=m,n.rotation=c+f*s}queueEvents(e,t){let i=e.animationStart,s=e.animationEnd,r=s-i,o=e.trackLast%r,a=this.events,h=0,n=a.length;for(;h<n;h++){let c=a[h];if(c.time<o)break;c.time>s||this.queue.event(e,c)}let l=!1;if(e.loop)if(r==0)l=!0;else{const c=Math.floor(e.trackTime/r);l=c>0&&c>Math.floor(e.trackLast/r)}else l=t>=s&&e.animationLast<s;for(l&&this.queue.complete(e);h<n;h++){let c=a[h];c.time<i||this.queue.event(e,c)}}clearTracks(){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,i=this.tracks.length;t<i;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=e,this.queue.drain()}clearTrack(e){if(e>=this.tracks.length)return;let t=this.tracks[e];if(!t)return;this.queue.end(t),this.clearNext(t);let i=t;for(;;){let s=i.mixingFrom;if(!s)break;this.queue.end(s),i.mixingFrom=null,i.mixingTo=null,i=s}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(e,t,i){let s=this.expandToIndex(e);this.tracks[e]=t,t.previous=null,s&&(i&&this.queue.interrupt(s),t.mixingFrom=s,s.mixingTo=t,t.mixTime=0,s.mixingFrom&&s.mixDuration>0&&(t.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(t)}setAnimation(e,t,i=!1){let s=this.data.skeletonData.findAnimation(t);if(!s)throw new Error("Animation not found: "+t);return this.setAnimationWith(e,s,i)}setAnimationWith(e,t,i=!1){if(!t)throw new Error("animation cannot be null.");let s=!0,r=this.expandToIndex(e);r&&(r.nextTrackLast==-1?(this.tracks[e]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,s=!1):this.clearNext(r));let o=this.trackEntry(e,t,i,r);return this.setCurrent(e,o,s),this.queue.drain(),o}addAnimation(e,t,i=!1,s=0){let r=this.data.skeletonData.findAnimation(t);if(!r)throw new Error("Animation not found: "+t);return this.addAnimationWith(e,r,i,s)}addAnimationWith(e,t,i=!1,s=0){if(!t)throw new Error("animation cannot be null.");let r=this.expandToIndex(e);if(r)for(;r.next;)r=r.next;let o=this.trackEntry(e,t,i,r);return r?(r.next=o,o.previous=r,s<=0&&(s+=r.getTrackComplete()-o.mixDuration)):(this.setCurrent(e,o,!0),this.queue.drain()),o.delay=s,o}setEmptyAnimation(e,t=0){let i=this.setAnimationWith(e,ut.emptyAnimation(),!1);return i.mixDuration=t,i.trackEnd=t,i}addEmptyAnimation(e,t=0,i=0){let s=this.addAnimationWith(e,ut.emptyAnimation(),!1,i);return i<=0&&(s.delay+=s.mixDuration-t),s.mixDuration=t,s.trackEnd=t,s}setEmptyAnimations(e=0){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,s=this.tracks.length;i<s;i++){let r=this.tracks[i];r&&this.setEmptyAnimation(r.trackIndex,e)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(e){return e<this.tracks.length?this.tracks[e]:(O.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)}trackEntry(e,t,i,s){let r=this.trackEntryPool.obtain();return r.reset(),r.trackIndex=e,r.animation=t,r.loop=i,r.holdPrevious=!1,r.reverse=!1,r.shortestRotation=!1,r.eventThreshold=0,r.alphaAttachmentThreshold=0,r.mixAttachmentThreshold=0,r.mixDrawOrderThreshold=0,r.animationStart=0,r.animationEnd=t.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixTime=0,r.mixDuration=s?this.data.getMix(s.animation,t):0,r.interruptAlpha=1,r.totalAlpha=0,r.mixBlend=P.replace,r}clearNext(e){let t=e.next;for(;t;)this.queue.dispose(t),t=t.next;e.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let e=this.tracks;for(let t=0,i=e.length;t<i;t++){let s=e[t];if(s){for(;s.mixingFrom;)s=s.mixingFrom;do(!s.mixingTo||s.mixBlend!=P.add)&&this.computeHold(s),s=s.mixingTo;while(s)}}}computeHold(e){let t=e.mixingTo,i=e.animation.timelines,s=e.animation.timelines.length,r=e.timelineMode;r.length=s;let o=e.timelineHoldMix;o.length=0;let a=this.propertyIDs;if(t&&t.holdPrevious){for(let h=0;h<s;h++)r[h]=a.addAll(i[h].getPropertyIds())?$t:vs;return}e:for(let h=0;h<s;h++){let n=i[h],l=n.getPropertyIds();if(!a.addAll(l))r[h]=_t;else if(!t||n instanceof ht||n instanceof it||n instanceof It||!t.animation.hasTimeline(l))r[h]=ys;else{for(let c=t.mixingTo;c;c=c.mixingTo)if(!c.animation.hasTimeline(l)){if(e.mixDuration>0){r[h]=Ri,o[h]=c;continue e}break}r[h]=$t}}}getCurrent(e){return e>=this.tracks.length?null:this.tracks[e]}addListener(e){if(!e)throw new Error("listener cannot be null.");this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}};d(ut,"_emptyAnimation",new fs("<empty>",[],0));let rs=ut;class Ti{constructor(){d(this,"animation",null);d(this,"previous",null);d(this,"next",null);d(this,"mixingFrom",null);d(this,"mixingTo",null);d(this,"listener",null);d(this,"trackIndex",0);d(this,"loop",!1);d(this,"holdPrevious",!1);d(this,"reverse",!1);d(this,"shortestRotation",!1);d(this,"eventThreshold",0);d(this,"mixAttachmentThreshold",0);d(this,"alphaAttachmentThreshold",0);d(this,"mixDrawOrderThreshold",0);d(this,"animationStart",0);d(this,"animationEnd",0);d(this,"animationLast",0);d(this,"nextAnimationLast",0);d(this,"delay",0);d(this,"trackTime",0);d(this,"trackLast",0);d(this,"nextTrackLast",0);d(this,"trackEnd",0);d(this,"timeScale",0);d(this,"alpha",0);d(this,"mixTime",0);d(this,"_mixDuration",0);d(this,"interruptAlpha",0);d(this,"totalAlpha",0);d(this,"mixBlend",P.replace);d(this,"timelineMode",new Array);d(this,"timelineHoldMix",new Array);d(this,"timelinesRotation",new Array)}get mixDuration(){return this._mixDuration}set mixDuration(e){this._mixDuration=e}setMixDurationWithDelay(e,t){this._mixDuration=e,this.previous!=null&&t<=0&&(t+=this.previous.getTrackComplete()-e),this.delay=t}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let e=this.animationEnd-this.animationStart;return e==0?this.animationStart:this.trackTime%e+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(e){this.animationLast=e,this.nextAnimationLast=e}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let e=this.animationEnd-this.animationStart;if(e!=0){if(this.loop)return e*(1+(this.trackTime/e|0));if(this.trackTime<e)return e}return this.trackTime}wasApplied(){return this.nextTrackLast!=-1}isNextReady(){return this.next!=null&&this.nextTrackLast-this.next.delay>=0}}class Mi{constructor(e){d(this,"objects",[]);d(this,"drainDisabled",!1);d(this,"animState");this.animState=e}start(e){this.objects.push(Fe.start),this.objects.push(e),this.animState.animationsChanged=!0}interrupt(e){this.objects.push(Fe.interrupt),this.objects.push(e)}end(e){this.objects.push(Fe.end),this.objects.push(e),this.animState.animationsChanged=!0}dispose(e){this.objects.push(Fe.dispose),this.objects.push(e)}complete(e){this.objects.push(Fe.complete),this.objects.push(e)}event(e,t){this.objects.push(Fe.event),this.objects.push(e),this.objects.push(t)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let e=this.objects,t=this.animState.listeners;for(let i=0;i<e.length;i+=2){let s=e[i],r=e[i+1];switch(s){case Fe.start:r.listener&&r.listener.start&&r.listener.start(r);for(let a=0;a<t.length;a++){let h=t[a];h.start&&h.start(r)}break;case Fe.interrupt:r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(let a=0;a<t.length;a++){let h=t[a];h.interrupt&&h.interrupt(r)}break;case Fe.end:r.listener&&r.listener.end&&r.listener.end(r);for(let a=0;a<t.length;a++){let h=t[a];h.end&&h.end(r)}case Fe.dispose:r.listener&&r.listener.dispose&&r.listener.dispose(r);for(let a=0;a<t.length;a++){let h=t[a];h.dispose&&h.dispose(r)}this.animState.trackEntryPool.free(r);break;case Fe.complete:r.listener&&r.listener.complete&&r.listener.complete(r);for(let a=0;a<t.length;a++){let h=t[a];h.complete&&h.complete(r)}break;case Fe.event:let o=e[i+++2];r.listener&&r.listener.event&&r.listener.event(r,o);for(let a=0;a<t.length;a++){let h=t[a];h.event&&h.event(r,o)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var Fe;(function(C){C[C.start=0]="start",C[C.interrupt=1]="interrupt",C[C.end=2]="end",C[C.dispose=3]="dispose",C[C.complete=4]="complete",C[C.event=5]="event"})(Fe||(Fe={}));const _t=0,ys=1,vs=2,$t=3,Ri=4,As=1,Fi=2;class Yi{constructor(e){d(this,"skeletonData");d(this,"animationToMixTime",{});d(this,"defaultMix",0);if(!e)throw new Error("skeletonData cannot be null.");this.skeletonData=e}setMix(e,t,i){let s=this.skeletonData.findAnimation(e);if(!s)throw new Error("Animation not found: "+e);let r=this.skeletonData.findAnimation(t);if(!r)throw new Error("Animation not found: "+t);this.setMixWith(s,r,i)}setMixWith(e,t,i){if(!e)throw new Error("from cannot be null.");if(!t)throw new Error("to cannot be null.");let s=e.name+"."+t.name;this.animationToMixTime[s]=i}getMix(e,t){let i=e.name+"."+t.name,s=this.animationToMixTime[i];return s===void 0?this.defaultMix:s}}class jt extends De{constructor(t){super(t);d(this,"color",new N(1,1,1,1))}copy(){let t=new jt(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class vt extends De{constructor(t){super(t);d(this,"endSlot",null);d(this,"color",new N(.2275,.2275,.8078,1))}copy(){let t=new vt(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class Li{constructor(e){d(this,"_image");this._image=e}getImage(){return this._image}}var be;(function(C){C[C.Nearest=9728]="Nearest",C[C.Linear=9729]="Linear",C[C.MipMap=9987]="MipMap",C[C.MipMapNearestNearest=9984]="MipMapNearestNearest",C[C.MipMapLinearNearest=9985]="MipMapLinearNearest",C[C.MipMapNearestLinear=9986]="MipMapNearestLinear",C[C.MipMapLinearLinear=9987]="MipMapLinearLinear"})(be||(be={}));var pt;(function(C){C[C.MirroredRepeat=33648]="MirroredRepeat",C[C.ClampToEdge=33071]="ClampToEdge",C[C.Repeat=10497]="Repeat"})(pt||(pt={}));class Xi{constructor(){d(this,"texture");d(this,"u",0);d(this,"v",0);d(this,"u2",0);d(this,"v2",0);d(this,"width",0);d(this,"height",0);d(this,"degrees",0);d(this,"offsetX",0);d(this,"offsetY",0);d(this,"originalWidth",0);d(this,"originalHeight",0)}}class Bi{constructor(e){d(this,"pages",new Array);d(this,"regions",new Array);let t=new Pi(e),i=new Array(4),s={};s.size=l=>{l.width=parseInt(i[1]),l.height=parseInt(i[2])},s.format=()=>{},s.filter=l=>{l.minFilter=O.enumValue(be,i[1]),l.magFilter=O.enumValue(be,i[2])},s.repeat=l=>{i[1].indexOf("x")!=-1&&(l.uWrap=pt.Repeat),i[1].indexOf("y")!=-1&&(l.vWrap=pt.Repeat)},s.pma=l=>{l.pma=i[1]=="true"};var r={};r.xy=l=>{l.x=parseInt(i[1]),l.y=parseInt(i[2])},r.size=l=>{l.width=parseInt(i[1]),l.height=parseInt(i[2])},r.bounds=l=>{l.x=parseInt(i[1]),l.y=parseInt(i[2]),l.width=parseInt(i[3]),l.height=parseInt(i[4])},r.offset=l=>{l.offsetX=parseInt(i[1]),l.offsetY=parseInt(i[2])},r.orig=l=>{l.originalWidth=parseInt(i[1]),l.originalHeight=parseInt(i[2])},r.offsets=l=>{l.offsetX=parseInt(i[1]),l.offsetY=parseInt(i[2]),l.originalWidth=parseInt(i[3]),l.originalHeight=parseInt(i[4])},r.rotate=l=>{let c=i[1];c=="true"?l.degrees=90:c!="false"&&(l.degrees=parseInt(c))},r.index=l=>{l.index=parseInt(i[1])};let o=t.readLine();for(;o&&o.trim().length==0;)o=t.readLine();for(;!(!o||o.trim().length==0||t.readEntry(i,o)==0);)o=t.readLine();let a=null,h=null,n=null;for(;o!==null;)if(o.trim().length==0)a=null,o=t.readLine();else if(a){let l=new ui(a,o);for(;;){let c=t.readEntry(i,o=t.readLine());if(c==0)break;let u=r[i[0]];if(u)u(l);else{h||(h=[]),n||(n=[]),h.push(i[0]);let f=[];for(let m=0;m<c;m++)f.push(parseInt(i[m+1]));n.push(f)}}l.originalWidth==0&&l.originalHeight==0&&(l.originalWidth=l.width,l.originalHeight=l.height),h&&h.length>0&&n&&n.length>0&&(l.names=h,l.values=n,h=null,n=null),l.u=l.x/a.width,l.v=l.y/a.height,l.degrees==90?(l.u2=(l.x+l.height)/a.width,l.v2=(l.y+l.width)/a.height):(l.u2=(l.x+l.width)/a.width,l.v2=(l.y+l.height)/a.height),this.regions.push(l)}else{for(a=new Vi(o.trim());t.readEntry(i,o=t.readLine())!=0;){let l=s[i[0]];l&&l(a)}this.pages.push(a)}}findRegion(e){for(let t=0;t<this.regions.length;t++)if(this.regions[t].name==e)return this.regions[t];return null}setTextures(e,t=""){for(let i of this.pages)i.setTexture(e.get(t+i.name))}dispose(){var e;for(let t=0;t<this.pages.length;t++)(e=this.pages[t].texture)==null||e.dispose()}}class Pi{constructor(e){d(this,"lines");d(this,"index",0);this.lines=e.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(e,t){if(!t||(t=t.trim(),t.length==0))return 0;let i=t.indexOf(":");if(i==-1)return 0;e[0]=t.substr(0,i).trim();for(let s=1,r=i+1;;s++){let o=t.indexOf(",",r);if(o==-1)return e[s]=t.substr(r).trim(),s;if(e[s]=t.substr(r,o-r).trim(),r=o+1,s==4)return 4}}}class Vi{constructor(e){d(this,"name");d(this,"minFilter",be.Nearest);d(this,"magFilter",be.Nearest);d(this,"uWrap",pt.ClampToEdge);d(this,"vWrap",pt.ClampToEdge);d(this,"texture",null);d(this,"width",0);d(this,"height",0);d(this,"pma",!1);d(this,"regions",new Array);this.name=e}setTexture(e){this.texture=e,e.setFilters(this.minFilter,this.magFilter),e.setWraps(this.uWrap,this.vWrap);for(let t of this.regions)t.texture=e}}class ui extends Xi{constructor(t,i){super();d(this,"page");d(this,"name");d(this,"x",0);d(this,"y",0);d(this,"offsetX",0);d(this,"offsetY",0);d(this,"originalWidth",0);d(this,"originalHeight",0);d(this,"index",0);d(this,"degrees",0);d(this,"names",null);d(this,"values",null);this.page=t,this.name=i,t.regions.push(this)}}class tt extends De{constructor(t,i){super(t);d(this,"region",null);d(this,"path");d(this,"regionUVs",[]);d(this,"uvs",[]);d(this,"triangles",[]);d(this,"color",new N(1,1,1,1));d(this,"width",0);d(this,"height",0);d(this,"hullLength",0);d(this,"edges",[]);d(this,"parentMesh",null);d(this,"sequence",null);d(this,"tempColor",new N(0,0,0,0));this.path=i}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.regionUVs;(!this.uvs||this.uvs.length!=t.length)&&(this.uvs=O.newFloatArray(t.length));let i=this.uvs,s=this.uvs.length,r=this.region.u,o=this.region.v,a=0,h=0;if(this.region instanceof ui){let n=this.region,l=n.page,c=l.width,u=l.height;switch(n.degrees){case 90:r-=(n.originalHeight-n.offsetY-n.height)/c,o-=(n.originalWidth-n.offsetX-n.width)/u,a=n.originalHeight/c,h=n.originalWidth/u;for(let f=0;f<s;f+=2)i[f]=r+t[f+1]*a,i[f+1]=o+(1-t[f])*h;return;case 180:r-=(n.originalWidth-n.offsetX-n.width)/c,o-=n.offsetY/u,a=n.originalWidth/c,h=n.originalHeight/u;for(let f=0;f<s;f+=2)i[f]=r+(1-t[f])*a,i[f+1]=o+(1-t[f+1])*h;return;case 270:r-=n.offsetY/c,o-=n.offsetX/u,a=n.originalHeight/c,h=n.originalWidth/u;for(let f=0;f<s;f+=2)i[f]=r+(1-t[f+1])*a,i[f+1]=o+t[f]*h;return}r-=n.offsetX/c,o-=(n.originalHeight-n.offsetY-n.height)/u,a=n.originalWidth/c,h=n.originalHeight/u}else this.region?(a=this.region.u2-r,h=this.region.v2-o):(r=o=0,a=h=1);for(let n=0;n<s;n+=2)i[n]=r+t[n]*a,i[n+1]=o+t[n+1]*h}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let t=new tt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),O.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),O.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),O.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),O.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,i,s,r,o,a){this.sequence!=null&&this.sequence.apply(t,this),super.computeWorldVertices(t,i,s,r,o,a)}newLinkedMesh(){let t=new tt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t.region!=null&&t.updateRegion(),t}}class nt extends De{constructor(t){super(t);d(this,"lengths",[]);d(this,"closed",!1);d(this,"constantSpeed",!1);d(this,"color",new N(1,1,1,1))}copy(){let t=new nt(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),O.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class ms extends De{constructor(t){super(t);d(this,"x",0);d(this,"y",0);d(this,"rotation",0);d(this,"color",new N(.38,.94,0,1))}computeWorldPosition(t,i){return i.x=this.x*t.a+this.y*t.b+t.worldX,i.y=this.x*t.c+this.y*t.d+t.worldY,i}computeWorldRotation(t){const i=this.rotation*V.degRad,s=Math.cos(i),r=Math.sin(i),o=s*t.a+r*t.b,a=s*t.c+r*t.d;return V.atan2Deg(a,o)}copy(){let t=new ms(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const de=class de extends Vs{constructor(t,i){super(t);d(this,"x",0);d(this,"y",0);d(this,"scaleX",1);d(this,"scaleY",1);d(this,"rotation",0);d(this,"width",0);d(this,"height",0);d(this,"color",new N(1,1,1,1));d(this,"path");d(this,"region",null);d(this,"sequence",null);d(this,"offset",O.newFloatArray(8));d(this,"uvs",O.newFloatArray(8));d(this,"tempColor",new N(1,1,1,1));this.path=i}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.region,i=this.uvs;if(t==null){i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=1,i[5]=1,i[6]=1,i[7]=0;return}let s=this.width/this.region.originalWidth*this.scaleX,r=this.height/this.region.originalHeight*this.scaleY,o=-this.width/2*this.scaleX+this.region.offsetX*s,a=-this.height/2*this.scaleY+this.region.offsetY*r,h=o+this.region.width*s,n=a+this.region.height*r,l=this.rotation*V.degRad,c=Math.cos(l),u=Math.sin(l),f=this.x,m=this.y,g=o*c+f,p=o*u,b=a*c+m,y=a*u,w=h*c+f,x=h*u,A=n*c+m,v=n*u,S=this.offset;S[0]=g-y,S[1]=b+p,S[2]=g-v,S[3]=A+p,S[4]=w-v,S[5]=A+x,S[6]=w-y,S[7]=b+x,t.degrees==90?(i[0]=t.u2,i[1]=t.v2,i[2]=t.u,i[3]=t.v2,i[4]=t.u,i[5]=t.v,i[6]=t.u2,i[7]=t.v):(i[0]=t.u,i[1]=t.v2,i[2]=t.u,i[3]=t.v,i[4]=t.u2,i[5]=t.v,i[6]=t.u2,i[7]=t.v2)}computeWorldVertices(t,i,s,r){this.sequence!=null&&this.sequence.apply(t,this);let o=t.bone,a=this.offset,h=o.worldX,n=o.worldY,l=o.a,c=o.b,u=o.c,f=o.d,m=0,g=0;m=a[0],g=a[1],i[s]=m*l+g*c+h,i[s+1]=m*u+g*f+n,s+=r,m=a[2],g=a[3],i[s]=m*l+g*c+h,i[s+1]=m*u+g*f+n,s+=r,m=a[4],g=a[5],i[s]=m*l+g*c+h,i[s+1]=m*u+g*f+n,s+=r,m=a[6],g=a[7],i[s]=m*l+g*c+h,i[s+1]=m*u+g*f+n}copy(){let t=new de(this.name,this.path);return t.region=this.region,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,O.arrayCopy(this.uvs,0,t.uvs,0,8),O.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=this.sequence!=null?this.sequence.copy():null,t}};d(de,"X1",0),d(de,"Y1",1),d(de,"C1R",2),d(de,"C1G",3),d(de,"C1B",4),d(de,"C1A",5),d(de,"U1",6),d(de,"V1",7),d(de,"X2",8),d(de,"Y2",9),d(de,"C2R",10),d(de,"C2G",11),d(de,"C2B",12),d(de,"C2A",13),d(de,"U2",14),d(de,"V2",15),d(de,"X3",16),d(de,"Y3",17),d(de,"C3R",18),d(de,"C3G",19),d(de,"C3B",20),d(de,"C3A",21),d(de,"U3",22),d(de,"V3",23),d(de,"X4",24),d(de,"Y4",25),d(de,"C4R",26),d(de,"C4G",27),d(de,"C4B",28),d(de,"C4A",29),d(de,"U4",30),d(de,"V4",31);let xt=de;class Oi{constructor(e){d(this,"atlas");this.atlas=e}loadSequence(e,t,i){let s=i.regions;for(let r=0,o=s.length;r<o;r++){let a=i.getPath(t,r),h=this.atlas.findRegion(a);if(h==null)throw new Error("Region not found in atlas: "+a+" (sequence: "+e+")");s[r]=h}}newRegionAttachment(e,t,i,s){let r=new xt(t,i);if(s!=null)this.loadSequence(t,i,s);else{let o=this.atlas.findRegion(i);if(!o)throw new Error("Region not found in atlas: "+i+" (region attachment: "+t+")");r.region=o}return r}newMeshAttachment(e,t,i,s){let r=new tt(t,i);if(s!=null)this.loadSequence(t,i,s);else{let o=this.atlas.findRegion(i);if(!o)throw new Error("Region not found in atlas: "+i+" (mesh attachment: "+t+")");r.region=o}return r}newBoundingBoxAttachment(e,t){return new jt(t)}newPathAttachment(e,t){return new nt(t)}newPointAttachment(e,t){return new ms(t)}newClippingAttachment(e,t){return new vt(t)}}class mi{constructor(e,t,i){d(this,"index",0);d(this,"name");d(this,"parent",null);d(this,"length",0);d(this,"x",0);d(this,"y",0);d(this,"rotation",0);d(this,"scaleX",1);d(this,"scaleY",1);d(this,"shearX",0);d(this,"shearY",0);d(this,"inherit",xe.Normal);d(this,"skinRequired",!1);d(this,"color",new N);d(this,"icon");d(this,"visible",!1);if(e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");this.index=e,this.name=t,this.parent=i}}var xe;(function(C){C[C.Normal=0]="Normal",C[C.OnlyTranslation=1]="OnlyTranslation",C[C.NoRotationOrReflection=2]="NoRotationOrReflection",C[C.NoScale=3]="NoScale",C[C.NoScaleOrReflection=4]="NoScaleOrReflection"})(xe||(xe={}));class Cs{constructor(e,t,i){d(this,"data");d(this,"skeleton");d(this,"parent",null);d(this,"children",new Array);d(this,"x",0);d(this,"y",0);d(this,"rotation",0);d(this,"scaleX",0);d(this,"scaleY",0);d(this,"shearX",0);d(this,"shearY",0);d(this,"ax",0);d(this,"ay",0);d(this,"arotation",0);d(this,"ascaleX",0);d(this,"ascaleY",0);d(this,"ashearX",0);d(this,"ashearY",0);d(this,"a",0);d(this,"b",0);d(this,"c",0);d(this,"d",0);d(this,"worldY",0);d(this,"worldX",0);d(this,"inherit",xe.Normal);d(this,"sorted",!1);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.skeleton=t,this.parent=i,this.setToSetupPose()}isActive(){return this.active}update(e){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(e,t,i,s,r,o,a){this.ax=e,this.ay=t,this.arotation=i,this.ascaleX=s,this.ascaleY=r,this.ashearX=o,this.ashearY=a;let h=this.parent;if(!h){let f=this.skeleton;const m=f.scaleX,g=f.scaleY,p=(i+o)*V.degRad,b=(i+90+a)*V.degRad;this.a=Math.cos(p)*s*m,this.b=Math.cos(b)*r*m,this.c=Math.sin(p)*s*g,this.d=Math.sin(b)*r*g,this.worldX=e*m+f.x,this.worldY=t*g+f.y;return}let n=h.a,l=h.b,c=h.c,u=h.d;switch(this.worldX=n*e+l*t+h.worldX,this.worldY=c*e+u*t+h.worldY,this.inherit){case xe.Normal:{const f=(i+o)*V.degRad,m=(i+90+a)*V.degRad,g=Math.cos(f)*s,p=Math.cos(m)*r,b=Math.sin(f)*s,y=Math.sin(m)*r;this.a=n*g+l*b,this.b=n*p+l*y,this.c=c*g+u*b,this.d=c*p+u*y;return}case xe.OnlyTranslation:{const f=(i+o)*V.degRad,m=(i+90+a)*V.degRad;this.a=Math.cos(f)*s,this.b=Math.cos(m)*r,this.c=Math.sin(f)*s,this.d=Math.sin(m)*r;break}case xe.NoRotationOrReflection:{let f=1/this.skeleton.scaleX,m=1/this.skeleton.scaleY;n*=f,c*=m;let g=n*n+c*c,p=0;g>1e-4?(g=Math.abs(n*u*m-l*f*c)/g,l=c*g,u=n*g,p=Math.atan2(c,n)*V.radDeg):(n=0,c=0,p=90-Math.atan2(u,l)*V.radDeg);const b=(i+o-p)*V.degRad,y=(i+a-p+90)*V.degRad,w=Math.cos(b)*s,x=Math.cos(y)*r,A=Math.sin(b)*s,v=Math.sin(y)*r;this.a=n*w-l*A,this.b=n*x-l*v,this.c=c*w+u*A,this.d=c*x+u*v;break}case xe.NoScale:case xe.NoScaleOrReflection:{i*=V.degRad;const f=Math.cos(i),m=Math.sin(i);let g=(n*f+l*m)/this.skeleton.scaleX,p=(c*f+u*m)/this.skeleton.scaleY,b=Math.sqrt(g*g+p*p);b>1e-5&&(b=1/b),g*=b,p*=b,b=Math.sqrt(g*g+p*p),this.inherit==xe.NoScale&&n*u-l*c<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(b=-b),i=Math.PI/2+Math.atan2(p,g);const y=Math.cos(i)*b,w=Math.sin(i)*b;o*=V.degRad,a=(90+a)*V.degRad;const x=Math.cos(o)*s,A=Math.cos(a)*r,v=Math.sin(o)*s,S=Math.sin(a)*r;this.a=g*x+y*v,this.b=g*A+y*S,this.c=p*x+w*v,this.d=p*A+w*S;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY,this.shearX=e.shearX,this.shearY=e.shearY,this.inherit=e.inherit}updateAppliedTransform(){let e=this.parent;if(!e){this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*V.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*V.radDeg;return}let t=e.a,i=e.b,s=e.c,r=e.d,o=1/(t*r-i*s),a=r*o,h=i*o,n=s*o,l=t*o,c=this.worldX-e.worldX,u=this.worldY-e.worldY;this.ax=c*a-u*h,this.ay=u*l-c*n;let f,m,g,p;if(this.inherit==xe.OnlyTranslation)f=this.a,m=this.b,g=this.c,p=this.d;else{switch(this.inherit){case xe.NoRotationOrReflection:{let A=Math.abs(t*r-i*s)/(t*t+s*s);i=-s*this.skeleton.scaleX*A/this.skeleton.scaleY,r=t*this.skeleton.scaleY*A/this.skeleton.scaleX,o=1/(t*r-i*s),a=r*o,h=i*o;break}case xe.NoScale:case xe.NoScaleOrReflection:let b=V.cosDeg(this.rotation),y=V.sinDeg(this.rotation);t=(t*b+i*y)/this.skeleton.scaleX,s=(s*b+r*y)/this.skeleton.scaleY;let w=Math.sqrt(t*t+s*s);w>1e-5&&(w=1/w),t*=w,s*=w,w=Math.sqrt(t*t+s*s),this.inherit==xe.NoScale&&o<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(w=-w);let x=V.PI/2+Math.atan2(s,t);i=Math.cos(x)*w,r=Math.sin(x)*w,o=1/(t*r-i*s),a=r*o,h=i*o,n=s*o,l=t*o}f=a*this.a-h*this.c,m=a*this.b-h*this.d,g=l*this.c-n*this.a,p=l*this.d-n*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(f*f+g*g),this.ascaleX>1e-4){let b=f*p-m*g;this.ascaleY=b/this.ascaleX,this.ashearY=-Math.atan2(f*m+g*p,b)*V.radDeg,this.arotation=Math.atan2(g,f)*V.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(m*m+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,m)*V.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*V.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*V.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(e){let t=1/(this.a*this.d-this.b*this.c),i=e.x-this.worldX,s=e.y-this.worldY;return e.x=i*this.d*t-s*this.b*t,e.y=s*this.a*t-i*this.c*t,e}localToWorld(e){let t=e.x,i=e.y;return e.x=t*this.a+i*this.b+this.worldX,e.y=t*this.c+i*this.d+this.worldY,e}worldToParent(e){if(e==null)throw new Error("world cannot be null.");return this.parent==null?e:this.parent.worldToLocal(e)}parentToWorld(e){if(e==null)throw new Error("world cannot be null.");return this.parent==null?e:this.parent.localToWorld(e)}worldToLocalRotation(e){let t=V.sinDeg(e),i=V.cosDeg(e);return Math.atan2(this.a*t-this.c*i,this.d*i-this.b*t)*V.radDeg+this.rotation-this.shearX}localToWorldRotation(e){e-=this.rotation-this.shearX;let t=V.sinDeg(e),i=V.cosDeg(e);return Math.atan2(i*this.c+t*this.d,i*this.a+t*this.b)*V.radDeg}rotateWorld(e){e*=V.degRad;const t=Math.sin(e),i=Math.cos(e),s=this.a,r=this.b;this.a=i*s-t*this.c,this.b=i*r-t*this.d,this.c=t*s+i*this.c,this.d=t*r+i*this.d}}class Zt{constructor(e,t,i){d(this,"name");d(this,"order");d(this,"skinRequired");this.name=e,this.order=t,this.skinRequired=i}}class Ni{constructor(e,t="",i=new gi){d(this,"pathPrefix","");d(this,"textureLoader");d(this,"downloader");d(this,"assets",{});d(this,"errors",{});d(this,"toLoad",0);d(this,"loaded",0);this.textureLoader=e,this.pathPrefix=t,this.downloader=i}start(e){return this.toLoad++,this.pathPrefix+e}success(e,t,i){this.toLoad--,this.loaded++,this.assets[t]=i,e&&e(t,i)}error(e,t,i){this.toLoad--,this.loaded++,this.errors[t]=i,e&&e(t,i)}loadAll(){return new Promise((t,i)=>{let s=()=>{if(this.isLoadingComplete()){this.hasErrors()?i(this.errors):t(this);return}requestAnimationFrame(s)};requestAnimationFrame(s)})}setRawDataURI(e,t){this.downloader.rawDataUris[this.pathPrefix+e]=t}loadBinary(e,t=()=>{},i=()=>{}){e=this.start(e),this.downloader.downloadBinary(e,s=>{this.success(t,e,s)},(s,r)=>{this.error(i,e,`Couldn't load binary ${e}: status ${s}, ${r}`)})}loadText(e,t=()=>{},i=()=>{}){e=this.start(e),this.downloader.downloadText(e,s=>{this.success(t,e,s)},(s,r)=>{this.error(i,e,`Couldn't load text ${e}: status ${s}, ${r}`)})}loadJson(e,t=()=>{},i=()=>{}){e=this.start(e),this.downloader.downloadJson(e,s=>{this.success(t,e,s)},(s,r)=>{this.error(i,e,`Couldn't load JSON ${e}: status ${s}, ${r}`)})}loadTexture(e,t=()=>{},i=()=>{}){if(e=this.start(e),!!!(typeof window<"u"&&typeof navigator<"u"&&window.document))fetch(e,{mode:"cors"}).then(o=>o.ok?o.blob():(this.error(i,e,`Couldn't load image: ${e}`),null)).then(o=>o?createImageBitmap(o,{premultiplyAlpha:"none",colorSpaceConversion:"none"}):null).then(o=>{o&&this.success(t,e,this.textureLoader(o))});else{let o=new Image;o.crossOrigin="anonymous",o.onload=()=>{this.success(t,e,this.textureLoader(o))},o.onerror=()=>{this.error(i,e,`Couldn't load image: ${e}`)},this.downloader.rawDataUris[e]&&(e=this.downloader.rawDataUris[e]),o.src=e}}loadTextureAtlas(e,t=()=>{},i=()=>{},s){let r=e.lastIndexOf("/"),o=r>=0?e.substring(0,r+1):"";e=this.start(e),this.downloader.downloadText(e,a=>{try{let h=new Bi(a),n=h.pages.length,l=!1;for(let c of h.pages)this.loadTexture(s?s[c.name]:o+c.name,(u,f)=>{l||(c.setTexture(f),--n==0&&this.success(t,e,h))},(u,f)=>{l||this.error(i,e,`Couldn't load texture atlas ${e} page image: ${u}`),l=!0})}catch(h){this.error(i,e,`Couldn't parse texture atlas ${e}: ${h.message}`)}},(a,h)=>{this.error(i,e,`Couldn't load texture atlas ${e}: status ${a}, ${h}`)})}get(e){return this.assets[this.pathPrefix+e]}require(e){e=this.pathPrefix+e;let t=this.assets[e];if(t)return t;let i=this.errors[e];throw Error("Asset not found: "+e+(i?`
`+i:""))}remove(e){e=this.pathPrefix+e;let t=this.assets[e];return t.dispose&&t.dispose(),delete this.assets[e],t}removeAll(){for(let e in this.assets){let t=this.assets[e];t.dispose&&t.dispose()}this.assets={}}isLoadingComplete(){return this.toLoad==0}getToLoad(){return this.toLoad}getLoaded(){return this.loaded}dispose(){this.removeAll()}hasErrors(){return Object.keys(this.errors).length>0}getErrors(){return this.errors}}class gi{constructor(){d(this,"callbacks",{});d(this,"rawDataUris",{})}dataUriToString(e){if(!e.startsWith("data:"))throw new Error("Not a data URI.");let t=e.indexOf("base64,");return t!=-1?(t+=7,atob(e.substr(t))):e.substr(e.indexOf(",")+1)}base64ToUint8Array(e){for(var t=window.atob(e),i=t.length,s=new Uint8Array(i),r=0;r<i;r++)s[r]=t.charCodeAt(r);return s}dataUriToUint8Array(e){if(!e.startsWith("data:"))throw new Error("Not a data URI.");let t=e.indexOf("base64,");if(t==-1)throw new Error("Not a binary data URI.");return t+=7,this.base64ToUint8Array(e.substr(t))}downloadText(e,t,i){if(this.start(e,t,i))return;if(this.rawDataUris[e]){try{let o=this.rawDataUris[e];this.finish(e,200,this.dataUriToString(o))}catch(o){this.finish(e,400,JSON.stringify(o))}return}let s=new XMLHttpRequest;s.overrideMimeType("text/html"),s.open("GET",e,!0);let r=()=>{this.finish(e,s.status,s.responseText)};s.onload=r,s.onerror=r,s.send()}downloadJson(e,t,i){this.downloadText(e,s=>{t(JSON.parse(s))},i)}downloadBinary(e,t,i){if(this.start(e,t,i))return;if(this.rawDataUris[e]){try{let o=this.rawDataUris[e];this.finish(e,200,this.dataUriToUint8Array(o))}catch(o){this.finish(e,400,JSON.stringify(o))}return}let s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer";let r=()=>{this.finish(e,s.status,s.response)};s.onload=()=>{s.status==200||s.status==0?this.finish(e,200,new Uint8Array(s.response)):r()},s.onerror=r,s.send()}start(e,t,i){let s=this.callbacks[e];try{if(s)return!0;this.callbacks[e]=s=[]}finally{s.push(t,i)}}finish(e,t,i){let s=this.callbacks[e];delete this.callbacks[e];let r=t==200||t==0?[i]:[t,i];for(let o=r.length-1,a=s.length;o<a;o+=2)s[o].apply(null,r)}}class pi{constructor(e,t){d(this,"data");d(this,"intValue",0);d(this,"floatValue",0);d(this,"stringValue",null);d(this,"time",0);d(this,"volume",0);d(this,"balance",0);if(!t)throw new Error("data cannot be null.");this.time=e,this.data=t}}class xi{constructor(e){d(this,"name");d(this,"intValue",0);d(this,"floatValue",0);d(this,"stringValue",null);d(this,"audioPath",null);d(this,"volume",0);d(this,"balance",0);this.name=e}}class Di{constructor(e,t){d(this,"data");d(this,"bones");d(this,"target");d(this,"bendDirection",0);d(this,"compress",!1);d(this,"stretch",!1);d(this,"mix",1);d(this,"softness",0);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let s=0;s<e.bones.length;s++){let r=t.findBone(e.bones[s].name);if(!r)throw new Error(`Couldn't find bone ${e.bones[s].name}`);this.bones.push(r)}let i=t.findBone(e.target.name);if(!i)throw new Error(`Couldn't find bone ${e.target.name}`);this.target=i,this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch}isActive(){return this.active}setToSetupPose(){const e=this.data;this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch}update(e){if(this.mix==0)return;let t=this.target,i=this.bones;switch(i.length){case 1:this.apply1(i[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(i[0],i[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(e,t,i,s,r,o,a){let h=e.parent;if(!h)throw new Error("IK bone must have parent.");let n=h.a,l=h.b,c=h.c,u=h.d,f=-e.ashearX-e.arotation,m=0,g=0;switch(e.inherit){case xe.OnlyTranslation:m=(t-e.worldX)*V.signum(e.skeleton.scaleX),g=(i-e.worldY)*V.signum(e.skeleton.scaleY);break;case xe.NoRotationOrReflection:let y=Math.abs(n*u-l*c)/Math.max(1e-4,n*n+c*c),w=n/e.skeleton.scaleX,x=c/e.skeleton.scaleY;l=-x*y*e.skeleton.scaleX,u=w*y*e.skeleton.scaleY,f+=Math.atan2(x,w)*V.radDeg;default:let A=t-h.worldX,v=i-h.worldY,S=n*u-l*c;Math.abs(S)<=1e-4?(m=0,g=0):(m=(A*u-v*l)/S-e.ax,g=(v*n-A*c)/S-e.ay)}f+=Math.atan2(g,m)*V.radDeg,e.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let p=e.ascaleX,b=e.ascaleY;if(s||r){switch(e.inherit){case xe.NoScale:case xe.NoScaleOrReflection:m=t-e.worldX,g=i-e.worldY}const y=e.data.length*p;if(y>1e-4){const w=m*m+g*g;if(s&&w<y*y||r&&w>y*y){const x=(Math.sqrt(w)/y-1)*a+1;p*=x,o&&(b*=x)}}}e.updateWorldTransformWith(e.ax,e.ay,e.arotation+f*a,p,b,e.ashearX,e.ashearY)}apply2(e,t,i,s,r,o,a,h,n){if(e.inherit!=xe.Normal||t.inherit!=xe.Normal)return;let l=e.ax,c=e.ay,u=e.ascaleX,f=e.ascaleY,m=u,g=f,p=t.ascaleX,b=0,y=0,w=0;u<0?(u=-u,b=180,w=-1):(b=0,w=1),f<0&&(f=-f,w=-w),p<0?(p=-p,y=180):y=0;let x=t.ax,A=0,v=0,S=0,E=e.a,I=e.b,R=e.c,F=e.d,L=Math.abs(u-f)<=1e-4;!L||o?(A=0,v=E*x+e.worldX,S=R*x+e.worldY):(A=t.ay,v=E*x+I*A+e.worldX,S=R*x+F*A+e.worldY);let B=e.parent;if(!B)throw new Error("IK parent must itself have a parent.");E=B.a,I=B.b,R=B.c,F=B.d;let T=E*F-I*R,Y=v-B.worldX,X=S-B.worldY;T=Math.abs(T)<=1e-4?0:1/T;let re=(Y*F-X*I)*T-l,ne=(X*E-Y*R)*T-c,ee=Math.sqrt(re*re+ne*ne),ce=t.data.length*p,me,ge;if(ee<1e-4){this.apply1(e,i,s,!1,o,!1,n),t.updateWorldTransformWith(x,A,0,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY);return}Y=i-B.worldX,X=s-B.worldY;let D=(Y*F-X*I)*T-l,le=(X*E-Y*R)*T-c,oe=D*D+le*le;if(h!=0){h*=u*(p+1)*.5;let we=Math.sqrt(oe),Se=we-ee-ce*u+h;if(Se>0){let Ee=Math.min(1,Se/(h*2))-1;Ee=(Se-h*(1-Ee*Ee))/we,D-=Ee*D,le-=Ee*le,oe=D*D+le*le}}e:if(L){ce*=u;let we=(oe-ee*ee-ce*ce)/(2*ee*ce);we<-1?(we=-1,ge=Math.PI*r):we>1?(we=1,ge=0,o&&(E=(Math.sqrt(oe)/(ee+ce)-1)*n+1,m*=E,a&&(g*=E))):ge=Math.acos(we)*r,E=ee+ce*we,I=ce*Math.sin(ge),me=Math.atan2(le*E-D*I,D*E+le*I)}else{E=u*ce,I=f*ce;let we=E*E,Se=I*I,Ee=Math.atan2(le,D);R=Se*ee*ee+we*oe-we*Se;let Qe=-2*Se*ee,At=Se-we;if(F=Qe*Qe-4*At*R,F>=0){let lt=Math.sqrt(F);Qe<0&&(lt=-lt),lt=-(Qe+lt)*.5;let Ct=lt/At,bs=R/lt,Ft=Math.abs(Ct)<Math.abs(bs)?Ct:bs;if(Ct=oe-Ft*Ft,Ct>=0){X=Math.sqrt(Ct)*r,me=Ee-Math.atan2(X,Ft),ge=Math.atan2(X/f,(Ft-ee)/u);break e}}let gs=V.PI,Mt=ee-E,Kt=Mt*Mt,ps=0,xs=0,Rt=ee+E,Qt=Rt*Rt,ws=0;R=-E*ee/(we-Se),R>=-1&&R<=1&&(R=Math.acos(R),Y=E*Math.cos(R)+ee,X=I*Math.sin(R),F=Y*Y+X*X,F<Kt&&(gs=R,Kt=F,Mt=Y,ps=X),F>Qt&&(xs=R,Qt=F,Rt=Y,ws=X)),oe<=(Kt+Qt)*.5?(me=Ee-Math.atan2(ps*r,Mt),ge=gs*r):(me=Ee-Math.atan2(ws*r,Rt),ge=xs*r)}let Be=Math.atan2(A,x)*w,Re=e.arotation;me=(me-Be)*V.radDeg+b-Re,me>180?me-=360:me<-180&&(me+=360),e.updateWorldTransformWith(l,c,Re+me*n,m,g,0,0),Re=t.arotation,ge=((ge+Be)*V.radDeg-t.ashearX)*w+y-Re,ge>180?ge-=360:ge<-180&&(ge+=360),t.updateWorldTransformWith(x,A,Re+ge*n,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY)}}class wi extends Zt{constructor(t){super(t,0,!1);d(this,"bones",new Array);d(this,"_target",null);d(this,"bendDirection",0);d(this,"compress",!1);d(this,"stretch",!1);d(this,"uniform",!1);d(this,"mix",0);d(this,"softness",0)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class bi extends Zt{constructor(t){super(t,0,!1);d(this,"bones",new Array);d(this,"_target",null);d(this,"positionMode",Ge.Fixed);d(this,"spacingMode",ve.Fixed);d(this,"rotateMode",rt.Chain);d(this,"offsetRotation",0);d(this,"position",0);d(this,"spacing",0);d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var Ge;(function(C){C[C.Fixed=0]="Fixed",C[C.Percent=1]="Percent"})(Ge||(Ge={}));var ve;(function(C){C[C.Length=0]="Length",C[C.Fixed=1]="Fixed",C[C.Percent=2]="Percent",C[C.Proportional=3]="Proportional"})(ve||(ve={}));var rt;(function(C){C[C.Tangent=0]="Tangent",C[C.Chain=1]="Chain",C[C.ChainScale=2]="ChainScale"})(rt||(rt={}));const Xe=class Xe{constructor(e,t){d(this,"data");d(this,"bones");d(this,"target");d(this,"position",0);d(this,"spacing",0);d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0);d(this,"spaces",new Array);d(this,"positions",new Array);d(this,"world",new Array);d(this,"curves",new Array);d(this,"lengths",new Array);d(this,"segments",new Array);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let s=0,r=e.bones.length;s<r;s++){let o=t.findBone(e.bones[s].name);if(!o)throw new Error(`Couldn't find bone ${e.bones[s].name}.`);this.bones.push(o)}let i=t.findSlot(e.target.name);if(!i)throw new Error(`Couldn't find target bone ${e.target.name}`);this.target=i,this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY}isActive(){return this.active}setToSetupPose(){const e=this.data;this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY}update(e){let t=this.target.getAttachment();if(!(t instanceof nt))return;let i=this.mixRotate,s=this.mixX,r=this.mixY;if(i==0&&s==0&&r==0)return;let o=this.data,a=o.rotateMode==rt.Tangent,h=o.rotateMode==rt.ChainScale,n=this.bones,l=n.length,c=a?l:l+1,u=O.setArraySize(this.spaces,c),f=h?this.lengths=O.setArraySize(this.lengths,l):[],m=this.spacing;switch(o.spacingMode){case ve.Percent:if(h)for(let v=0,S=c-1;v<S;v++){let E=n[v],I=E.data.length,R=I*E.a,F=I*E.c;f[v]=Math.sqrt(R*R+F*F)}O.arrayFill(u,1,c,m);break;case ve.Proportional:let x=0;for(let v=0,S=c-1;v<S;){let E=n[v],I=E.data.length;if(I<Xe.epsilon)h&&(f[v]=0),u[++v]=m;else{let R=I*E.a,F=I*E.c,L=Math.sqrt(R*R+F*F);h&&(f[v]=L),u[++v]=L,x+=L}}if(x>0){x=c/x*m;for(let v=1;v<c;v++)u[v]*=x}break;default:let A=o.spacingMode==ve.Length;for(let v=0,S=c-1;v<S;){let E=n[v],I=E.data.length;if(I<Xe.epsilon)h&&(f[v]=0),u[++v]=m;else{let R=I*E.a,F=I*E.c,L=Math.sqrt(R*R+F*F);h&&(f[v]=L),u[++v]=(A?I+m:m)*L/I}}}let g=this.computeWorldPositions(t,c,a),p=g[0],b=g[1],y=o.offsetRotation,w=!1;if(y==0)w=o.rotateMode==rt.Chain;else{w=!1;let x=this.target.bone;y*=x.a*x.d-x.b*x.c>0?V.degRad:-.01745329277777778}for(let x=0,A=3;x<l;x++,A+=3){let v=n[x];v.worldX+=(p-v.worldX)*s,v.worldY+=(b-v.worldY)*r;let S=g[A],E=g[A+1],I=S-p,R=E-b;if(h){let F=f[x];if(F!=0){let L=(Math.sqrt(I*I+R*R)/F-1)*i+1;v.a*=L,v.c*=L}}if(p=S,b=E,i>0){let F=v.a,L=v.b,B=v.c,T=v.d,Y=0,X=0,re=0;if(a?Y=g[A-1]:u[x+1]==0?Y=g[A+2]:Y=Math.atan2(R,I),Y-=Math.atan2(B,F),w){X=Math.cos(Y),re=Math.sin(Y);let ne=v.data.length;p+=(ne*(X*F-re*B)-I)*i,b+=(ne*(re*F+X*B)-R)*i}else Y+=y;Y>V.PI?Y-=V.PI2:Y<-3.1415927&&(Y+=V.PI2),Y*=i,X=Math.cos(Y),re=Math.sin(Y),v.a=X*F-re*B,v.b=X*L-re*T,v.c=re*F+X*B,v.d=re*L+X*T}v.updateAppliedTransform()}}computeWorldPositions(e,t,i){let s=this.target,r=this.position,o=this.spaces,a=O.setArraySize(this.positions,t*3+2),h=this.world,n=e.closed,l=e.worldVerticesLength,c=l/6,u=Xe.NONE;if(!e.constantSpeed){let ne=e.lengths;c-=n?1:2;let ee=ne[c];this.data.positionMode==Ge.Percent&&(r*=ee);let ce;switch(this.data.spacingMode){case ve.Percent:ce=ee;break;case ve.Proportional:ce=ee/t;break;default:ce=1}h=O.setArraySize(this.world,8);for(let me=0,ge=0,D=0;me<t;me++,ge+=3){let le=o[me]*ce;r+=le;let oe=r;if(n)oe%=ee,oe<0&&(oe+=ee),D=0;else if(oe<0){u!=Xe.BEFORE&&(u=Xe.BEFORE,e.computeWorldVertices(s,2,4,h,0,2)),this.addBeforePosition(oe,h,0,a,ge);continue}else if(oe>ee){u!=Xe.AFTER&&(u=Xe.AFTER,e.computeWorldVertices(s,l-6,4,h,0,2)),this.addAfterPosition(oe-ee,h,0,a,ge);continue}for(;;D++){let Be=ne[D];if(!(oe>Be)){if(D==0)oe/=Be;else{let Re=ne[D-1];oe=(oe-Re)/(Be-Re)}break}}D!=u&&(u=D,n&&D==c?(e.computeWorldVertices(s,l-4,4,h,0,2),e.computeWorldVertices(s,0,4,h,4,2)):e.computeWorldVertices(s,D*6+2,8,h,0,2)),this.addCurvePosition(oe,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],a,ge,i||me>0&&le==0)}return a}n?(l+=2,h=O.setArraySize(this.world,l),e.computeWorldVertices(s,2,l-4,h,0,2),e.computeWorldVertices(s,0,2,h,l-4,2),h[l-2]=h[0],h[l-1]=h[1]):(c--,l-=4,h=O.setArraySize(this.world,l),e.computeWorldVertices(s,2,l,h,0,2));let f=O.setArraySize(this.curves,c),m=0,g=h[0],p=h[1],b=0,y=0,w=0,x=0,A=0,v=0,S=0,E=0,I=0,R=0,F=0,L=0,B=0,T=0;for(let ne=0,ee=2;ne<c;ne++,ee+=6)b=h[ee],y=h[ee+1],w=h[ee+2],x=h[ee+3],A=h[ee+4],v=h[ee+5],S=(g-b*2+w)*.1875,E=(p-y*2+x)*.1875,I=((b-w)*3-g+A)*.09375,R=((y-x)*3-p+v)*.09375,F=S*2+I,L=E*2+R,B=(b-g)*.75+S+I*.16666667,T=(y-p)*.75+E+R*.16666667,m+=Math.sqrt(B*B+T*T),B+=F,T+=L,F+=I,L+=R,m+=Math.sqrt(B*B+T*T),B+=F,T+=L,m+=Math.sqrt(B*B+T*T),B+=F+I,T+=L+R,m+=Math.sqrt(B*B+T*T),f[ne]=m,g=A,p=v;this.data.positionMode==Ge.Percent&&(r*=m);let Y;switch(this.data.spacingMode){case ve.Percent:Y=m;break;case ve.Proportional:Y=m/t;break;default:Y=1}let X=this.segments,re=0;for(let ne=0,ee=0,ce=0,me=0;ne<t;ne++,ee+=3){let ge=o[ne]*Y;r+=ge;let D=r;if(n)D%=m,D<0&&(D+=m),ce=0;else if(D<0){this.addBeforePosition(D,h,0,a,ee);continue}else if(D>m){this.addAfterPosition(D-m,h,l-4,a,ee);continue}for(;;ce++){let le=f[ce];if(!(D>le)){if(ce==0)D/=le;else{let oe=f[ce-1];D=(D-oe)/(le-oe)}break}}if(ce!=u){u=ce;let le=ce*6;for(g=h[le],p=h[le+1],b=h[le+2],y=h[le+3],w=h[le+4],x=h[le+5],A=h[le+6],v=h[le+7],S=(g-b*2+w)*.03,E=(p-y*2+x)*.03,I=((b-w)*3-g+A)*.006,R=((y-x)*3-p+v)*.006,F=S*2+I,L=E*2+R,B=(b-g)*.3+S+I*.16666667,T=(y-p)*.3+E+R*.16666667,re=Math.sqrt(B*B+T*T),X[0]=re,le=1;le<8;le++)B+=F,T+=L,F+=I,L+=R,re+=Math.sqrt(B*B+T*T),X[le]=re;B+=F,T+=L,re+=Math.sqrt(B*B+T*T),X[8]=re,B+=F+I,T+=L+R,re+=Math.sqrt(B*B+T*T),X[9]=re,me=0}for(D*=re;;me++){let le=X[me];if(!(D>le)){if(me==0)D/=le;else{let oe=X[me-1];D=me+(D-oe)/(le-oe)}break}}this.addCurvePosition(D*.1,g,p,b,y,w,x,A,v,a,ee,i||ne>0&&ge==0)}return a}addBeforePosition(e,t,i,s,r){let o=t[i],a=t[i+1],h=t[i+2]-o,n=t[i+3]-a,l=Math.atan2(n,h);s[r]=o+e*Math.cos(l),s[r+1]=a+e*Math.sin(l),s[r+2]=l}addAfterPosition(e,t,i,s,r){let o=t[i+2],a=t[i+3],h=o-t[i],n=a-t[i+1],l=Math.atan2(n,h);s[r]=o+e*Math.cos(l),s[r+1]=a+e*Math.sin(l),s[r+2]=l}addCurvePosition(e,t,i,s,r,o,a,h,n,l,c,u){if(e==0||isNaN(e)){l[c]=t,l[c+1]=i,l[c+2]=Math.atan2(r-i,s-t);return}let f=e*e,m=f*e,g=1-e,p=g*g,b=p*g,y=g*e,w=y*3,x=g*w,A=w*e,v=t*b+s*x+o*A+h*m,S=i*b+r*x+a*A+n*m;l[c]=v,l[c+1]=S,u&&(e<.001?l[c+2]=Math.atan2(r-i,s-t):l[c+2]=Math.atan2(S-(i*p+r*y*2+a*f),v-(t*p+s*y*2+o*f)))}};d(Xe,"NONE",-1),d(Xe,"BEFORE",-2),d(Xe,"AFTER",-3),d(Xe,"epsilon",1e-5);let ns=Xe;class Ui{constructor(e,t){d(this,"data");d(this,"_bone",null);d(this,"inertia",0);d(this,"strength",0);d(this,"damping",0);d(this,"massInverse",0);d(this,"wind",0);d(this,"gravity",0);d(this,"mix",0);d(this,"_reset",!0);d(this,"ux",0);d(this,"uy",0);d(this,"cx",0);d(this,"cy",0);d(this,"tx",0);d(this,"ty",0);d(this,"xOffset",0);d(this,"xVelocity",0);d(this,"yOffset",0);d(this,"yVelocity",0);d(this,"rotateOffset",0);d(this,"rotateVelocity",0);d(this,"scaleOffset",0);d(this,"scaleVelocity",0);d(this,"active",!1);d(this,"skeleton");d(this,"remaining",0);d(this,"lastTime",0);this.data=e,this.skeleton=t,this.bone=t.bones[e.bone.index],this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix}set bone(e){this._bone=e}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const e=this.data;this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix}isActive(){return this.active}update(e){const t=this.mix;if(t==0)return;const i=this.data.x>0,s=this.data.y>0,r=this.data.rotate>0||this.data.shearX>0,o=this.data.scaleX>0,a=this.bone,h=a.data.length;switch(e){case Oe.none:return;case Oe.reset:this.reset();case Oe.update:const n=this.skeleton,l=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=l,this.lastTime=n.time;const c=a.worldX,u=a.worldY;if(this._reset)this._reset=!1,this.ux=c,this.uy=u;else{let f=this.remaining,m=this.inertia,g=this.data.step,p=this.skeleton.data.referenceScale,b=-1,y=this.data.limit*l,w=y*Math.abs(n.scaleY);if(y*=Math.abs(n.scaleX),i||s){if(i){const x=(this.ux-c)*m;this.xOffset+=x>y?y:x<-y?-y:x,this.ux=c}if(s){const x=(this.uy-u)*m;this.yOffset+=x>w?w:x<-w?-w:x,this.uy=u}if(f>=g){b=Math.pow(this.damping,60*g);const x=this.massInverse*g,A=this.strength,v=this.wind*p*n.scaleX,S=this.gravity*p*n.scaleY;do i&&(this.xVelocity+=(v-this.xOffset*A)*x,this.xOffset+=this.xVelocity*g,this.xVelocity*=b),s&&(this.yVelocity-=(S+this.yOffset*A)*x,this.yOffset+=this.yVelocity*g,this.yVelocity*=b),f-=g;while(f>=g)}i&&(a.worldX+=this.xOffset*t*this.data.x),s&&(a.worldY+=this.yOffset*t*this.data.y)}if(r||o){let x=Math.atan2(a.c,a.a),A=0,v=0,S=0,E=this.cx-a.worldX,I=this.cy-a.worldY;if(E>y?E=y:E<-y&&(E=-y),I>w?I=w:I<-w&&(I=-w),r){S=(this.data.rotate+this.data.shearX)*t;let R=Math.atan2(I+this.ty,E+this.tx)-x-this.rotateOffset*S;this.rotateOffset+=(R-Math.ceil(R*V.invPI2-.5)*V.PI2)*m,R=this.rotateOffset*S+x,A=Math.cos(R),v=Math.sin(R),o&&(R=h*a.getWorldScaleX(),R>0&&(this.scaleOffset+=(E*A+I*v)*m/R))}else{A=Math.cos(x),v=Math.sin(x);const R=h*a.getWorldScaleX();R>0&&(this.scaleOffset+=(E*A+I*v)*m/R)}if(f=this.remaining,f>=g){b==-1&&(b=Math.pow(this.damping,60*g));const R=this.massInverse*g,F=this.strength,L=this.wind,B=this.gravity,T=h/p;for(;;)if(f-=g,o&&(this.scaleVelocity+=(L*A-B*v-this.scaleOffset*F)*R,this.scaleOffset+=this.scaleVelocity*g,this.scaleVelocity*=b),r){if(this.rotateVelocity-=((L*v+B*A)*T+this.rotateOffset*F)*R,this.rotateOffset+=this.rotateVelocity*g,this.rotateVelocity*=b,f<g)break;const Y=this.rotateOffset*S+x;A=Math.cos(Y),v=Math.sin(Y)}else if(f<g)break}}this.remaining=f}this.cx=a.worldX,this.cy=a.worldY;break;case Oe.pose:i&&(a.worldX+=this.xOffset*t*this.data.x),s&&(a.worldY+=this.yOffset*t*this.data.y)}if(r){let n=this.rotateOffset*t,l=0,c=0,u=0;if(this.data.shearX>0){let f=0;this.data.rotate>0&&(f=n*this.data.rotate,l=Math.sin(f),c=Math.cos(f),u=a.b,a.b=c*u-l*a.d,a.d=l*u+c*a.d),f+=n*this.data.shearX,l=Math.sin(f),c=Math.cos(f),u=a.a,a.a=c*u-l*a.c,a.c=l*u+c*a.c}else n*=this.data.rotate,l=Math.sin(n),c=Math.cos(n),u=a.a,a.a=c*u-l*a.c,a.c=l*u+c*a.c,u=a.b,a.b=c*u-l*a.d,a.d=l*u+c*a.d}if(o){const n=1+this.scaleOffset*t*this.data.scaleX;a.a*=n,a.c*=n}e!=Oe.pose&&(this.tx=h*a.a,this.ty=h*a.c),a.updateAppliedTransform()}translate(e,t){this.ux-=e,this.uy-=t,this.cx-=e,this.cy-=t}rotate(e,t,i){const s=i*V.degRad,r=Math.cos(s),o=Math.sin(s),a=this.cx-e,h=this.cy-t;this.translate(a*r-h*o-a,a*o+h*r-h)}}class zi{constructor(e,t){d(this,"data");d(this,"bone");d(this,"color");d(this,"darkColor",null);d(this,"attachment",null);d(this,"attachmentState",0);d(this,"sequenceIndex",-1);d(this,"deform",new Array);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("bone cannot be null.");this.data=e,this.bone=t,this.color=new N,this.darkColor=e.darkColor?new N:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(e){this.attachment!=e&&((!(e instanceof De)||!(this.attachment instanceof De)||e.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=e,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class Wi{constructor(e,t){d(this,"data");d(this,"bones");d(this,"target");d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0);d(this,"mixScaleX",0);d(this,"mixScaleY",0);d(this,"mixShearY",0);d(this,"temp",new qe);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let s=0;s<e.bones.length;s++){let r=t.findBone(e.bones[s].name);if(!r)throw new Error(`Couldn't find bone ${e.bones[s].name}.`);this.bones.push(r)}let i=t.findBone(e.target.name);if(!i)throw new Error(`Couldn't find target bone ${e.target.name}.`);this.target=i,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY}isActive(){return this.active}setToSetupPose(){const e=this.data;this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY}update(e){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleY==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let e=this.mixRotate,t=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,a=t!=0||i!=0,h=this.target,n=h.a,l=h.b,c=h.c,u=h.d,f=n*u-l*c>0?V.degRad:-.01745329277777778,m=this.data.offsetRotation*f,g=this.data.offsetShearY*f,p=this.bones;for(let b=0,y=p.length;b<y;b++){let w=p[b];if(e!=0){let x=w.a,A=w.b,v=w.c,S=w.d,E=Math.atan2(c,n)-Math.atan2(v,x)+m;E>V.PI?E-=V.PI2:E<-3.1415927&&(E+=V.PI2),E*=e;let I=Math.cos(E),R=Math.sin(E);w.a=I*x-R*v,w.b=I*A-R*S,w.c=R*x+I*v,w.d=R*A+I*S}if(a){let x=this.temp;h.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),w.worldX+=(x.x-w.worldX)*t,w.worldY+=(x.y-w.worldY)*i}if(s!=0){let x=Math.sqrt(w.a*w.a+w.c*w.c);x!=0&&(x=(x+(Math.sqrt(n*n+c*c)-x+this.data.offsetScaleX)*s)/x),w.a*=x,w.c*=x}if(r!=0){let x=Math.sqrt(w.b*w.b+w.d*w.d);x!=0&&(x=(x+(Math.sqrt(l*l+u*u)-x+this.data.offsetScaleY)*r)/x),w.b*=x,w.d*=x}if(o>0){let x=w.b,A=w.d,v=Math.atan2(A,x),S=Math.atan2(u,l)-Math.atan2(c,n)-(v-Math.atan2(w.c,w.a));S>V.PI?S-=V.PI2:S<-3.1415927&&(S+=V.PI2),S=v+(S+g)*o;let E=Math.sqrt(x*x+A*A);w.b=Math.cos(S)*E,w.d=Math.sin(S)*E}w.updateAppliedTransform()}}applyRelativeWorld(){let e=this.mixRotate,t=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,a=t!=0||i!=0,h=this.target,n=h.a,l=h.b,c=h.c,u=h.d,f=n*u-l*c>0?V.degRad:-.01745329277777778,m=this.data.offsetRotation*f,g=this.data.offsetShearY*f,p=this.bones;for(let b=0,y=p.length;b<y;b++){let w=p[b];if(e!=0){let x=w.a,A=w.b,v=w.c,S=w.d,E=Math.atan2(c,n)+m;E>V.PI?E-=V.PI2:E<-3.1415927&&(E+=V.PI2),E*=e;let I=Math.cos(E),R=Math.sin(E);w.a=I*x-R*v,w.b=I*A-R*S,w.c=R*x+I*v,w.d=R*A+I*S}if(a){let x=this.temp;h.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),w.worldX+=x.x*t,w.worldY+=x.y*i}if(s!=0){let x=(Math.sqrt(n*n+c*c)-1+this.data.offsetScaleX)*s+1;w.a*=x,w.c*=x}if(r!=0){let x=(Math.sqrt(l*l+u*u)-1+this.data.offsetScaleY)*r+1;w.b*=x,w.d*=x}if(o>0){let x=Math.atan2(u,l)-Math.atan2(c,n);x>V.PI?x-=V.PI2:x<-3.1415927&&(x+=V.PI2);let A=w.b,v=w.d;x=Math.atan2(v,A)+(x-V.PI/2+g)*o;let S=Math.sqrt(A*A+v*v);w.b=Math.cos(x)*S,w.d=Math.sin(x)*S}w.updateAppliedTransform()}}applyAbsoluteLocal(){let e=this.mixRotate,t=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,a=this.target,h=this.bones;for(let n=0,l=h.length;n<l;n++){let c=h[n],u=c.arotation;e!=0&&(u+=(a.arotation-u+this.data.offsetRotation)*e);let f=c.ax,m=c.ay;f+=(a.ax-f+this.data.offsetX)*t,m+=(a.ay-m+this.data.offsetY)*i;let g=c.ascaleX,p=c.ascaleY;s!=0&&g!=0&&(g=(g+(a.ascaleX-g+this.data.offsetScaleX)*s)/g),r!=0&&p!=0&&(p=(p+(a.ascaleY-p+this.data.offsetScaleY)*r)/p);let b=c.ashearY;o!=0&&(b+=(a.ashearY-b+this.data.offsetShearY)*o),c.updateWorldTransformWith(f,m,u,g,p,c.ashearX,b)}}applyRelativeLocal(){let e=this.mixRotate,t=this.mixX,i=this.mixY,s=this.mixScaleX,r=this.mixScaleY,o=this.mixShearY,a=this.target,h=this.bones;for(let n=0,l=h.length;n<l;n++){let c=h[n],u=c.arotation+(a.arotation+this.data.offsetRotation)*e,f=c.ax+(a.ax+this.data.offsetX)*t,m=c.ay+(a.ay+this.data.offsetY)*i,g=c.ascaleX*((a.ascaleX-1+this.data.offsetScaleX)*s+1),p=c.ascaleY*((a.ascaleY-1+this.data.offsetScaleY)*r+1),b=c.ashearY+(a.ashearY+this.data.offsetShearY)*o;c.updateWorldTransformWith(f,m,u,g,p,c.ashearX,b)}}}const mt=class mt{constructor(e){d(this,"data");d(this,"bones");d(this,"slots");d(this,"drawOrder");d(this,"ikConstraints");d(this,"transformConstraints");d(this,"pathConstraints");d(this,"physicsConstraints");d(this,"_updateCache",new Array);d(this,"skin",null);d(this,"color");d(this,"scaleX",1);d(this,"_scaleY",1);d(this,"x",0);d(this,"y",0);d(this,"time",0);if(!e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(let t=0;t<e.bones.length;t++){let i=e.bones[t],s;if(!i.parent)s=new Cs(i,this,null);else{let r=this.bones[i.parent.index];s=new Cs(i,this,r),r.children.push(s)}this.bones.push(s)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<e.slots.length;t++){let i=e.slots[t],s=this.bones[i.boneData.index],r=new zi(i,s);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let t=0;t<e.ikConstraints.length;t++){let i=e.ikConstraints[t];this.ikConstraints.push(new Di(i,this))}this.transformConstraints=new Array;for(let t=0;t<e.transformConstraints.length;t++){let i=e.transformConstraints[t];this.transformConstraints.push(new Wi(i,this))}this.pathConstraints=new Array;for(let t=0;t<e.pathConstraints.length;t++){let i=e.pathConstraints[t];this.pathConstraints.push(new ns(i,this))}this.physicsConstraints=new Array;for(let t=0;t<e.physicsConstraints.length;t++){let i=e.physicsConstraints[t];this.physicsConstraints.push(new Ui(i,this))}this.color=new N(1,1,1,1),this.updateCache()}get scaleY(){return mt.yDown?-this._scaleY:this._scaleY}set scaleY(e){this._scaleY=e}updateCache(){let e=this._updateCache;e.length=0;let t=this.bones;for(let u=0,f=t.length;u<f;u++){let m=t[u];m.sorted=m.data.skinRequired,m.active=!m.sorted}if(this.skin){let u=this.skin.bones;for(let f=0,m=this.skin.bones.length;f<m;f++){let g=this.bones[u[f].index];do g.sorted=!1,g.active=!0,g=g.parent;while(g)}}let i=this.ikConstraints,s=this.transformConstraints,r=this.pathConstraints,o=this.physicsConstraints,a=i.length,h=s.length,n=r.length,l=this.physicsConstraints.length,c=a+h+n+l;e:for(let u=0;u<c;u++){for(let f=0;f<a;f++){let m=i[f];if(m.data.order==u){this.sortIkConstraint(m);continue e}}for(let f=0;f<h;f++){let m=s[f];if(m.data.order==u){this.sortTransformConstraint(m);continue e}}for(let f=0;f<n;f++){let m=r[f];if(m.data.order==u){this.sortPathConstraint(m);continue e}}for(let f=0;f<l;f++){const m=o[f];if(m.data.order==u){this.sortPhysicsConstraint(m);continue e}}}for(let u=0,f=t.length;u<f;u++)this.sortBone(t[u])}sortIkConstraint(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&O.contains(this.skin.constraints,e.data,!0)),!e.active)return;let t=e.target;this.sortBone(t);let i=e.bones,s=i[0];if(this.sortBone(s),i.length==1)this._updateCache.push(e),this.sortReset(s.children);else{let r=i[i.length-1];this.sortBone(r),this._updateCache.push(e),this.sortReset(s.children),r.sorted=!0}}sortPathConstraint(e){if(e.active=e.target.bone.isActive()&&(!e.data.skinRequired||this.skin&&O.contains(this.skin.constraints,e.data,!0)),!e.active)return;let t=e.target,i=t.data.index,s=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,i,s),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,s);for(let h=0,n=this.data.skins.length;h<n;h++)this.sortPathConstraintAttachment(this.data.skins[h],i,s);let r=t.getAttachment();r instanceof nt&&this.sortPathConstraintAttachmentWith(r,s);let o=e.bones,a=o.length;for(let h=0;h<a;h++)this.sortBone(o[h]);this._updateCache.push(e);for(let h=0;h<a;h++)this.sortReset(o[h].children);for(let h=0;h<a;h++)o[h].sorted=!0}sortTransformConstraint(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&O.contains(this.skin.constraints,e.data,!0)),!e.active)return;this.sortBone(e.target);let t=e.bones,i=t.length;if(e.data.local)for(let s=0;s<i;s++){let r=t[s];this.sortBone(r.parent),this.sortBone(r)}else for(let s=0;s<i;s++)this.sortBone(t[s]);this._updateCache.push(e);for(let s=0;s<i;s++)this.sortReset(t[s].children);for(let s=0;s<i;s++)t[s].sorted=!0}sortPathConstraintAttachment(e,t,i){let s=e.attachments[t];if(s)for(let r in s)this.sortPathConstraintAttachmentWith(s[r],i)}sortPathConstraintAttachmentWith(e,t){if(!(e instanceof nt))return;let i=e.bones;if(!i)this.sortBone(t);else{let s=this.bones;for(let r=0,o=i.length;r<o;){let a=i[r++];for(a+=r;r<a;)this.sortBone(s[i[r++]])}}}sortPhysicsConstraint(e){const t=e.bone;e.active=t.active&&(!e.data.skinRequired||this.skin!=null&&O.contains(this.skin.constraints,e.data,!0)),e.active&&(this.sortBone(t),this._updateCache.push(e),this.sortReset(t.children),t.sorted=!0)}sortBone(e){if(!e||e.sorted)return;let t=e.parent;t&&this.sortBone(t),e.sorted=!0,this._updateCache.push(e)}sortReset(e){for(let t=0,i=e.length;t<i;t++){let s=e[t];s.active&&(s.sorted&&this.sortReset(s.children),s.sorted=!1)}}updateWorldTransform(e){if(e==null)throw new Error("physics is undefined");let t=this.bones;for(let s=0,r=t.length;s<r;s++){let o=t[s];o.ax=o.x,o.ay=o.y,o.arotation=o.rotation,o.ascaleX=o.scaleX,o.ascaleY=o.scaleY,o.ashearX=o.shearX,o.ashearY=o.shearY}let i=this._updateCache;for(let s=0,r=i.length;s<r;s++)i[s].update(e)}updateWorldTransformWith(e,t){if(!t)throw new Error("parent cannot be null.");let i=this.bones;for(let p=1,b=i.length;p<b;p++){let y=i[p];y.ax=y.x,y.ay=y.y,y.arotation=y.rotation,y.ascaleX=y.scaleX,y.ascaleY=y.scaleY,y.ashearX=y.shearX,y.ashearY=y.shearY}let s=this.getRootBone();if(!s)throw new Error("Root bone must not be null.");let r=t.a,o=t.b,a=t.c,h=t.d;s.worldX=r*this.x+o*this.y+t.worldX,s.worldY=a*this.x+h*this.y+t.worldY;const n=(s.rotation+s.shearX)*V.degRad,l=(s.rotation+90+s.shearY)*V.degRad,c=Math.cos(n)*s.scaleX,u=Math.cos(l)*s.scaleY,f=Math.sin(n)*s.scaleX,m=Math.sin(l)*s.scaleY;s.a=(r*c+o*f)*this.scaleX,s.b=(r*u+o*m)*this.scaleX,s.c=(a*c+h*f)*this.scaleY,s.d=(a*u+h*m)*this.scaleY;let g=this._updateCache;for(let p=0,b=g.length;p<b;p++){let y=g[p];y!=s&&y.update(e)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const e of this.bones)e.setToSetupPose();for(const e of this.ikConstraints)e.setToSetupPose();for(const e of this.transformConstraints)e.setToSetupPose();for(const e of this.pathConstraints)e.setToSetupPose();for(const e of this.physicsConstraints)e.setToSetupPose()}setSlotsToSetupPose(){let e=this.slots;O.arrayCopy(e,0,this.drawOrder,0,e.length);for(let t=0,i=e.length;t<i;t++)e[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(e){if(!e)throw new Error("boneName cannot be null.");let t=this.bones;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.data.name==e)return r}return null}findSlot(e){if(!e)throw new Error("slotName cannot be null.");let t=this.slots;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.data.name==e)return r}return null}setSkinByName(e){let t=this.data.findSkin(e);if(!t)throw new Error("Skin not found: "+e);this.setSkin(t)}setSkin(e){if(e!=this.skin){if(e)if(this.skin)e.attachAll(this,this.skin);else{let t=this.slots;for(let i=0,s=t.length;i<s;i++){let r=t[i],o=r.data.attachmentName;if(o){let a=e.getAttachment(i,o);a&&r.setAttachment(a)}}}this.skin=e,this.updateCache()}}getAttachmentByName(e,t){let i=this.data.findSlot(e);if(!i)throw new Error(`Can't find slot with name ${e}`);return this.getAttachment(i.index,t)}getAttachment(e,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){let i=this.skin.getAttachment(e,t);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(e,t):null}setAttachment(e,t){if(!e)throw new Error("slotName cannot be null.");let i=this.slots;for(let s=0,r=i.length;s<r;s++){let o=i[s];if(o.data.name==e){let a=null;if(t&&(a=this.getAttachment(s,t),!a))throw new Error("Attachment not found: "+t+", for slot: "+e);o.setAttachment(a);return}}throw new Error("Slot not found: "+e)}findIkConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.ikConstraints.find(t=>t.data.name==e)??null}findTransformConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.transformConstraints.find(t=>t.data.name==e)??null}findPathConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.pathConstraints.find(t=>t.data.name==e)??null}findPhysicsConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");return this.physicsConstraints.find(t=>t.data.name==e)??null}getBoundsRect(e){let t=new qe,i=new qe;return this.getBounds(t,i,void 0,e),{x:t.x,y:t.y,width:i.x,height:i.y}}getBounds(e,t,i=new Array(2),s=null){if(!e)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");let r=this.drawOrder,o=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(let l=0,c=r.length;l<c;l++){let u=r[l];if(!u.bone.active)continue;let f=0,m=null,g=null,p=u.getAttachment();if(p instanceof xt)f=8,m=O.setArraySize(i,f,0),p.computeWorldVertices(u,m,0,2),g=mt.quadTriangles;else if(p instanceof tt){let b=p;f=b.worldVerticesLength,m=O.setArraySize(i,f,0),b.computeWorldVertices(u,0,f,m,0,2),g=b.triangles}else if(p instanceof vt&&s!=null){s.clipStart(u,p);continue}if(m&&g){s!=null&&s.isClipping()&&(s.clipTriangles(m,g,g.length),m=s.clippedVertices,f=s.clippedVertices.length);for(let b=0,y=m.length;b<y;b+=2){let w=m[b],x=m[b+1];o=Math.min(o,w),a=Math.min(a,x),h=Math.max(h,w),n=Math.max(n,x)}}s!=null&&s.clipEndWithSlot(u)}s!=null&&s.clipEnd(),e.set(o,a),t.set(h-o,n-a)}update(e){this.time+=e}physicsTranslate(e,t){const i=this.physicsConstraints;for(let s=0,r=i.length;s<r;s++)i[s].translate(e,t)}physicsRotate(e,t,i){const s=this.physicsConstraints;for(let r=0,o=s.length;r<o;r++)s[r].rotate(e,t,i)}};d(mt,"quadTriangles",[0,1,2,2,3,0]),d(mt,"yDown",!1);let as=mt;var Oe;(function(C){C[C.none=0]="none",C[C.reset=1]="reset",C[C.update=2]="update",C[C.pose=3]="pose"})(Oe||(Oe={}));class yi extends Zt{constructor(t){super(t,0,!1);d(this,"_bone",null);d(this,"x",0);d(this,"y",0);d(this,"rotate",0);d(this,"scaleX",0);d(this,"shearX",0);d(this,"limit",0);d(this,"step",0);d(this,"inertia",0);d(this,"strength",0);d(this,"damping",0);d(this,"massInverse",0);d(this,"wind",0);d(this,"gravity",0);d(this,"mix",0);d(this,"inertiaGlobal",!1);d(this,"strengthGlobal",!1);d(this,"dampingGlobal",!1);d(this,"massGlobal",!1);d(this,"windGlobal",!1);d(this,"gravityGlobal",!1);d(this,"mixGlobal",!1)}set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}}class vi{constructor(){d(this,"name",null);d(this,"bones",new Array);d(this,"slots",new Array);d(this,"skins",new Array);d(this,"defaultSkin",null);d(this,"events",new Array);d(this,"animations",new Array);d(this,"ikConstraints",new Array);d(this,"transformConstraints",new Array);d(this,"pathConstraints",new Array);d(this,"physicsConstraints",new Array);d(this,"x",0);d(this,"y",0);d(this,"width",0);d(this,"height",0);d(this,"referenceScale",100);d(this,"version",null);d(this,"hash",null);d(this,"fps",0);d(this,"imagesPath",null);d(this,"audioPath",null)}findBone(e){if(!e)throw new Error("boneName cannot be null.");let t=this.bones;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.name==e)return r}return null}findSlot(e){if(!e)throw new Error("slotName cannot be null.");let t=this.slots;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.name==e)return r}return null}findSkin(e){if(!e)throw new Error("skinName cannot be null.");let t=this.skins;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.name==e)return r}return null}findEvent(e){if(!e)throw new Error("eventDataName cannot be null.");let t=this.events;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.name==e)return r}return null}findAnimation(e){if(!e)throw new Error("animationName cannot be null.");let t=this.animations;for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.name==e)return r}return null}findIkConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let i=0,s=t.length;i<s;i++){const r=t[i];if(r.name==e)return r}return null}findTransformConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let i=0,s=t.length;i<s;i++){const r=t[i];if(r.name==e)return r}return null}findPathConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let i=0,s=t.length;i<s;i++){const r=t[i];if(r.name==e)return r}return null}findPhysicsConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.physicsConstraints;for(let i=0,s=t.length;i<s;i++){const r=t[i];if(r.name==e)return r}return null}}class Ss{constructor(e=0,t,i){d(this,"slotIndex");d(this,"name");d(this,"attachment");this.slotIndex=e,this.name=t,this.attachment=i}}class ls{constructor(e){d(this,"name");d(this,"attachments",new Array);d(this,"bones",Array());d(this,"constraints",new Array);d(this,"color",new N(.99607843,.61960787,.30980393,1));if(!e)throw new Error("name cannot be null.");this.name=e}setAttachment(e,t,i){if(!i)throw new Error("attachment cannot be null.");let s=this.attachments;e>=s.length&&(s.length=e+1),s[e]||(s[e]={}),s[e][t]=i}addSkin(e){for(let s=0;s<e.bones.length;s++){let r=e.bones[s],o=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<e.constraints.length;s++){let r=e.constraints[s],o=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==r){o=!0;break}o||this.constraints.push(r)}let t=e.getAttachments();for(let s=0;s<t.length;s++){var i=t[s];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(e){for(let s=0;s<e.bones.length;s++){let r=e.bones[s],o=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==r){o=!0;break}o||this.bones.push(r)}for(let s=0;s<e.constraints.length;s++){let r=e.constraints[s],o=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==r){o=!0;break}o||this.constraints.push(r)}let t=e.getAttachments();for(let s=0;s<t.length;s++){var i=t[s];i.attachment&&(i.attachment instanceof tt?(i.attachment=i.attachment.newLinkedMesh(),this.setAttachment(i.slotIndex,i.name,i.attachment)):(i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment)))}}getAttachment(e,t){let i=this.attachments[e];return i?i[t]:null}removeAttachment(e,t){let i=this.attachments[e];i&&delete i[t]}getAttachments(){let e=new Array;for(var t=0;t<this.attachments.length;t++){let i=this.attachments[t];if(i)for(let s in i){let r=i[s];r&&e.push(new Ss(t,s,r))}}return e}getAttachmentsForSlot(e,t){let i=this.attachments[e];if(i)for(let s in i){let r=i[s];r&&t.push(new Ss(e,s,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(e,t){let i=0;for(let s=0;s<e.slots.length;s++){let r=e.slots[s],o=r.getAttachment();if(o&&i<t.attachments.length){let a=t.attachments[i];for(let h in a){let n=a[h];if(o==n){let l=this.getAttachment(i,h);l&&r.setAttachment(l);break}}}i++}}}class Ai{constructor(e,t,i){d(this,"index",0);d(this,"name");d(this,"boneData");d(this,"color",new N(1,1,1,1));d(this,"darkColor",null);d(this,"attachmentName",null);d(this,"blendMode",kt.Normal);d(this,"visible",!0);if(e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");if(!i)throw new Error("boneData cannot be null.");this.index=e,this.name=t,this.boneData=i}}var kt;(function(C){C[C.Normal=0]="Normal",C[C.Additive=1]="Additive",C[C.Multiply=2]="Multiply",C[C.Screen=3]="Screen"})(kt||(kt={}));class Ci extends Zt{constructor(t){super(t,0,!1);d(this,"bones",new Array);d(this,"_target",null);d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0);d(this,"mixScaleX",0);d(this,"mixScaleY",0);d(this,"mixShearY",0);d(this,"offsetRotation",0);d(this,"offsetX",0);d(this,"offsetY",0);d(this,"offsetScaleX",0);d(this,"offsetScaleY",0);d(this,"offsetShearY",0);d(this,"relative",!1);d(this,"local",!1)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class qi{constructor(e){d(this,"scale",1);d(this,"attachmentLoader");d(this,"linkedMeshes",new Array);this.attachmentLoader=e}readSkeletonData(e){let t=this.scale,i=new vi;i.name="";let s=new Gi(e),r=s.readInt32(),o=s.readInt32();i.hash=o==0&&r==0?null:o.toString(16)+r.toString(16),i.version=s.readString(),i.x=s.readFloat(),i.y=s.readFloat(),i.width=s.readFloat(),i.height=s.readFloat(),i.referenceScale=s.readFloat()*t;let a=s.readBoolean();a&&(i.fps=s.readFloat(),i.imagesPath=s.readString(),i.audioPath=s.readString());let h=0;h=s.readInt(!0);for(let l=0;l<h;l++){let c=s.readString();if(!c)throw new Error("String in string table must not be null.");s.strings.push(c)}h=s.readInt(!0);for(let l=0;l<h;l++){let c=s.readString();if(!c)throw new Error("Bone name must not be null.");let u=l==0?null:i.bones[s.readInt(!0)],f=new mi(l,c,u);f.rotation=s.readFloat(),f.x=s.readFloat()*t,f.y=s.readFloat()*t,f.scaleX=s.readFloat(),f.scaleY=s.readFloat(),f.shearX=s.readFloat(),f.shearY=s.readFloat(),f.length=s.readFloat()*t,f.inherit=s.readByte(),f.skinRequired=s.readBoolean(),a&&(N.rgba8888ToColor(f.color,s.readInt32()),f.icon=s.readString()??void 0,f.visible=s.readBoolean()),i.bones.push(f)}h=s.readInt(!0);for(let l=0;l<h;l++){let c=s.readString();if(!c)throw new Error("Slot name must not be null.");let u=i.bones[s.readInt(!0)],f=new Ai(l,c,u);N.rgba8888ToColor(f.color,s.readInt32());let m=s.readInt32();m!=-1&&N.rgb888ToColor(f.darkColor=new N,m),f.attachmentName=s.readStringRef(),f.blendMode=s.readInt(!0),a&&(f.visible=s.readBoolean()),i.slots.push(f)}h=s.readInt(!0);for(let l=0,c;l<h;l++){let u=s.readString();if(!u)throw new Error("IK constraint data name must not be null.");let f=new wi(u);f.order=s.readInt(!0),c=s.readInt(!0);for(let g=0;g<c;g++)f.bones.push(i.bones[s.readInt(!0)]);f.target=i.bones[s.readInt(!0)];let m=s.readByte();f.skinRequired=(m&1)!=0,f.bendDirection=m&2?1:-1,f.compress=(m&4)!=0,f.stretch=(m&8)!=0,f.uniform=(m&16)!=0,m&32&&(f.mix=m&64?s.readFloat():1),m&128&&(f.softness=s.readFloat()*t),i.ikConstraints.push(f)}h=s.readInt(!0);for(let l=0,c;l<h;l++){let u=s.readString();if(!u)throw new Error("Transform constraint data name must not be null.");let f=new Ci(u);f.order=s.readInt(!0),c=s.readInt(!0);for(let g=0;g<c;g++)f.bones.push(i.bones[s.readInt(!0)]);f.target=i.bones[s.readInt(!0)];let m=s.readByte();f.skinRequired=(m&1)!=0,f.local=(m&2)!=0,f.relative=(m&4)!=0,m&8&&(f.offsetRotation=s.readFloat()),m&16&&(f.offsetX=s.readFloat()*t),m&32&&(f.offsetY=s.readFloat()*t),m&64&&(f.offsetScaleX=s.readFloat()),m&128&&(f.offsetScaleY=s.readFloat()),m=s.readByte(),m&1&&(f.offsetShearY=s.readFloat()),m&2&&(f.mixRotate=s.readFloat()),m&4&&(f.mixX=s.readFloat()),m&8&&(f.mixY=s.readFloat()),m&16&&(f.mixScaleX=s.readFloat()),m&32&&(f.mixScaleY=s.readFloat()),m&64&&(f.mixShearY=s.readFloat()),i.transformConstraints.push(f)}h=s.readInt(!0);for(let l=0,c;l<h;l++){let u=s.readString();if(!u)throw new Error("Path constraint data name must not be null.");let f=new bi(u);f.order=s.readInt(!0),f.skinRequired=s.readBoolean(),c=s.readInt(!0);for(let g=0;g<c;g++)f.bones.push(i.bones[s.readInt(!0)]);f.target=i.slots[s.readInt(!0)];const m=s.readByte();f.positionMode=m&1,f.spacingMode=m>>1&3,f.rotateMode=m>>3&3,m&128&&(f.offsetRotation=s.readFloat()),f.position=s.readFloat(),f.positionMode==Ge.Fixed&&(f.position*=t),f.spacing=s.readFloat(),(f.spacingMode==ve.Length||f.spacingMode==ve.Fixed)&&(f.spacing*=t),f.mixRotate=s.readFloat(),f.mixX=s.readFloat(),f.mixY=s.readFloat(),i.pathConstraints.push(f)}h=s.readInt(!0);for(let l=0,c;l<h;l++){const u=s.readString();if(!u)throw new Error("Physics constraint data name must not be null.");const f=new yi(u);f.order=s.readInt(!0),f.bone=i.bones[s.readInt(!0)];let m=s.readByte();f.skinRequired=(m&1)!=0,m&2&&(f.x=s.readFloat()),m&4&&(f.y=s.readFloat()),m&8&&(f.rotate=s.readFloat()),m&16&&(f.scaleX=s.readFloat()),m&32&&(f.shearX=s.readFloat()),f.limit=(m&64?s.readFloat():5e3)*t,f.step=1/s.readUnsignedByte(),f.inertia=s.readFloat(),f.strength=s.readFloat(),f.damping=s.readFloat(),f.massInverse=m&128?s.readFloat():1,f.wind=s.readFloat(),f.gravity=s.readFloat(),m=s.readByte(),m&1&&(f.inertiaGlobal=!0),m&2&&(f.strengthGlobal=!0),m&4&&(f.dampingGlobal=!0),m&8&&(f.massGlobal=!0),m&16&&(f.windGlobal=!0),m&32&&(f.gravityGlobal=!0),m&64&&(f.mixGlobal=!0),f.mix=m&128?s.readFloat():1,i.physicsConstraints.push(f)}let n=this.readSkin(s,i,!0,a);n&&(i.defaultSkin=n,i.skins.push(n));{let l=i.skins.length;for(O.setArraySize(i.skins,h=l+s.readInt(!0));l<h;l++){let c=this.readSkin(s,i,!1,a);if(!c)throw new Error("readSkin() should not have returned null.");i.skins[l]=c}}h=this.linkedMeshes.length;for(let l=0;l<h;l++){let c=this.linkedMeshes[l];const u=i.skins[c.skinIndex];if(!c.parent)throw new Error("Linked mesh parent must not be null");let f=u.getAttachment(c.slotIndex,c.parent);if(!f)throw new Error(`Parent mesh not found: ${c.parent}`);c.mesh.timelineAttachment=c.inheritTimeline?f:c.mesh,c.mesh.setParentMesh(f),c.mesh.region!=null&&c.mesh.updateRegion()}this.linkedMeshes.length=0,h=s.readInt(!0);for(let l=0;l<h;l++){let c=s.readString();if(!c)throw new Error("Event data name must not be null");let u=new xi(c);u.intValue=s.readInt(!1),u.floatValue=s.readFloat(),u.stringValue=s.readString(),u.audioPath=s.readString(),u.audioPath&&(u.volume=s.readFloat(),u.balance=s.readFloat()),i.events.push(u)}h=s.readInt(!0);for(let l=0;l<h;l++){let c=s.readString();if(!c)throw new Error("Animatio name must not be null.");i.animations.push(this.readAnimation(s,c,i))}return i}readSkin(e,t,i,s){let r=null,o=0;if(i){if(o=e.readInt(!0),o==0)return null;r=new ls("default")}else{let a=e.readString();if(!a)throw new Error("Skin name must not be null.");r=new ls(a),s&&N.rgba8888ToColor(r.color,e.readInt32()),r.bones.length=e.readInt(!0);for(let h=0,n=r.bones.length;h<n;h++)r.bones[h]=t.bones[e.readInt(!0)];for(let h=0,n=e.readInt(!0);h<n;h++)r.constraints.push(t.ikConstraints[e.readInt(!0)]);for(let h=0,n=e.readInt(!0);h<n;h++)r.constraints.push(t.transformConstraints[e.readInt(!0)]);for(let h=0,n=e.readInt(!0);h<n;h++)r.constraints.push(t.pathConstraints[e.readInt(!0)]);for(let h=0,n=e.readInt(!0);h<n;h++)r.constraints.push(t.physicsConstraints[e.readInt(!0)]);o=e.readInt(!0)}for(let a=0;a<o;a++){let h=e.readInt(!0);for(let n=0,l=e.readInt(!0);n<l;n++){let c=e.readStringRef();if(!c)throw new Error("Attachment name must not be null");let u=this.readAttachment(e,t,r,h,c,s);u&&r.setAttachment(h,c,u)}}return r}readAttachment(e,t,i,s,r,o){let a=this.scale,h=e.readByte();const n=h&8?e.readStringRef():r;if(!n)throw new Error("Attachment name must not be null");switch(h&7){case Je.Region:{let l=h&16?e.readStringRef():null;const c=h&32?e.readInt32():4294967295,u=h&64?this.readSequence(e):null;let f=h&128?e.readFloat():0,m=e.readFloat(),g=e.readFloat(),p=e.readFloat(),b=e.readFloat(),y=e.readFloat(),w=e.readFloat();l||(l=n);let x=this.attachmentLoader.newRegionAttachment(i,n,l,u);return x?(x.path=l,x.x=m*a,x.y=g*a,x.scaleX=p,x.scaleY=b,x.rotation=f,x.width=y*a,x.height=w*a,N.rgba8888ToColor(x.color,c),x.sequence=u,u==null&&x.updateRegion(),x):null}case Je.BoundingBox:{let l=this.readVertices(e,(h&16)!=0),c=o?e.readInt32():0,u=this.attachmentLoader.newBoundingBoxAttachment(i,n);return u?(u.worldVerticesLength=l.length,u.vertices=l.vertices,u.bones=l.bones,o&&N.rgba8888ToColor(u.color,c),u):null}case Je.Mesh:{let l=h&16?e.readStringRef():n;const c=h&32?e.readInt32():4294967295,u=h&64?this.readSequence(e):null,f=e.readInt(!0),m=this.readVertices(e,(h&128)!=0),g=this.readFloatArray(e,m.length,1),p=this.readShortArray(e,(m.length-f-2)*3);let b=[],y=0,w=0;o&&(b=this.readShortArray(e,e.readInt(!0)),y=e.readFloat(),w=e.readFloat()),l||(l=n);let x=this.attachmentLoader.newMeshAttachment(i,n,l,u);return x?(x.path=l,N.rgba8888ToColor(x.color,c),x.bones=m.bones,x.vertices=m.vertices,x.worldVerticesLength=m.length,x.triangles=p,x.regionUVs=g,u==null&&x.updateRegion(),x.hullLength=f<<1,x.sequence=u,o&&(x.edges=b,x.width=y*a,x.height=w*a),x):null}case Je.LinkedMesh:{const l=h&16?e.readStringRef():n;if(l==null)throw new Error("Path of linked mesh must not be null");const c=h&32?e.readInt32():4294967295,u=h&64?this.readSequence(e):null,f=(h&128)!=0,m=e.readInt(!0),g=e.readStringRef();let p=0,b=0;o&&(p=e.readFloat(),b=e.readFloat());let y=this.attachmentLoader.newMeshAttachment(i,n,l,u);return y?(y.path=l,N.rgba8888ToColor(y.color,c),y.sequence=u,o&&(y.width=p*a,y.height=b*a),this.linkedMeshes.push(new Hi(y,m,s,g,f)),y):null}case Je.Path:{const l=(h&16)!=0,c=(h&32)!=0,u=this.readVertices(e,(h&64)!=0),f=O.newArray(u.length/6,0);for(let p=0,b=f.length;p<b;p++)f[p]=e.readFloat()*a;const m=o?e.readInt32():0,g=this.attachmentLoader.newPathAttachment(i,n);return g?(g.closed=l,g.constantSpeed=c,g.worldVerticesLength=u.length,g.vertices=u.vertices,g.bones=u.bones,g.lengths=f,o&&N.rgba8888ToColor(g.color,m),g):null}case Je.Point:{const l=e.readFloat(),c=e.readFloat(),u=e.readFloat(),f=o?e.readInt32():0,m=this.attachmentLoader.newPointAttachment(i,n);return m?(m.x=c*a,m.y=u*a,m.rotation=l,o&&N.rgba8888ToColor(m.color,f),m):null}case Je.Clipping:{const l=e.readInt(!0),c=this.readVertices(e,(h&16)!=0);let u=o?e.readInt32():0,f=this.attachmentLoader.newClippingAttachment(i,n);return f?(f.endSlot=t.slots[l],f.worldVerticesLength=c.length,f.vertices=c.vertices,f.bones=c.bones,o&&N.rgba8888ToColor(f.color,u),f):null}}return null}readSequence(e){let t=new Pt(e.readInt(!0));return t.start=e.readInt(!0),t.digits=e.readInt(!0),t.setupIndex=e.readInt(!0),t}readVertices(e,t){const i=this.scale,s=e.readInt(!0),r=new ji;if(r.length=s<<1,!t)return r.vertices=this.readFloatArray(e,r.length,i),r;let o=new Array,a=new Array;for(let h=0;h<s;h++){let n=e.readInt(!0);a.push(n);for(let l=0;l<n;l++)a.push(e.readInt(!0)),o.push(e.readFloat()*i),o.push(e.readFloat()*i),o.push(e.readFloat())}return r.vertices=O.toFloatArray(o),r.bones=a,r}readFloatArray(e,t,i){let s=new Array(t);if(i==1)for(let r=0;r<t;r++)s[r]=e.readFloat();else for(let r=0;r<t;r++)s[r]=e.readFloat()*i;return s}readShortArray(e,t){let i=new Array(t);for(let s=0;s<t;s++)i[s]=e.readInt(!0);return i}readAnimation(e,t,i){e.readInt(!0);let s=new Array,r=this.scale;for(let n=0,l=e.readInt(!0);n<l;n++){let c=e.readInt(!0);for(let u=0,f=e.readInt(!0);u<f;u++){let m=e.readByte(),g=e.readInt(!0),p=g-1;switch(m){case nr:{let b=new ht(g,c);for(let y=0;y<g;y++)b.setFrame(y,e.readFloat(),e.readStringRef());s.push(b);break}case ar:{let b=e.readInt(!0),y=new Js(g,b,c),w=e.readFloat(),x=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255,S=e.readUnsignedByte()/255;for(let E=0,I=0;y.setFrame(E,w,x,A,v,S),E!=p;E++){let R=e.readFloat(),F=e.readUnsignedByte()/255,L=e.readUnsignedByte()/255,B=e.readUnsignedByte()/255,T=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(E);break;case We:he(e,y,I++,E,0,w,R,x,F,1),he(e,y,I++,E,1,w,R,A,L,1),he(e,y,I++,E,2,w,R,v,B,1),he(e,y,I++,E,3,w,R,S,T,1)}w=R,x=F,A=L,v=B,S=T}s.push(y);break}case lr:{let b=e.readInt(!0),y=new Ks(g,b,c),w=e.readFloat(),x=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255;for(let S=0,E=0;y.setFrame(S,w,x,A,v),S!=p;S++){let I=e.readFloat(),R=e.readUnsignedByte()/255,F=e.readUnsignedByte()/255,L=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(S);break;case We:he(e,y,E++,S,0,w,I,x,R,1),he(e,y,E++,S,1,w,I,A,F,1),he(e,y,E++,S,2,w,I,v,L,1)}w=I,x=R,A=F,v=L}s.push(y);break}case or:{let b=e.readInt(!0),y=new _s(g,b,c),w=e.readFloat(),x=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255,S=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,I=e.readUnsignedByte()/255,R=e.readUnsignedByte()/255;for(let F=0,L=0;y.setFrame(F,w,x,A,v,S,E,I,R),F!=p;F++){let B=e.readFloat(),T=e.readUnsignedByte()/255,Y=e.readUnsignedByte()/255,X=e.readUnsignedByte()/255,re=e.readUnsignedByte()/255,ne=e.readUnsignedByte()/255,ee=e.readUnsignedByte()/255,ce=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(F);break;case We:he(e,y,L++,F,0,w,B,x,T,1),he(e,y,L++,F,1,w,B,A,Y,1),he(e,y,L++,F,2,w,B,v,X,1),he(e,y,L++,F,3,w,B,S,re,1),he(e,y,L++,F,4,w,B,E,ne,1),he(e,y,L++,F,5,w,B,I,ee,1),he(e,y,L++,F,6,w,B,R,ce,1)}w=B,x=T,A=Y,v=X,S=re,E=ne,I=ee,R=ce}s.push(y);break}case hr:{let b=e.readInt(!0),y=new $s(g,b,c),w=e.readFloat(),x=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255,S=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,I=e.readUnsignedByte()/255;for(let R=0,F=0;y.setFrame(R,w,x,A,v,S,E,I),R!=p;R++){let L=e.readFloat(),B=e.readUnsignedByte()/255,T=e.readUnsignedByte()/255,Y=e.readUnsignedByte()/255,X=e.readUnsignedByte()/255,re=e.readUnsignedByte()/255,ne=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(R);break;case We:he(e,y,F++,R,0,w,L,x,B,1),he(e,y,F++,R,1,w,L,A,T,1),he(e,y,F++,R,2,w,L,v,Y,1),he(e,y,F++,R,3,w,L,S,X,1),he(e,y,F++,R,4,w,L,E,re,1),he(e,y,F++,R,5,w,L,I,ne,1)}w=L,x=B,A=T,v=Y,S=X,E=re,I=ne}s.push(y);break}case cr:{let b=new Qs(g,e.readInt(!0),c),y=e.readFloat(),w=e.readUnsignedByte()/255;for(let x=0,A=0;b.setFrame(x,y,w),x!=p;x++){let v=e.readFloat(),S=e.readUnsignedByte()/255;switch(e.readByte()){case ze:b.setStepped(x);break;case We:he(e,b,A++,x,0,y,v,w,S,1)}y=v,w=S}s.push(b)}}}}for(let n=0,l=e.readInt(!0);n<l;n++){let c=e.readInt(!0);for(let u=0,f=e.readInt(!0);u<f;u++){let m=e.readByte(),g=e.readInt(!0);if(m==rr){let b=new Zs(g,c);for(let y=0;y<g;y++)b.setFrame(y,e.readFloat(),e.readByte());s.push(b);continue}let p=e.readInt(!0);switch(m){case Zi:s.push(Ie(e,new Vt(g,p,c),1));break;case Ji:s.push(es(e,new Ns(g,p,c),r));break;case Ki:s.push(Ie(e,new Ds(g,p,c),r));break;case Qi:s.push(Ie(e,new Us(g,p,c),r));break;case _i:s.push(es(e,new zs(g,p,c),1));break;case $i:s.push(Ie(e,new Ws(g,p,c),1));break;case er:s.push(Ie(e,new qs(g,p,c),1));break;case tr:s.push(es(e,new Gs(g,p,c),1));break;case sr:s.push(Ie(e,new Hs(g,p,c),1));break;case ir:s.push(Ie(e,new js(g,p,c),1))}}}for(let n=0,l=e.readInt(!0);n<l;n++){let c=e.readInt(!0),u=e.readInt(!0),f=u-1,m=new ti(u,e.readInt(!0),c),g=e.readByte(),p=e.readFloat(),b=g&1?g&2?e.readFloat():1:0,y=g&4?e.readFloat()*r:0;for(let w=0,x=0;m.setFrame(w,p,b,y,g&8?1:-1,(g&16)!=0,(g&32)!=0),w!=f;w++){g=e.readByte();const A=e.readFloat(),v=g&1?g&2?e.readFloat():1:0,S=g&4?e.readFloat()*r:0;g&64?m.setStepped(w):g&128&&(he(e,m,x++,w,0,p,A,b,v,1),he(e,m,x++,w,1,p,A,y,S,r)),p=A,b=v,y=S}s.push(m)}for(let n=0,l=e.readInt(!0);n<l;n++){let c=e.readInt(!0),u=e.readInt(!0),f=u-1,m=new si(u,e.readInt(!0),c),g=e.readFloat(),p=e.readFloat(),b=e.readFloat(),y=e.readFloat(),w=e.readFloat(),x=e.readFloat(),A=e.readFloat();for(let v=0,S=0;m.setFrame(v,g,p,b,y,w,x,A),v!=f;v++){let E=e.readFloat(),I=e.readFloat(),R=e.readFloat(),F=e.readFloat(),L=e.readFloat(),B=e.readFloat(),T=e.readFloat();switch(e.readByte()){case ze:m.setStepped(v);break;case We:he(e,m,S++,v,0,g,E,p,I,1),he(e,m,S++,v,1,g,E,b,R,1),he(e,m,S++,v,2,g,E,y,F,1),he(e,m,S++,v,3,g,E,w,L,1),he(e,m,S++,v,4,g,E,x,B,1),he(e,m,S++,v,5,g,E,A,T,1)}g=E,p=I,b=R,y=F,w=L,x=B,A=T}s.push(m)}for(let n=0,l=e.readInt(!0);n<l;n++){let c=e.readInt(!0),u=i.pathConstraints[c];for(let f=0,m=e.readInt(!0);f<m;f++){const g=e.readByte(),p=e.readInt(!0),b=e.readInt(!0);switch(g){case ur:s.push(Ie(e,new ii(p,b,c),u.positionMode==Ge.Fixed?r:1));break;case mr:s.push(Ie(e,new ri(p,b,c),u.spacingMode==ve.Length||u.spacingMode==ve.Fixed?r:1));break;case gr:let y=new ni(p,b,c),w=e.readFloat(),x=e.readFloat(),A=e.readFloat(),v=e.readFloat();for(let S=0,E=0,I=y.getFrameCount()-1;y.setFrame(S,w,x,A,v),S!=I;S++){let R=e.readFloat(),F=e.readFloat(),L=e.readFloat(),B=e.readFloat();switch(e.readByte()){case ze:y.setStepped(S);break;case We:he(e,y,E++,S,0,w,R,x,F,1),he(e,y,E++,S,1,w,R,A,L,1),he(e,y,E++,S,2,w,R,v,B,1)}w=R,x=F,A=L,v=B}s.push(y)}}}for(let n=0,l=e.readInt(!0);n<l;n++){const c=e.readInt(!0)-1;for(let u=0,f=e.readInt(!0);u<f;u++){const m=e.readByte(),g=e.readInt(!0);if(m==Cr){const b=new Ot(g,c);for(let y=0;y<g;y++)b.setFrame(y,e.readFloat());s.push(b);continue}const p=e.readInt(!0);switch(m){case pr:s.push(Ie(e,new ai(g,p,c),1));break;case xr:s.push(Ie(e,new li(g,p,c),1));break;case wr:s.push(Ie(e,new oi(g,p,c),1));break;case br:s.push(Ie(e,new hi(g,p,c),1));break;case yr:s.push(Ie(e,new ci(g,p,c),1));break;case vr:s.push(Ie(e,new di(g,p,c),1));break;case Ar:s.push(Ie(e,new fi(g,p,c),1))}}}for(let n=0,l=e.readInt(!0);n<l;n++){let c=i.skins[e.readInt(!0)];for(let u=0,f=e.readInt(!0);u<f;u++){let m=e.readInt(!0);for(let g=0,p=e.readInt(!0);g<p;g++){let b=e.readStringRef();if(!b)throw new Error("attachmentName must not be null.");let y=c.getAttachment(m,b),w=e.readByte(),x=e.readInt(!0),A=x-1;switch(w){case dr:{let v=y,S=v.bones,E=v.vertices,I=S?E.length/3*2:E.length,R=e.readInt(!0),F=new ei(x,R,m,v),L=e.readFloat();for(let B=0,T=0;;B++){let Y,X=e.readInt(!0);if(X==0)Y=S?O.newFloatArray(I):E;else{Y=O.newFloatArray(I);let ne=e.readInt(!0);if(X+=ne,r==1)for(let ee=ne;ee<X;ee++)Y[ee]=e.readFloat();else for(let ee=ne;ee<X;ee++)Y[ee]=e.readFloat()*r;if(!S)for(let ee=0,ce=Y.length;ee<ce;ee++)Y[ee]+=E[ee]}if(F.setFrame(B,L,Y),B==A)break;let re=e.readFloat();switch(e.readByte()){case ze:F.setStepped(B);break;case We:he(e,F,T++,B,0,L,re,0,1,1)}L=re}s.push(F);break}case fr:{let v=new Nt(x,m,y);for(let S=0;S<x;S++){let E=e.readFloat(),I=e.readInt32();v.setFrame(S,E,Os[I&15],I>>4,e.readFloat())}s.push(v);break}}}}}let o=e.readInt(!0);if(o>0){let n=new it(o),l=i.slots.length;for(let c=0;c<o;c++){let u=e.readFloat(),f=e.readInt(!0),m=O.newArray(l,0);for(let y=l-1;y>=0;y--)m[y]=-1;let g=O.newArray(l-f,0),p=0,b=0;for(let y=0;y<f;y++){let w=e.readInt(!0);for(;p!=w;)g[b++]=p++;m[p+e.readInt(!0)]=p++}for(;p<l;)g[b++]=p++;for(let y=l-1;y>=0;y--)m[y]==-1&&(m[y]=g[--b]);n.setFrame(c,u,m)}s.push(n)}let a=e.readInt(!0);if(a>0){let n=new It(a);for(let l=0;l<a;l++){let c=e.readFloat(),u=i.events[e.readInt(!0)],f=new pi(c,u);f.intValue=e.readInt(!1),f.floatValue=e.readFloat(),f.stringValue=e.readString(),f.stringValue==null&&(f.stringValue=u.stringValue),f.data.audioPath&&(f.volume=e.readFloat(),f.balance=e.readFloat()),n.setFrame(l,f)}s.push(n)}let h=0;for(let n=0,l=s.length;n<l;n++)h=Math.max(h,s[n].getDuration());return new fs(t,s,h)}}class Gi{constructor(e,t=new Array,i=0,s=new DataView(e instanceof ArrayBuffer?e:e.buffer)){d(this,"strings");d(this,"index");d(this,"buffer");this.strings=t,this.index=i,this.buffer=s}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let e=this.buffer.getInt16(this.index);return this.index+=2,e}readInt32(){let e=this.buffer.getInt32(this.index);return this.index+=4,e}readInt(e){let t=this.readByte(),i=t&127;return t&128&&(t=this.readByte(),i|=(t&127)<<7,t&128&&(t=this.readByte(),i|=(t&127)<<14,t&128&&(t=this.readByte(),i|=(t&127)<<21,t&128&&(t=this.readByte(),i|=(t&127)<<28)))),e?i:i>>>1^-(i&1)}readStringRef(){let e=this.readInt(!0);return e==0?null:this.strings[e-1]}readString(){let e=this.readInt(!0);switch(e){case 0:return null;case 1:return""}e--;let t="";for(let i=0;i<e;){let s=this.readUnsignedByte();switch(s>>4){case 12:case 13:t+=String.fromCharCode((s&31)<<6|this.readByte()&63),i+=2;break;case 14:t+=String.fromCharCode((s&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),i+=3;break;default:t+=String.fromCharCode(s),i++}}return t}readFloat(){let e=this.buffer.getFloat32(this.index);return this.index+=4,e}readBoolean(){return this.readByte()!=0}}let Hi=class{constructor(e,t,i,s,r){d(this,"parent");d(this,"skinIndex");d(this,"slotIndex");d(this,"mesh");d(this,"inheritTimeline");this.mesh=e,this.skinIndex=t,this.slotIndex=i,this.parent=s,this.inheritTimeline=r}};class ji{constructor(e=null,t=null,i=0){d(this,"bones");d(this,"vertices");d(this,"length");this.bones=e,this.vertices=t,this.length=i}}var Je;(function(C){C[C.Region=0]="Region",C[C.BoundingBox=1]="BoundingBox",C[C.Mesh=2]="Mesh",C[C.LinkedMesh=3]="LinkedMesh",C[C.Path=4]="Path",C[C.Point=5]="Point",C[C.Clipping=6]="Clipping"})(Je||(Je={}));function Ie(C,e,t){let i=C.readFloat(),s=C.readFloat()*t;for(let r=0,o=0,a=e.getFrameCount()-1;e.setFrame(r,i,s),r!=a;r++){let h=C.readFloat(),n=C.readFloat()*t;switch(C.readByte()){case ze:e.setStepped(r);break;case We:he(C,e,o++,r,0,i,h,s,n,t)}i=h,s=n}return e}function es(C,e,t){let i=C.readFloat(),s=C.readFloat()*t,r=C.readFloat()*t;for(let o=0,a=0,h=e.getFrameCount()-1;e.setFrame(o,i,s,r),o!=h;o++){let n=C.readFloat(),l=C.readFloat()*t,c=C.readFloat()*t;switch(C.readByte()){case ze:e.setStepped(o);break;case We:he(C,e,a++,o,0,i,n,s,l,t),he(C,e,a++,o,1,i,n,r,c,t)}i=n,s=l,r=c}return e}function he(C,e,t,i,s,r,o,a,h,n){e.setBezier(t,i,s,r,a,C.readFloat(),C.readFloat()*n,C.readFloat(),C.readFloat()*n,o,h)}const Zi=0,Ji=1,Ki=2,Qi=3,_i=4,$i=5,er=6,tr=7,sr=8,ir=9,rr=10,nr=0,ar=1,lr=2,or=3,hr=4,cr=5,dr=0,fr=1,ur=0,mr=1,gr=2,pr=0,xr=1,wr=2,br=4,yr=5,vr=6,Ar=7,Cr=8,ze=1,We=2;class Sr{constructor(){d(this,"minX",0);d(this,"minY",0);d(this,"maxX",0);d(this,"maxY",0);d(this,"boundingBoxes",new Array);d(this,"polygons",new Array);d(this,"polygonPool",new Bt(()=>O.newFloatArray(16)))}update(e,t){if(!e)throw new Error("skeleton cannot be null.");let i=this.boundingBoxes,s=this.polygons,r=this.polygonPool,o=e.slots,a=o.length;i.length=0,r.freeAll(s),s.length=0;for(let h=0;h<a;h++){let n=o[h];if(!n.bone.active)continue;let l=n.getAttachment();if(l instanceof jt){let c=l;i.push(c);let u=r.obtain();u.length!=c.worldVerticesLength&&(u=O.newFloatArray(c.worldVerticesLength)),s.push(u),c.computeWorldVertices(n,0,c.worldVerticesLength,u,0,2)}}t?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,r=this.polygons;for(let o=0,a=r.length;o<a;o++){let h=r[o],n=h;for(let l=0,c=h.length;l<c;l+=2){let u=n[l],f=n[l+1];e=Math.min(e,u),t=Math.min(t,f),i=Math.max(i,u),s=Math.max(s,f)}}this.minX=e,this.minY=t,this.maxX=i,this.maxY=s}aabbContainsPoint(e,t){return e>=this.minX&&e<=this.maxX&&t>=this.minY&&t<=this.maxY}aabbIntersectsSegment(e,t,i,s){let r=this.minX,o=this.minY,a=this.maxX,h=this.maxY;if(e<=r&&i<=r||t<=o&&s<=o||e>=a&&i>=a||t>=h&&s>=h)return!1;let n=(s-t)/(i-e),l=n*(r-e)+t;if(l>o&&l<h||(l=n*(a-e)+t,l>o&&l<h))return!0;let c=(o-t)/n+e;return c>r&&c<a||(c=(h-t)/n+e,c>r&&c<a)}aabbIntersectsSkeleton(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY}containsPoint(e,t){let i=this.polygons;for(let s=0,r=i.length;s<r;s++)if(this.containsPointPolygon(i[s],e,t))return this.boundingBoxes[s];return null}containsPointPolygon(e,t,i){let s=e,r=e.length,o=r-2,a=!1;for(let h=0;h<r;h+=2){let n=s[h+1],l=s[o+1];if(n<i&&l>=i||l<i&&n>=i){let c=s[h];c+(i-n)/(l-n)*(s[o]-c)<t&&(a=!a)}o=h}return a}intersectsSegment(e,t,i,s){let r=this.polygons;for(let o=0,a=r.length;o<a;o++)if(this.intersectsSegmentPolygon(r[o],e,t,i,s))return this.boundingBoxes[o];return null}intersectsSegmentPolygon(e,t,i,s,r){let o=e,a=e.length,h=t-s,n=i-r,l=t*r-i*s,c=o[a-2],u=o[a-1];for(let f=0;f<a;f+=2){let m=o[f],g=o[f+1],p=c*g-u*m,b=c-m,y=u-g,w=h*y-n*b,x=(l*b-h*p)/w;if((x>=c&&x<=m||x>=m&&x<=c)&&(x>=t&&x<=s||x>=s&&x<=t)){let A=(l*y-n*p)/w;if((A>=u&&A<=g||A>=g&&A<=u)&&(A>=i&&A<=r||A>=r&&A<=i))return!0}c=m,u=g}return!1}getPolygon(e){if(!e)throw new Error("boundingBox cannot be null.");let t=this.boundingBoxes.indexOf(e);return t==-1?null:this.polygons[t]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class Ye{constructor(){d(this,"convexPolygons",new Array);d(this,"convexPolygonsIndices",new Array);d(this,"indicesArray",new Array);d(this,"isConcaveArray",new Array);d(this,"triangles",new Array);d(this,"polygonPool",new Bt(()=>new Array));d(this,"polygonIndicesPool",new Bt(()=>new Array))}triangulate(e){let t=e,i=e.length>>1,s=this.indicesArray;s.length=0;for(let a=0;a<i;a++)s[a]=a;let r=this.isConcaveArray;r.length=0;for(let a=0,h=i;a<h;++a)r[a]=Ye.isConcave(a,i,t,s);let o=this.triangles;for(o.length=0;i>3;){let a=i-1,h=0,n=1;for(;;){e:if(!r[h]){let u=s[a]<<1,f=s[h]<<1,m=s[n]<<1,g=t[u],p=t[u+1],b=t[f],y=t[f+1],w=t[m],x=t[m+1];for(let A=(n+1)%i;A!=a;A=(A+1)%i){if(!r[A])continue;let v=s[A]<<1,S=t[v],E=t[v+1];if(Ye.positiveArea(w,x,g,p,S,E)&&Ye.positiveArea(g,p,b,y,S,E)&&Ye.positiveArea(b,y,w,x,S,E))break e}break}if(n==0){do{if(!r[h])break;h--}while(h>0);break}a=h,h=n,n=(n+1)%i}o.push(s[(i+h-1)%i]),o.push(s[h]),o.push(s[(h+1)%i]),s.splice(h,1),r.splice(h,1),i--;let l=(i+h-1)%i,c=h==i?0:h;r[l]=Ye.isConcave(l,i,t,s),r[c]=Ye.isConcave(c,i,t,s)}return i==3&&(o.push(s[2]),o.push(s[0]),o.push(s[1])),o}decompose(e,t){let i=e,s=this.convexPolygons;this.polygonPool.freeAll(s),s.length=0;let r=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(r),r.length=0;let o=this.polygonIndicesPool.obtain();o.length=0;let a=this.polygonPool.obtain();a.length=0;let h=-1,n=0;for(let l=0,c=t.length;l<c;l+=3){let u=t[l]<<1,f=t[l+1]<<1,m=t[l+2]<<1,g=i[u],p=i[u+1],b=i[f],y=i[f+1],w=i[m],x=i[m+1],A=!1;if(h==u){let v=a.length-4,S=Ye.winding(a[v],a[v+1],a[v+2],a[v+3],w,x),E=Ye.winding(w,x,a[0],a[1],a[2],a[3]);S==n&&E==n&&(a.push(w),a.push(x),o.push(m),A=!0)}A||(a.length>0?(s.push(a),r.push(o)):(this.polygonPool.free(a),this.polygonIndicesPool.free(o)),a=this.polygonPool.obtain(),a.length=0,a.push(g),a.push(p),a.push(b),a.push(y),a.push(w),a.push(x),o=this.polygonIndicesPool.obtain(),o.length=0,o.push(u),o.push(f),o.push(m),n=Ye.winding(g,p,b,y,w,x),h=u)}a.length>0&&(s.push(a),r.push(o));for(let l=0,c=s.length;l<c;l++){if(o=r[l],o.length==0)continue;let u=o[0],f=o[o.length-1];a=s[l];let m=a.length-4,g=a[m],p=a[m+1],b=a[m+2],y=a[m+3],w=a[0],x=a[1],A=a[2],v=a[3],S=Ye.winding(g,p,b,y,w,x);for(let E=0;E<c;E++){if(E==l)continue;let I=r[E];if(I.length!=3)continue;let R=I[0],F=I[1],L=I[2],B=s[E],T=B[B.length-2],Y=B[B.length-1];if(R!=u||F!=f)continue;let X=Ye.winding(g,p,b,y,T,Y),re=Ye.winding(T,Y,w,x,A,v);X==S&&re==S&&(B.length=0,I.length=0,a.push(T),a.push(Y),o.push(L),g=b,p=y,b=T,y=Y,E=0)}}for(let l=s.length-1;l>=0;l--)a=s[l],a.length==0&&(s.splice(l,1),this.polygonPool.free(a),o=r[l],r.splice(l,1),this.polygonIndicesPool.free(o));return s}static isConcave(e,t,i,s){let r=s[(t+e-1)%t]<<1,o=s[e]<<1,a=s[(e+1)%t]<<1;return!this.positiveArea(i[r],i[r+1],i[o],i[o+1],i[a],i[a+1])}static positiveArea(e,t,i,s,r,o){return e*(o-s)+i*(t-o)+r*(s-t)>=0}static winding(e,t,i,s,r,o){let a=i-e,h=s-t;return r*h-o*a+a*t-e*h>=0?1:-1}}class Dt{constructor(){d(this,"triangulator",new Ye);d(this,"clippingPolygon",new Array);d(this,"clipOutput",new Array);d(this,"clippedVertices",new Array);d(this,"clippedUVs",new Array);d(this,"clippedTriangles",new Array);d(this,"scratch",new Array);d(this,"clipAttachment",null);d(this,"clippingPolygons",null)}clipStart(e,t){if(this.clipAttachment)return 0;this.clipAttachment=t;let i=t.worldVerticesLength,s=O.setArraySize(this.clippingPolygon,i);t.computeWorldVertices(e,0,i,s,0,2);let r=this.clippingPolygon;Dt.makeClockwise(r);let o=this.clippingPolygons=this.triangulator.decompose(r,this.triangulator.triangulate(r));for(let a=0,h=o.length;a<h;a++){let n=o[a];Dt.makeClockwise(n),n.push(n[0]),n.push(n[1])}return o.length}clipEndWithSlot(e){this.clipAttachment&&this.clipAttachment.endSlot==e.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return this.clipAttachment!=null}clipTriangles(e,t,i,s,r,o,a,h){let n,l,c,u,f,m;typeof t=="number"?(n=i,l=s,c=r,u=o,f=a,m=h):(n=t,l=i,c=s,u=r,f=o,m=a),c&&u&&f&&typeof m=="boolean"?this.clipTrianglesRender(e,n,l,c,u,f,m):this.clipTrianglesNoRender(e,n,l)}clipTrianglesNoRender(e,t,i){let s=this.clipOutput,r=this.clippedVertices,o=this.clippedTriangles,a=this.clippingPolygons,h=a.length,n=0;r.length=0,o.length=0;for(let l=0;l<i;l+=3){let c=t[l]<<1,u=e[c],f=e[c+1];c=t[l+1]<<1;let m=e[c],g=e[c+1];c=t[l+2]<<1;let p=e[c],b=e[c+1];for(let y=0;y<h;y++){let w=r.length;if(this.clip(u,f,m,g,p,b,a[y],s)){let x=s.length;if(x==0)continue;let A=x>>1,v=this.clipOutput,S=O.setArraySize(r,w+A*2);for(let I=0;I<x;I+=2,w+=2){let R=v[I],F=v[I+1];S[w]=R,S[w+1]=F}w=o.length;let E=O.setArraySize(o,w+3*(A-2));A--;for(let I=1;I<A;I++,w+=3)E[w]=n,E[w+1]=n+I,E[w+2]=n+I+1;n+=A+1}else{let x=O.setArraySize(r,w+6);x[w]=u,x[w+1]=f,x[w+2]=m,x[w+3]=g,x[w+4]=p,x[w+5]=b,w=o.length;let A=O.setArraySize(o,w+3);A[w]=n,A[w+1]=n+1,A[w+2]=n+2,n+=3;break}}}}clipTrianglesRender(e,t,i,s,r,o,a){let h=this.clipOutput,n=this.clippedVertices,l=this.clippedTriangles,c=this.clippingPolygons,u=c.length,f=a?12:8,m=0;n.length=0,l.length=0;for(let g=0;g<i;g+=3){let p=t[g]<<1,b=e[p],y=e[p+1],w=s[p],x=s[p+1];p=t[g+1]<<1;let A=e[p],v=e[p+1],S=s[p],E=s[p+1];p=t[g+2]<<1;let I=e[p],R=e[p+1],F=s[p],L=s[p+1];for(let B=0;B<u;B++){let T=n.length;if(this.clip(b,y,A,v,I,R,c[B],h)){let Y=h.length;if(Y==0)continue;let X=v-R,re=I-A,ne=b-I,ee=R-y,ce=1/(X*ne+re*(y-R)),me=Y>>1,ge=this.clipOutput,D=O.setArraySize(n,T+me*f);for(let oe=0;oe<Y;oe+=2,T+=f){let Be=ge[oe],Re=ge[oe+1];D[T]=Be,D[T+1]=Re,D[T+2]=r.r,D[T+3]=r.g,D[T+4]=r.b,D[T+5]=r.a;let we=Be-I,Se=Re-R,Ee=(X*we+re*Se)*ce,Qe=(ee*we+ne*Se)*ce,At=1-Ee-Qe;D[T+6]=w*Ee+S*Qe+F*At,D[T+7]=x*Ee+E*Qe+L*At,a&&(D[T+8]=o.r,D[T+9]=o.g,D[T+10]=o.b,D[T+11]=o.a)}T=l.length;let le=O.setArraySize(l,T+3*(me-2));me--;for(let oe=1;oe<me;oe++,T+=3)le[T]=m,le[T+1]=m+oe,le[T+2]=m+oe+1;m+=me+1}else{let Y=O.setArraySize(n,T+3*f);Y[T]=b,Y[T+1]=y,Y[T+2]=r.r,Y[T+3]=r.g,Y[T+4]=r.b,Y[T+5]=r.a,a?(Y[T+6]=w,Y[T+7]=x,Y[T+8]=o.r,Y[T+9]=o.g,Y[T+10]=o.b,Y[T+11]=o.a,Y[T+12]=A,Y[T+13]=v,Y[T+14]=r.r,Y[T+15]=r.g,Y[T+16]=r.b,Y[T+17]=r.a,Y[T+18]=S,Y[T+19]=E,Y[T+20]=o.r,Y[T+21]=o.g,Y[T+22]=o.b,Y[T+23]=o.a,Y[T+24]=I,Y[T+25]=R,Y[T+26]=r.r,Y[T+27]=r.g,Y[T+28]=r.b,Y[T+29]=r.a,Y[T+30]=F,Y[T+31]=L,Y[T+32]=o.r,Y[T+33]=o.g,Y[T+34]=o.b,Y[T+35]=o.a):(Y[T+6]=w,Y[T+7]=x,Y[T+8]=A,Y[T+9]=v,Y[T+10]=r.r,Y[T+11]=r.g,Y[T+12]=r.b,Y[T+13]=r.a,Y[T+14]=S,Y[T+15]=E,Y[T+16]=I,Y[T+17]=R,Y[T+18]=r.r,Y[T+19]=r.g,Y[T+20]=r.b,Y[T+21]=r.a,Y[T+22]=F,Y[T+23]=L),T=l.length;let X=O.setArraySize(l,T+3);X[T]=m,X[T+1]=m+1,X[T+2]=m+2,m+=3;break}}}}clipTrianglesUnpacked(e,t,i,s){let r=this.clipOutput,o=this.clippedVertices,a=this.clippedUVs,h=this.clippedTriangles,n=this.clippingPolygons,l=n.length,c=0;o.length=0,a.length=0,h.length=0;for(let u=0;u<i;u+=3){let f=t[u]<<1,m=e[f],g=e[f+1],p=s[f],b=s[f+1];f=t[u+1]<<1;let y=e[f],w=e[f+1],x=s[f],A=s[f+1];f=t[u+2]<<1;let v=e[f],S=e[f+1],E=s[f],I=s[f+1];for(let R=0;R<l;R++){let F=o.length;if(this.clip(m,g,y,w,v,S,n[R],r)){let L=r.length;if(L==0)continue;let B=w-S,T=v-y,Y=m-v,X=S-g,re=1/(B*Y+T*(g-S)),ne=L>>1,ee=this.clipOutput,ce=O.setArraySize(o,F+ne*2),me=O.setArraySize(a,F+ne*2);for(let D=0;D<L;D+=2,F+=2){let le=ee[D],oe=ee[D+1];ce[F]=le,ce[F+1]=oe;let Be=le-v,Re=oe-S,we=(B*Be+T*Re)*re,Se=(X*Be+Y*Re)*re,Ee=1-we-Se;me[F]=p*we+x*Se+E*Ee,me[F+1]=b*we+A*Se+I*Ee}F=h.length;let ge=O.setArraySize(h,F+3*(ne-2));ne--;for(let D=1;D<ne;D++,F+=3)ge[F]=c,ge[F+1]=c+D,ge[F+2]=c+D+1;c+=ne+1}else{let L=O.setArraySize(o,F+6);L[F]=m,L[F+1]=g,L[F+2]=y,L[F+3]=w,L[F+4]=v,L[F+5]=S;let B=O.setArraySize(a,F+3*2);B[F]=p,B[F+1]=b,B[F+2]=x,B[F+3]=A,B[F+4]=E,B[F+5]=I,F=h.length;let T=O.setArraySize(h,F+3);T[F]=c,T[F+1]=c+1,T[F+2]=c+2,c+=3;break}}}}clip(e,t,i,s,r,o,a,h){let n=h,l=!1,c;a.length%4>=2?(c=h,h=this.scratch):c=this.scratch,c.length=0,c.push(e),c.push(t),c.push(i),c.push(s),c.push(r),c.push(o),c.push(e),c.push(t),h.length=0;let u=a.length-4,f=a;for(let m=0;;m+=2){let g=f[m],p=f[m+1],b=g-f[m+2],y=p-f[m+3],w=h.length,x=c;for(let v=0,S=c.length-2;v<S;){let E=x[v],I=x[v+1];v+=2;let R=x[v],F=x[v+1],L=y*(g-R)>b*(p-F),B=y*(g-E)-b*(p-I);if(B>0){if(L){h.push(R),h.push(F);continue}let T=R-E,Y=F-I,X=B/(T*y-Y*b);if(X>=0&&X<=1)h.push(E+T*X),h.push(I+Y*X);else{h.push(R),h.push(F);continue}}else if(L){let T=R-E,Y=F-I,X=B/(T*y-Y*b);if(X>=0&&X<=1)h.push(E+T*X),h.push(I+Y*X),h.push(R),h.push(F);else{h.push(R),h.push(F);continue}}l=!0}if(w==h.length)return n.length=0,!0;if(h.push(h[0]),h.push(h[1]),m==u)break;let A=h;h=c,h.length=0,c=A}if(n!=h){n.length=0;for(let m=0,g=h.length-2;m<g;m++)n[m]=h[m]}else n.length=n.length-2;return l}static makeClockwise(e){let t=e,i=e.length,s=t[i-2]*t[1]-t[0]*t[i-1],r=0,o=0,a=0,h=0;for(let n=0,l=i-3;n<l;n+=2)r=t[n],o=t[n+1],a=t[n+2],h=t[n+3],s+=r*h-a*o;if(!(s<0))for(let n=0,l=i-2,c=i>>1;n<c;n+=2){let u=t[n],f=t[n+1],m=l-n;t[n]=t[m],t[n+1]=t[m+1],t[m]=u,t[m+1]=f}}}class Er{constructor(e){d(this,"attachmentLoader");d(this,"scale",1);d(this,"linkedMeshes",new Array);this.attachmentLoader=e}readSkeletonData(e){let t=this.scale,i=new vi,s=typeof e=="string"?JSON.parse(e):e,r=s.skeleton;if(r&&(i.hash=r.hash,i.version=r.spine,i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height,i.referenceScale=M(r,"referenceScale",100)*t,i.fps=r.fps,i.imagesPath=r.images??null,i.audioPath=r.audio??null),s.bones)for(let o=0;o<s.bones.length;o++){let a=s.bones[o],h=null,n=M(a,"parent",null);n&&(h=i.findBone(n));let l=new mi(i.bones.length,a.name,h);l.length=M(a,"length",0)*t,l.x=M(a,"x",0)*t,l.y=M(a,"y",0)*t,l.rotation=M(a,"rotation",0),l.scaleX=M(a,"scaleX",1),l.scaleY=M(a,"scaleY",1),l.shearX=M(a,"shearX",0),l.shearY=M(a,"shearY",0),l.inherit=O.enumValue(xe,M(a,"inherit","Normal")),l.skinRequired=M(a,"skin",!1);let c=M(a,"color",null);c&&l.color.setFromString(c),i.bones.push(l)}if(s.slots)for(let o=0;o<s.slots.length;o++){let a=s.slots[o],h=a.name,n=i.findBone(a.bone);if(!n)throw new Error(`Couldn't find bone ${a.bone} for slot ${h}`);let l=new Ai(i.slots.length,h,n),c=M(a,"color",null);c&&l.color.setFromString(c);let u=M(a,"dark",null);u&&(l.darkColor=N.fromString(u)),l.attachmentName=M(a,"attachment",null),l.blendMode=O.enumValue(kt,M(a,"blend","normal")),l.visible=M(a,"visible",!0),i.slots.push(l)}if(s.ik)for(let o=0;o<s.ik.length;o++){let a=s.ik[o],h=new wi(a.name);h.order=M(a,"order",0),h.skinRequired=M(a,"skin",!1);for(let l=0;l<a.bones.length;l++){let c=i.findBone(a.bones[l]);if(!c)throw new Error(`Couldn't find bone ${a.bones[l]} for IK constraint ${a.name}.`);h.bones.push(c)}let n=i.findBone(a.target);if(!n)throw new Error(`Couldn't find target bone ${a.target} for IK constraint ${a.name}.`);h.target=n,h.mix=M(a,"mix",1),h.softness=M(a,"softness",0)*t,h.bendDirection=M(a,"bendPositive",!0)?1:-1,h.compress=M(a,"compress",!1),h.stretch=M(a,"stretch",!1),h.uniform=M(a,"uniform",!1),i.ikConstraints.push(h)}if(s.transform)for(let o=0;o<s.transform.length;o++){let a=s.transform[o],h=new Ci(a.name);h.order=M(a,"order",0),h.skinRequired=M(a,"skin",!1);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],f=i.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for transform constraint ${a.name}.`);h.bones.push(f)}let n=a.target,l=i.findBone(n);if(!l)throw new Error(`Couldn't find target bone ${n} for transform constraint ${a.name}.`);h.target=l,h.local=M(a,"local",!1),h.relative=M(a,"relative",!1),h.offsetRotation=M(a,"rotation",0),h.offsetX=M(a,"x",0)*t,h.offsetY=M(a,"y",0)*t,h.offsetScaleX=M(a,"scaleX",0),h.offsetScaleY=M(a,"scaleY",0),h.offsetShearY=M(a,"shearY",0),h.mixRotate=M(a,"mixRotate",1),h.mixX=M(a,"mixX",1),h.mixY=M(a,"mixY",h.mixX),h.mixScaleX=M(a,"mixScaleX",1),h.mixScaleY=M(a,"mixScaleY",h.mixScaleX),h.mixShearY=M(a,"mixShearY",1),i.transformConstraints.push(h)}if(s.path)for(let o=0;o<s.path.length;o++){let a=s.path[o],h=new bi(a.name);h.order=M(a,"order",0),h.skinRequired=M(a,"skin",!1);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],f=i.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for path constraint ${a.name}.`);h.bones.push(f)}let n=a.target,l=i.findSlot(n);if(!l)throw new Error(`Couldn't find target slot ${n} for path constraint ${a.name}.`);h.target=l,h.positionMode=O.enumValue(Ge,M(a,"positionMode","Percent")),h.spacingMode=O.enumValue(ve,M(a,"spacingMode","Length")),h.rotateMode=O.enumValue(rt,M(a,"rotateMode","Tangent")),h.offsetRotation=M(a,"rotation",0),h.position=M(a,"position",0),h.positionMode==Ge.Fixed&&(h.position*=t),h.spacing=M(a,"spacing",0),(h.spacingMode==ve.Length||h.spacingMode==ve.Fixed)&&(h.spacing*=t),h.mixRotate=M(a,"mixRotate",1),h.mixX=M(a,"mixX",1),h.mixY=M(a,"mixY",h.mixX),i.pathConstraints.push(h)}if(s.physics)for(let o=0;o<s.physics.length;o++){const a=s.physics[o],h=new yi(a.name);h.order=M(a,"order",0),h.skinRequired=M(a,"skin",!1);const n=a.bone,l=i.findBone(n);if(l==null)throw new Error("Physics bone not found: "+n);h.bone=l,h.x=M(a,"x",0),h.y=M(a,"y",0),h.rotate=M(a,"rotate",0),h.scaleX=M(a,"scaleX",0),h.shearX=M(a,"shearX",0),h.limit=M(a,"limit",5e3)*t,h.step=1/M(a,"fps",60),h.inertia=M(a,"inertia",1),h.strength=M(a,"strength",100),h.damping=M(a,"damping",1),h.massInverse=1/M(a,"mass",1),h.wind=M(a,"wind",0),h.gravity=M(a,"gravity",0),h.mix=M(a,"mix",1),h.inertiaGlobal=M(a,"inertiaGlobal",!1),h.strengthGlobal=M(a,"strengthGlobal",!1),h.dampingGlobal=M(a,"dampingGlobal",!1),h.massGlobal=M(a,"massGlobal",!1),h.windGlobal=M(a,"windGlobal",!1),h.gravityGlobal=M(a,"gravityGlobal",!1),h.mixGlobal=M(a,"mixGlobal",!1),i.physicsConstraints.push(h)}if(s.skins)for(let o=0;o<s.skins.length;o++){let a=s.skins[o],h=new ls(a.name);if(a.bones)for(let n=0;n<a.bones.length;n++){let l=a.bones[n],c=i.findBone(l);if(!c)throw new Error(`Couldn't find bone ${l} for skin ${a.name}.`);h.bones.push(c)}if(a.ik)for(let n=0;n<a.ik.length;n++){let l=a.ik[n],c=i.findIkConstraint(l);if(!c)throw new Error(`Couldn't find IK constraint ${l} for skin ${a.name}.`);h.constraints.push(c)}if(a.transform)for(let n=0;n<a.transform.length;n++){let l=a.transform[n],c=i.findTransformConstraint(l);if(!c)throw new Error(`Couldn't find transform constraint ${l} for skin ${a.name}.`);h.constraints.push(c)}if(a.path)for(let n=0;n<a.path.length;n++){let l=a.path[n],c=i.findPathConstraint(l);if(!c)throw new Error(`Couldn't find path constraint ${l} for skin ${a.name}.`);h.constraints.push(c)}if(a.physics)for(let n=0;n<a.physics.length;n++){let l=a.physics[n],c=i.findPhysicsConstraint(l);if(!c)throw new Error(`Couldn't find physics constraint ${l} for skin ${a.name}.`);h.constraints.push(c)}for(let n in a.attachments){let l=i.findSlot(n);if(!l)throw new Error(`Couldn't find slot ${n} for skin ${a.name}.`);let c=a.attachments[n];for(let u in c){let f=this.readAttachment(c[u],h,l.index,u,i);f&&h.setAttachment(l.index,u,f)}}i.skins.push(h),h.name=="default"&&(i.defaultSkin=h)}for(let o=0,a=this.linkedMeshes.length;o<a;o++){let h=this.linkedMeshes[o],n=h.skin?i.findSkin(h.skin):i.defaultSkin;if(!n)throw new Error(`Skin not found: ${h.skin}`);let l=n.getAttachment(h.slotIndex,h.parent);if(!l)throw new Error(`Parent mesh not found: ${h.parent}`);h.mesh.timelineAttachment=h.inheritTimeline?l:h.mesh,h.mesh.setParentMesh(l),h.mesh.region!=null&&h.mesh.updateRegion()}if(this.linkedMeshes.length=0,s.events)for(let o in s.events){let a=s.events[o],h=new xi(o);h.intValue=M(a,"int",0),h.floatValue=M(a,"float",0),h.stringValue=M(a,"string",""),h.audioPath=M(a,"audio",null),h.audioPath&&(h.volume=M(a,"volume",1),h.balance=M(a,"balance",0)),i.events.push(h)}if(s.animations)for(let o in s.animations){let a=s.animations[o];this.readAnimation(a,o,i)}return i}readAttachment(e,t,i,s,r){let o=this.scale;switch(s=M(e,"name",s),M(e,"type","region")){case"region":{let a=M(e,"path",s),h=this.readSequence(M(e,"sequence",null)),n=this.attachmentLoader.newRegionAttachment(t,s,a,h);if(!n)return null;n.path=a,n.x=M(e,"x",0)*o,n.y=M(e,"y",0)*o,n.scaleX=M(e,"scaleX",1),n.scaleY=M(e,"scaleY",1),n.rotation=M(e,"rotation",0),n.width=e.width*o,n.height=e.height*o,n.sequence=h;let l=M(e,"color",null);return l&&n.color.setFromString(l),n.region!=null&&n.updateRegion(),n}case"boundingbox":{let a=this.attachmentLoader.newBoundingBoxAttachment(t,s);if(!a)return null;this.readVertices(e,a,e.vertexCount<<1);let h=M(e,"color",null);return h&&a.color.setFromString(h),a}case"mesh":case"linkedmesh":{let a=M(e,"path",s),h=this.readSequence(M(e,"sequence",null)),n=this.attachmentLoader.newMeshAttachment(t,s,a,h);if(!n)return null;n.path=a;let l=M(e,"color",null);l&&n.color.setFromString(l),n.width=M(e,"width",0)*o,n.height=M(e,"height",0)*o,n.sequence=h;let c=M(e,"parent",null);if(c)return this.linkedMeshes.push(new Ir(n,M(e,"skin",null),i,c,M(e,"timelines",!0))),n;let u=e.uvs;return this.readVertices(e,n,u.length),n.triangles=e.triangles,n.regionUVs=u,n.region!=null&&n.updateRegion(),n.edges=M(e,"edges",null),n.hullLength=M(e,"hull",0)*2,n}case"path":{let a=this.attachmentLoader.newPathAttachment(t,s);if(!a)return null;a.closed=M(e,"closed",!1),a.constantSpeed=M(e,"constantSpeed",!0);let h=e.vertexCount;this.readVertices(e,a,h<<1);let n=O.newArray(h/3,0);for(let c=0;c<e.lengths.length;c++)n[c]=e.lengths[c]*o;a.lengths=n;let l=M(e,"color",null);return l&&a.color.setFromString(l),a}case"point":{let a=this.attachmentLoader.newPointAttachment(t,s);if(!a)return null;a.x=M(e,"x",0)*o,a.y=M(e,"y",0)*o,a.rotation=M(e,"rotation",0);let h=M(e,"color",null);return h&&a.color.setFromString(h),a}case"clipping":{let a=this.attachmentLoader.newClippingAttachment(t,s);if(!a)return null;let h=M(e,"end",null);h&&(a.endSlot=r.findSlot(h));let n=e.vertexCount;this.readVertices(e,a,n<<1);let l=M(e,"color",null);return l&&a.color.setFromString(l),a}}return null}readSequence(e){if(e==null)return null;let t=new Pt(M(e,"count",0));return t.start=M(e,"start",1),t.digits=M(e,"digits",0),t.setupIndex=M(e,"setup",0),t}readVertices(e,t,i){let s=this.scale;t.worldVerticesLength=i;let r=e.vertices;if(i==r.length){let h=O.toFloatArray(r);if(s!=1)for(let n=0,l=r.length;n<l;n++)h[n]*=s;t.vertices=h;return}let o=new Array,a=new Array;for(let h=0,n=r.length;h<n;){let l=r[h++];a.push(l);for(let c=h+l*4;h<c;h+=4)a.push(r[h]),o.push(r[h+1]*s),o.push(r[h+2]*s),o.push(r[h+3])}t.bones=a,t.vertices=O.toFloatArray(o)}readAnimation(e,t,i){let s=this.scale,r=new Array;if(e.slots)for(let a in e.slots){let h=e.slots[a],n=i.findSlot(a);if(!n)throw new Error("Slot not found: "+a);let l=n.index;for(let c in h){let u=h[c];if(!u)continue;let f=u.length;if(c=="attachment"){let m=new ht(f,l);for(let g=0;g<f;g++){let p=u[g];m.setFrame(g,M(p,"time",0),M(p,"name",null))}r.push(m)}else if(c=="rgba"){let m=new Js(f,f<<2,l),g=u[0],p=M(g,"time",0),b=N.fromString(g.color);for(let y=0,w=0;;y++){m.setFrame(y,p,b.r,b.g,b.b,b.a);let x=u[y+1];if(!x){m.shrink(w);break}let A=M(x,"time",0),v=N.fromString(x.color),S=g.curve;S&&(w=ue(S,m,w,y,0,p,A,b.r,v.r,1),w=ue(S,m,w,y,1,p,A,b.g,v.g,1),w=ue(S,m,w,y,2,p,A,b.b,v.b,1),w=ue(S,m,w,y,3,p,A,b.a,v.a,1)),p=A,b=v,g=x}r.push(m)}else if(c=="rgb"){let m=new Ks(f,f*3,l),g=u[0],p=M(g,"time",0),b=N.fromString(g.color);for(let y=0,w=0;;y++){m.setFrame(y,p,b.r,b.g,b.b);let x=u[y+1];if(!x){m.shrink(w);break}let A=M(x,"time",0),v=N.fromString(x.color),S=g.curve;S&&(w=ue(S,m,w,y,0,p,A,b.r,v.r,1),w=ue(S,m,w,y,1,p,A,b.g,v.g,1),w=ue(S,m,w,y,2,p,A,b.b,v.b,1)),p=A,b=v,g=x}r.push(m)}else if(c=="alpha")r.push(Ve(u,new Qs(f,f,l),0,1));else if(c=="rgba2"){let m=new _s(f,f*7,l),g=u[0],p=M(g,"time",0),b=N.fromString(g.light),y=N.fromString(g.dark);for(let w=0,x=0;;w++){m.setFrame(w,p,b.r,b.g,b.b,b.a,y.r,y.g,y.b);let A=u[w+1];if(!A){m.shrink(x);break}let v=M(A,"time",0),S=N.fromString(A.light),E=N.fromString(A.dark),I=g.curve;I&&(x=ue(I,m,x,w,0,p,v,b.r,S.r,1),x=ue(I,m,x,w,1,p,v,b.g,S.g,1),x=ue(I,m,x,w,2,p,v,b.b,S.b,1),x=ue(I,m,x,w,3,p,v,b.a,S.a,1),x=ue(I,m,x,w,4,p,v,y.r,E.r,1),x=ue(I,m,x,w,5,p,v,y.g,E.g,1),x=ue(I,m,x,w,6,p,v,y.b,E.b,1)),p=v,b=S,y=E,g=A}r.push(m)}else if(c=="rgb2"){let m=new $s(f,f*6,l),g=u[0],p=M(g,"time",0),b=N.fromString(g.light),y=N.fromString(g.dark);for(let w=0,x=0;;w++){m.setFrame(w,p,b.r,b.g,b.b,y.r,y.g,y.b);let A=u[w+1];if(!A){m.shrink(x);break}let v=M(A,"time",0),S=N.fromString(A.light),E=N.fromString(A.dark),I=g.curve;I&&(x=ue(I,m,x,w,0,p,v,b.r,S.r,1),x=ue(I,m,x,w,1,p,v,b.g,S.g,1),x=ue(I,m,x,w,2,p,v,b.b,S.b,1),x=ue(I,m,x,w,3,p,v,y.r,E.r,1),x=ue(I,m,x,w,4,p,v,y.g,E.g,1),x=ue(I,m,x,w,5,p,v,y.b,E.b,1)),p=v,b=S,y=E,g=A}r.push(m)}}}if(e.bones)for(let a in e.bones){let h=e.bones[a],n=i.findBone(a);if(!n)throw new Error("Bone not found: "+a);let l=n.index;for(let c in h){let u=h[c],f=u.length;if(f!=0){if(c==="rotate")r.push(Ve(u,new Vt(f,f,l),0,1));else if(c==="translate"){let m=new Ns(f,f<<1,l);r.push(ts(u,m,"x","y",0,s))}else if(c==="translatex"){let m=new Ds(f,f,l);r.push(Ve(u,m,0,s))}else if(c==="translatey"){let m=new Us(f,f,l);r.push(Ve(u,m,0,s))}else if(c==="scale"){let m=new zs(f,f<<1,l);r.push(ts(u,m,"x","y",1,1))}else if(c==="scalex"){let m=new Ws(f,f,l);r.push(Ve(u,m,1,1))}else if(c==="scaley"){let m=new qs(f,f,l);r.push(Ve(u,m,1,1))}else if(c==="shear"){let m=new Gs(f,f<<1,l);r.push(ts(u,m,"x","y",0,1))}else if(c==="shearx"){let m=new Hs(f,f,l);r.push(Ve(u,m,0,1))}else if(c==="sheary"){let m=new js(f,f,l);r.push(Ve(u,m,0,1))}else if(c==="inherit"){let m=new Zs(f,n.index);for(let g=0;g<u.length;g++){let p=u[g];m.setFrame(g,M(p,"time",0),O.enumValue(xe,M(p,"inherit","Normal")))}r.push(m)}}}}if(e.ik)for(let a in e.ik){let h=e.ik[a],n=h[0];if(!n)continue;let l=i.findIkConstraint(a);if(!l)throw new Error("IK Constraint not found: "+a);let c=i.ikConstraints.indexOf(l),u=new ti(h.length,h.length<<1,c),f=M(n,"time",0),m=M(n,"mix",1),g=M(n,"softness",0)*s;for(let p=0,b=0;;p++){u.setFrame(p,f,m,g,M(n,"bendPositive",!0)?1:-1,M(n,"compress",!1),M(n,"stretch",!1));let y=h[p+1];if(!y){u.shrink(b);break}let w=M(y,"time",0),x=M(y,"mix",1),A=M(y,"softness",0)*s,v=n.curve;v&&(b=ue(v,u,b,p,0,f,w,m,x,1),b=ue(v,u,b,p,1,f,w,g,A,s)),f=w,m=x,g=A,n=y}r.push(u)}if(e.transform)for(let a in e.transform){let h=e.transform[a],n=h[0];if(!n)continue;let l=i.findTransformConstraint(a);if(!l)throw new Error("Transform constraint not found: "+a);let c=i.transformConstraints.indexOf(l),u=new si(h.length,h.length*6,c),f=M(n,"time",0),m=M(n,"mixRotate",1),g=M(n,"mixX",1),p=M(n,"mixY",g),b=M(n,"mixScaleX",1),y=M(n,"mixScaleY",b),w=M(n,"mixShearY",1);for(let x=0,A=0;;x++){u.setFrame(x,f,m,g,p,b,y,w);let v=h[x+1];if(!v){u.shrink(A);break}let S=M(v,"time",0),E=M(v,"mixRotate",1),I=M(v,"mixX",1),R=M(v,"mixY",I),F=M(v,"mixScaleX",1),L=M(v,"mixScaleY",F),B=M(v,"mixShearY",1),T=n.curve;T&&(A=ue(T,u,A,x,0,f,S,m,E,1),A=ue(T,u,A,x,1,f,S,g,I,1),A=ue(T,u,A,x,2,f,S,p,R,1),A=ue(T,u,A,x,3,f,S,b,F,1),A=ue(T,u,A,x,4,f,S,y,L,1),A=ue(T,u,A,x,5,f,S,w,B,1)),f=S,m=E,g=I,p=R,b=F,y=L,b=F,n=v}r.push(u)}if(e.path)for(let a in e.path){let h=e.path[a],n=i.findPathConstraint(a);if(!n)throw new Error("Path constraint not found: "+a);let l=i.pathConstraints.indexOf(n);for(let c in h){let u=h[c],f=u[0];if(!f)continue;let m=u.length;if(c==="position"){let g=new ii(m,m,l);r.push(Ve(u,g,0,n.positionMode==Ge.Fixed?s:1))}else if(c==="spacing"){let g=new ri(m,m,l);r.push(Ve(u,g,0,n.spacingMode==ve.Length||n.spacingMode==ve.Fixed?s:1))}else if(c==="mix"){let g=new ni(m,m*3,l),p=M(f,"time",0),b=M(f,"mixRotate",1),y=M(f,"mixX",1),w=M(f,"mixY",y);for(let x=0,A=0;;x++){g.setFrame(x,p,b,y,w);let v=u[x+1];if(!v){g.shrink(A);break}let S=M(v,"time",0),E=M(v,"mixRotate",1),I=M(v,"mixX",1),R=M(v,"mixY",I),F=f.curve;F&&(A=ue(F,g,A,x,0,p,S,b,E,1),A=ue(F,g,A,x,1,p,S,y,I,1),A=ue(F,g,A,x,2,p,S,w,R,1)),p=S,b=E,y=I,w=R,f=v}r.push(g)}}}if(e.physics)for(let a in e.physics){let h=e.physics[a],n=-1;if(a.length>0){let l=i.findPhysicsConstraint(a);if(!l)throw new Error("Physics constraint not found: "+a);n=i.physicsConstraints.indexOf(l)}for(let l in h){let c=h[l],u=c[0];if(!u)continue;let f=c.length;if(l=="reset"){const g=new Ot(f,n);for(let p=0;u!=null;u=c[p+1],p++)g.setFrame(p,M(u,"time",0));r.push(g);continue}let m;if(l=="inertia")m=new ai(f,f,n);else if(l=="strength")m=new li(f,f,n);else if(l=="damping")m=new oi(f,f,n);else if(l=="mass")m=new hi(f,f,n);else if(l=="wind")m=new ci(f,f,n);else if(l=="gravity")m=new di(f,f,n);else if(l=="mix")m=new fi(f,f,n);else continue;r.push(Ve(c,m,0,1))}}if(e.attachments)for(let a in e.attachments){let h=e.attachments[a],n=i.findSkin(a);if(!n)throw new Error("Skin not found: "+a);for(let l in h){let c=h[l],u=i.findSlot(l);if(!u)throw new Error("Slot not found: "+l);let f=u.index;for(let m in c){let g=c[m],p=n.getAttachment(f,m);for(let b in g){let y=g[b],w=y[0];if(w){if(b=="deform"){let x=p.bones,A=p.vertices,v=x?A.length/3*2:A.length,S=new ei(y.length,y.length,f,p),E=M(w,"time",0);for(let I=0,R=0;;I++){let F,L=M(w,"vertices",null);if(!L)F=x?O.newFloatArray(v):A;else{F=O.newFloatArray(v);let X=M(w,"offset",0);if(O.arrayCopy(L,0,F,X,L.length),s!=1)for(let re=X,ne=re+L.length;re<ne;re++)F[re]*=s;if(!x)for(let re=0;re<v;re++)F[re]+=A[re]}S.setFrame(I,E,F);let B=y[I+1];if(!B){S.shrink(R);break}let T=M(B,"time",0),Y=w.curve;Y&&(R=ue(Y,S,R,I,0,E,T,0,1,1)),E=T,w=B}r.push(S)}else if(b=="sequence"){let x=new Nt(y.length,f,p),A=0;for(let v=0;v<y.length;v++){let S=M(w,"delay",A),E=M(w,"time",0),I=Ae[M(w,"mode","hold")],R=M(w,"index",0);x.setFrame(v,E,I,R,S),A=S,w=y[v+1]}r.push(x)}}}}}}if(e.drawOrder){let a=new it(e.drawOrder.length),h=i.slots.length,n=0;for(let l=0;l<e.drawOrder.length;l++,n++){let c=e.drawOrder[l],u=null,f=M(c,"offsets",null);if(f){u=O.newArray(h,-1);let m=O.newArray(h-f.length,0),g=0,p=0;for(let b=0;b<f.length;b++){let y=f[b],w=i.findSlot(y.slot);if(!w)throw new Error("Slot not found: "+w);let x=w.index;for(;g!=x;)m[p++]=g++;u[g+y.offset]=g++}for(;g<h;)m[p++]=g++;for(let b=h-1;b>=0;b--)u[b]==-1&&(u[b]=m[--p])}a.setFrame(n,M(c,"time",0),u)}r.push(a)}if(e.events){let a=new It(e.events.length),h=0;for(let n=0;n<e.events.length;n++,h++){let l=e.events[n],c=i.findEvent(l.name);if(!c)throw new Error("Event not found: "+l.name);let u=new pi(O.toSinglePrecision(M(l,"time",0)),c);u.intValue=M(l,"int",c.intValue),u.floatValue=M(l,"float",c.floatValue),u.stringValue=M(l,"string",c.stringValue),u.data.audioPath&&(u.volume=M(l,"volume",1),u.balance=M(l,"balance",0)),a.setFrame(h,u)}r.push(a)}let o=0;for(let a=0,h=r.length;a<h;a++)o=Math.max(o,r[a].getDuration());i.animations.push(new fs(t,r,o))}}class Ir{constructor(e,t,i,s,r){d(this,"parent");d(this,"skin");d(this,"slotIndex");d(this,"mesh");d(this,"inheritTimeline");this.mesh=e,this.skin=t,this.slotIndex=i,this.parent=s,this.inheritTimeline=r}}function Ve(C,e,t,i){let s=C[0],r=M(s,"time",0),o=M(s,"value",t)*i,a=0;for(let h=0;;h++){e.setFrame(h,r,o);let n=C[h+1];if(!n)return e.shrink(a),e;let l=M(n,"time",0),c=M(n,"value",t)*i;s.curve&&(a=ue(s.curve,e,a,h,0,r,l,o,c,i)),r=l,o=c,s=n}}function ts(C,e,t,i,s,r){let o=C[0],a=M(o,"time",0),h=M(o,t,s)*r,n=M(o,i,s)*r,l=0;for(let c=0;;c++){e.setFrame(c,a,h,n);let u=C[c+1];if(!u)return e.shrink(l),e;let f=M(u,"time",0),m=M(u,t,s)*r,g=M(u,i,s)*r,p=o.curve;p&&(l=ue(p,e,l,c,0,a,f,h,m,r),l=ue(p,e,l,c,1,a,f,n,g,r)),a=f,h=m,n=g,o=u}}function ue(C,e,t,i,s,r,o,a,h,n){if(C=="stepped")return e.setStepped(i),t;let l=s<<2,c=C[l],u=C[l+1]*n,f=C[l+2],m=C[l+3]*n;return e.setBezier(t,i,s,r,a,c,u,f,m,o,h),t+1}function M(C,e,t){return C[e]!==void 0?C[e]:t}typeof Math.fround>"u"&&(Math.fround=function(C){return function(e){return C[0]=e,C[0]}}(new Float32Array(1)));class Me{constructor(e,t={alpha:"true"}){d(this,"canvas");d(this,"gl");d(this,"restorables",new Array);if(e instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext)this.gl=e,this.canvas=this.gl.canvas;else{let i=e;this.gl=i.getContext("webgl2",t)||i.getContext("webgl",t),this.canvas=i,i.addEventListener("webglcontextlost",s=>{s&&s.preventDefault()}),i.addEventListener("webglcontextrestored",s=>{for(let r=0,o=this.restorables.length;r<o;r++)this.restorables[r].restore()})}}addRestorable(e){this.restorables.push(e)}removeRestorable(e){let t=this.restorables.indexOf(e);t>-1&&this.restorables.splice(t,1)}}const Et=class Et extends Li{constructor(t,i,s=!1){super(i);d(this,"context");d(this,"texture",null);d(this,"boundUnit",0);d(this,"useMipMaps",!1);this.context=t instanceof Me?t:new Me(t),this.useMipMaps=s,this.restore(),this.context.addRestorable(this)}setFilters(t,i){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,Et.validateMagFilter(i)),this.useMipMaps=Et.usesMipMaps(t),this.useMipMaps&&s.generateMipmap(s.TEXTURE_2D)}static validateMagFilter(t){switch(t){case be.MipMapLinearLinear:case be.MipMapLinearNearest:case be.MipMapNearestLinear:case be.MipMapNearestNearest:return be.Linear;default:return t}}static usesMipMaps(t){switch(t){case be.MipMapLinearLinear:case be.MipMapLinearNearest:case be.MipMapNearestLinear:case be.MipMapNearestNearest:return!0;default:return!1}}setWraps(t,i){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,i)}update(t){let i=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._image),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),t&&i.generateMipmap(i.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(t=0){let i=this.context.gl;this.boundUnit=t,i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,this.texture)}unbind(){let t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}};d(Et,"DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL",!1);let Tt=Et;class kr extends Ni{constructor(e,t="",i=new gi){super(s=>new Tt(e,s),t,i)}}class et{constructor(e=0,t=0,i=0){d(this,"x",0);d(this,"y",0);d(this,"z",0);this.x=e,this.y=t,this.z=i}setFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}scale(e){return this.x*=e,this.y*=e,this.z*=e,this}normalize(){let e=this.length();return e==0?this:(e=1/e,this.x*=e,this.y*=e,this.z*=e,this)}cross(e){return this.set(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}multiply(e){let t=e.values;return this.set(this.x*t[U]+this.y*t[j]+this.z*t[Z]+t[z],this.x*t[J]+this.y*t[W]+this.z*t[K]+t[q],this.x*t[Q]+this.y*t[_]+this.z*t[G]+t[H])}project(e){let t=e.values,i=1/(this.x*t[te]+this.y*t[se]+this.z*t[ie]+t[$]);return this.set((this.x*t[U]+this.y*t[j]+this.z*t[Z]+t[z])*i,(this.x*t[J]+this.y*t[W]+this.z*t[K]+t[q])*i,(this.x*t[Q]+this.y*t[_]+this.z*t[G]+t[H])*i)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(e){let t=e.x-this.x,i=e.y-this.y,s=e.z-this.z;return Math.sqrt(t*t+i*i+s*s)}}const U=0,j=4,Z=8,z=12,J=1,W=5,K=9,q=13,Q=2,_=6,G=10,H=14,te=3,se=7,ie=11,$=15,ke=class ke{constructor(){d(this,"temp",new Float32Array(16));d(this,"values",new Float32Array(16));let e=this.values;e[U]=1,e[W]=1,e[G]=1,e[$]=1}set(e){return this.values.set(e),this}transpose(){let e=this.temp,t=this.values;return e[U]=t[U],e[j]=t[J],e[Z]=t[Q],e[z]=t[te],e[J]=t[j],e[W]=t[W],e[K]=t[_],e[q]=t[se],e[Q]=t[Z],e[_]=t[K],e[G]=t[G],e[H]=t[ie],e[te]=t[z],e[se]=t[q],e[ie]=t[H],e[$]=t[$],this.set(e)}identity(){let e=this.values;return e[U]=1,e[j]=0,e[Z]=0,e[z]=0,e[J]=0,e[W]=1,e[K]=0,e[q]=0,e[Q]=0,e[_]=0,e[G]=1,e[H]=0,e[te]=0,e[se]=0,e[ie]=0,e[$]=1,this}invert(){let e=this.values,t=this.temp,i=e[te]*e[_]*e[K]*e[z]-e[Q]*e[se]*e[K]*e[z]-e[te]*e[W]*e[G]*e[z]+e[J]*e[se]*e[G]*e[z]+e[Q]*e[W]*e[ie]*e[z]-e[J]*e[_]*e[ie]*e[z]-e[te]*e[_]*e[Z]*e[q]+e[Q]*e[se]*e[Z]*e[q]+e[te]*e[j]*e[G]*e[q]-e[U]*e[se]*e[G]*e[q]-e[Q]*e[j]*e[ie]*e[q]+e[U]*e[_]*e[ie]*e[q]+e[te]*e[W]*e[Z]*e[H]-e[J]*e[se]*e[Z]*e[H]-e[te]*e[j]*e[K]*e[H]+e[U]*e[se]*e[K]*e[H]+e[J]*e[j]*e[ie]*e[H]-e[U]*e[W]*e[ie]*e[H]-e[Q]*e[W]*e[Z]*e[$]+e[J]*e[_]*e[Z]*e[$]+e[Q]*e[j]*e[K]*e[$]-e[U]*e[_]*e[K]*e[$]-e[J]*e[j]*e[G]*e[$]+e[U]*e[W]*e[G]*e[$];if(i==0)throw new Error("non-invertible matrix");let s=1/i;return t[U]=e[K]*e[H]*e[se]-e[q]*e[G]*e[se]+e[q]*e[_]*e[ie]-e[W]*e[H]*e[ie]-e[K]*e[_]*e[$]+e[W]*e[G]*e[$],t[j]=e[z]*e[G]*e[se]-e[Z]*e[H]*e[se]-e[z]*e[_]*e[ie]+e[j]*e[H]*e[ie]+e[Z]*e[_]*e[$]-e[j]*e[G]*e[$],t[Z]=e[Z]*e[q]*e[se]-e[z]*e[K]*e[se]+e[z]*e[W]*e[ie]-e[j]*e[q]*e[ie]-e[Z]*e[W]*e[$]+e[j]*e[K]*e[$],t[z]=e[z]*e[K]*e[_]-e[Z]*e[q]*e[_]-e[z]*e[W]*e[G]+e[j]*e[q]*e[G]+e[Z]*e[W]*e[H]-e[j]*e[K]*e[H],t[J]=e[q]*e[G]*e[te]-e[K]*e[H]*e[te]-e[q]*e[Q]*e[ie]+e[J]*e[H]*e[ie]+e[K]*e[Q]*e[$]-e[J]*e[G]*e[$],t[W]=e[Z]*e[H]*e[te]-e[z]*e[G]*e[te]+e[z]*e[Q]*e[ie]-e[U]*e[H]*e[ie]-e[Z]*e[Q]*e[$]+e[U]*e[G]*e[$],t[K]=e[z]*e[K]*e[te]-e[Z]*e[q]*e[te]-e[z]*e[J]*e[ie]+e[U]*e[q]*e[ie]+e[Z]*e[J]*e[$]-e[U]*e[K]*e[$],t[q]=e[Z]*e[q]*e[Q]-e[z]*e[K]*e[Q]+e[z]*e[J]*e[G]-e[U]*e[q]*e[G]-e[Z]*e[J]*e[H]+e[U]*e[K]*e[H],t[Q]=e[W]*e[H]*e[te]-e[q]*e[_]*e[te]+e[q]*e[Q]*e[se]-e[J]*e[H]*e[se]-e[W]*e[Q]*e[$]+e[J]*e[_]*e[$],t[_]=e[z]*e[_]*e[te]-e[j]*e[H]*e[te]-e[z]*e[Q]*e[se]+e[U]*e[H]*e[se]+e[j]*e[Q]*e[$]-e[U]*e[_]*e[$],t[G]=e[j]*e[q]*e[te]-e[z]*e[W]*e[te]+e[z]*e[J]*e[se]-e[U]*e[q]*e[se]-e[j]*e[J]*e[$]+e[U]*e[W]*e[$],t[H]=e[z]*e[W]*e[Q]-e[j]*e[q]*e[Q]-e[z]*e[J]*e[_]+e[U]*e[q]*e[_]+e[j]*e[J]*e[H]-e[U]*e[W]*e[H],t[te]=e[K]*e[_]*e[te]-e[W]*e[G]*e[te]-e[K]*e[Q]*e[se]+e[J]*e[G]*e[se]+e[W]*e[Q]*e[ie]-e[J]*e[_]*e[ie],t[se]=e[j]*e[G]*e[te]-e[Z]*e[_]*e[te]+e[Z]*e[Q]*e[se]-e[U]*e[G]*e[se]-e[j]*e[Q]*e[ie]+e[U]*e[_]*e[ie],t[ie]=e[Z]*e[W]*e[te]-e[j]*e[K]*e[te]-e[Z]*e[J]*e[se]+e[U]*e[K]*e[se]+e[j]*e[J]*e[ie]-e[U]*e[W]*e[ie],t[$]=e[j]*e[K]*e[Q]-e[Z]*e[W]*e[Q]+e[Z]*e[J]*e[_]-e[U]*e[K]*e[_]-e[j]*e[J]*e[G]+e[U]*e[W]*e[G],e[U]=t[U]*s,e[j]=t[j]*s,e[Z]=t[Z]*s,e[z]=t[z]*s,e[J]=t[J]*s,e[W]=t[W]*s,e[K]=t[K]*s,e[q]=t[q]*s,e[Q]=t[Q]*s,e[_]=t[_]*s,e[G]=t[G]*s,e[H]=t[H]*s,e[te]=t[te]*s,e[se]=t[se]*s,e[ie]=t[ie]*s,e[$]=t[$]*s,this}determinant(){let e=this.values;return e[te]*e[_]*e[K]*e[z]-e[Q]*e[se]*e[K]*e[z]-e[te]*e[W]*e[G]*e[z]+e[J]*e[se]*e[G]*e[z]+e[Q]*e[W]*e[ie]*e[z]-e[J]*e[_]*e[ie]*e[z]-e[te]*e[_]*e[Z]*e[q]+e[Q]*e[se]*e[Z]*e[q]+e[te]*e[j]*e[G]*e[q]-e[U]*e[se]*e[G]*e[q]-e[Q]*e[j]*e[ie]*e[q]+e[U]*e[_]*e[ie]*e[q]+e[te]*e[W]*e[Z]*e[H]-e[J]*e[se]*e[Z]*e[H]-e[te]*e[j]*e[K]*e[H]+e[U]*e[se]*e[K]*e[H]+e[J]*e[j]*e[ie]*e[H]-e[U]*e[W]*e[ie]*e[H]-e[Q]*e[W]*e[Z]*e[$]+e[J]*e[_]*e[Z]*e[$]+e[Q]*e[j]*e[K]*e[$]-e[U]*e[_]*e[K]*e[$]-e[J]*e[j]*e[G]*e[$]+e[U]*e[W]*e[G]*e[$]}translate(e,t,i){let s=this.values;return s[z]+=e,s[q]+=t,s[H]+=i,this}copy(){return new ke().set(this.values)}projection(e,t,i,s){this.identity();let r=1/Math.tan(i*(Math.PI/180)/2),o=(t+e)/(e-t),a=2*t*e/(e-t),h=this.values;return h[U]=r/s,h[J]=0,h[Q]=0,h[te]=0,h[j]=0,h[W]=r,h[_]=0,h[se]=0,h[Z]=0,h[K]=0,h[G]=o,h[ie]=-1,h[z]=0,h[q]=0,h[H]=a,h[$]=0,this}ortho2d(e,t,i,s){return this.ortho(e,e+i,t,t+s,0,1)}ortho(e,t,i,s,r,o){this.identity();let a=2/(t-e),h=2/(s-i),n=-2/(o-r),l=-(t+e)/(t-e),c=-(s+i)/(s-i),u=-(o+r)/(o-r),f=this.values;return f[U]=a,f[J]=0,f[Q]=0,f[te]=0,f[j]=0,f[W]=h,f[_]=0,f[se]=0,f[Z]=0,f[K]=0,f[G]=n,f[ie]=0,f[z]=l,f[q]=c,f[H]=u,f[$]=1,this}multiply(e){let t=this.temp,i=this.values,s=e.values;return t[U]=i[U]*s[U]+i[j]*s[J]+i[Z]*s[Q]+i[z]*s[te],t[j]=i[U]*s[j]+i[j]*s[W]+i[Z]*s[_]+i[z]*s[se],t[Z]=i[U]*s[Z]+i[j]*s[K]+i[Z]*s[G]+i[z]*s[ie],t[z]=i[U]*s[z]+i[j]*s[q]+i[Z]*s[H]+i[z]*s[$],t[J]=i[J]*s[U]+i[W]*s[J]+i[K]*s[Q]+i[q]*s[te],t[W]=i[J]*s[j]+i[W]*s[W]+i[K]*s[_]+i[q]*s[se],t[K]=i[J]*s[Z]+i[W]*s[K]+i[K]*s[G]+i[q]*s[ie],t[q]=i[J]*s[z]+i[W]*s[q]+i[K]*s[H]+i[q]*s[$],t[Q]=i[Q]*s[U]+i[_]*s[J]+i[G]*s[Q]+i[H]*s[te],t[_]=i[Q]*s[j]+i[_]*s[W]+i[G]*s[_]+i[H]*s[se],t[G]=i[Q]*s[Z]+i[_]*s[K]+i[G]*s[G]+i[H]*s[ie],t[H]=i[Q]*s[z]+i[_]*s[q]+i[G]*s[H]+i[H]*s[$],t[te]=i[te]*s[U]+i[se]*s[J]+i[ie]*s[Q]+i[$]*s[te],t[se]=i[te]*s[j]+i[se]*s[W]+i[ie]*s[_]+i[$]*s[se],t[ie]=i[te]*s[Z]+i[se]*s[K]+i[ie]*s[G]+i[$]*s[ie],t[$]=i[te]*s[z]+i[se]*s[q]+i[ie]*s[H]+i[$]*s[$],this.set(this.temp)}multiplyLeft(e){let t=this.temp,i=this.values,s=e.values;return t[U]=s[U]*i[U]+s[j]*i[J]+s[Z]*i[Q]+s[z]*i[te],t[j]=s[U]*i[j]+s[j]*i[W]+s[Z]*i[_]+s[z]*i[se],t[Z]=s[U]*i[Z]+s[j]*i[K]+s[Z]*i[G]+s[z]*i[ie],t[z]=s[U]*i[z]+s[j]*i[q]+s[Z]*i[H]+s[z]*i[$],t[J]=s[J]*i[U]+s[W]*i[J]+s[K]*i[Q]+s[q]*i[te],t[W]=s[J]*i[j]+s[W]*i[W]+s[K]*i[_]+s[q]*i[se],t[K]=s[J]*i[Z]+s[W]*i[K]+s[K]*i[G]+s[q]*i[ie],t[q]=s[J]*i[z]+s[W]*i[q]+s[K]*i[H]+s[q]*i[$],t[Q]=s[Q]*i[U]+s[_]*i[J]+s[G]*i[Q]+s[H]*i[te],t[_]=s[Q]*i[j]+s[_]*i[W]+s[G]*i[_]+s[H]*i[se],t[G]=s[Q]*i[Z]+s[_]*i[K]+s[G]*i[G]+s[H]*i[ie],t[H]=s[Q]*i[z]+s[_]*i[q]+s[G]*i[H]+s[H]*i[$],t[te]=s[te]*i[U]+s[se]*i[J]+s[ie]*i[Q]+s[$]*i[te],t[se]=s[te]*i[j]+s[se]*i[W]+s[ie]*i[_]+s[$]*i[se],t[ie]=s[te]*i[Z]+s[se]*i[K]+s[ie]*i[G]+s[$]*i[ie],t[$]=s[te]*i[z]+s[se]*i[q]+s[ie]*i[H]+s[$]*i[$],this.set(this.temp)}lookAt(e,t,i){let s=ke.xAxis,r=ke.yAxis,o=ke.zAxis;o.setFrom(t).normalize(),s.setFrom(t).normalize(),s.cross(i).normalize(),r.setFrom(s).cross(o).normalize(),this.identity();let a=this.values;return a[U]=s.x,a[j]=s.y,a[Z]=s.z,a[J]=r.x,a[W]=r.y,a[K]=r.z,a[Q]=-o.x,a[_]=-o.y,a[G]=-o.z,ke.tmpMatrix.identity(),ke.tmpMatrix.values[z]=-e.x,ke.tmpMatrix.values[q]=-e.y,ke.tmpMatrix.values[H]=-e.z,this.multiply(ke.tmpMatrix),this}};d(ke,"xAxis",new et),d(ke,"yAxis",new et),d(ke,"zAxis",new et),d(ke,"tmpMatrix",new ke);let ct=ke;class Tr{constructor(e,t){d(this,"position",new et(0,0,0));d(this,"direction",new et(0,0,-1));d(this,"up",new et(0,1,0));d(this,"near",0);d(this,"far",100);d(this,"zoom",1);d(this,"viewportWidth",0);d(this,"viewportHeight",0);d(this,"projectionView",new ct);d(this,"inverseProjectionView",new ct);d(this,"projection",new ct);d(this,"view",new ct);this.viewportWidth=e,this.viewportHeight=t,this.update()}update(){let e=this.projection,t=this.view,i=this.projectionView,s=this.inverseProjectionView,r=this.zoom,o=this.viewportWidth,a=this.viewportHeight;e.ortho(r*(-o/2),r*(o/2),r*(-a/2),r*(a/2),this.near,this.far),t.lookAt(this.position,this.direction,this.up),i.set(e.values),i.multiply(t),s.set(i.values).invert()}screenToWorld(e,t,i){let s=e.x,r=i-e.y-1;return e.x=2*s/t-1,e.y=2*r/i-1,e.z=2*e.z-1,e.project(this.inverseProjectionView),e}worldToScreen(e,t,i){return e.project(this.projectionView),e.x=t*(e.x+1)/2,e.y=i*(e.y+1)/2,e.z=(e.z+1)/2,e}setViewport(e,t){this.viewportWidth=e,this.viewportHeight=t}}class Si{constructor(e){d(this,"element");d(this,"mouseX",0);d(this,"mouseY",0);d(this,"buttonDown",!1);d(this,"touch0",null);d(this,"touch1",null);d(this,"initialPinchDistance",0);d(this,"listeners",new Array);d(this,"eventListeners",[]);this.element=e,this.setupCallbacks(e)}setupCallbacks(e){let t=a=>{if(a instanceof MouseEvent){let h=e.getBoundingClientRect();this.mouseX=a.clientX-h.left,this.mouseY=a.clientY-h.top,this.buttonDown=!0,this.listeners.map(n=>{n.down&&n.down(this.mouseX,this.mouseY)}),document.addEventListener("mousemove",i),document.addEventListener("mouseup",s)}},i=a=>{if(a instanceof MouseEvent){let h=e.getBoundingClientRect();this.mouseX=a.clientX-h.left,this.mouseY=a.clientY-h.top,this.listeners.map(n=>{this.buttonDown?n.dragged&&n.dragged(this.mouseX,this.mouseY):n.moved&&n.moved(this.mouseX,this.mouseY)})}},s=a=>{if(a instanceof MouseEvent){let h=e.getBoundingClientRect();this.mouseX=a.clientX-h.left,this.mouseY=a.clientY-h.top,this.buttonDown=!1,this.listeners.map(n=>{n.up&&n.up(this.mouseX,this.mouseY)}),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)}},r=a=>{a.preventDefault(),a.deltaY,a.deltaMode==WheelEvent.DOM_DELTA_LINE,a.deltaMode==WheelEvent.DOM_DELTA_PAGE,this.listeners.map(h=>{h.wheel&&h.wheel(a.deltaY)})};e.addEventListener("mousedown",t,!0),e.addEventListener("mousemove",i,!0),e.addEventListener("mouseup",s,!0),e.addEventListener("wheel",r,!0),e.addEventListener("touchstart",a=>{if(!this.touch0||!this.touch1){var h=a.changedTouches;let n=h.item(0);if(!n)return;let l=e.getBoundingClientRect(),c=n.clientX-l.left,u=n.clientY-l.top,f=new Mr(n.identifier,c,u);if(this.mouseX=c,this.mouseY=u,this.buttonDown=!0,!this.touch0)this.touch0=f,this.listeners.map(m=>{m.down&&m.down(f.x,f.y)});else if(!this.touch1){this.touch1=f;let m=this.touch1.x-this.touch0.x,g=this.touch1.x-this.touch0.x;this.initialPinchDistance=Math.sqrt(m*m+g*g),this.listeners.map(p=>{p.zoom&&p.zoom(this.initialPinchDistance,this.initialPinchDistance)})}}a.preventDefault()},!1),e.addEventListener("touchmove",a=>{if(this.touch0){var h=a.changedTouches;let c=e.getBoundingClientRect();for(var n=0;n<h.length;n++){var l=h[n];let u=l.clientX-c.left,f=l.clientY-c.top;this.touch0.identifier===l.identifier&&(this.touch0.x=this.mouseX=u,this.touch0.y=this.mouseY=f,this.listeners.map(m=>{m.dragged&&m.dragged(u,f)})),this.touch1&&this.touch1.identifier===l.identifier&&(this.touch1.x=this.mouseX=u,this.touch1.y=this.mouseY=f)}if(this.touch0&&this.touch1){let u=this.touch1.x-this.touch0.x,f=this.touch1.x-this.touch0.x,m=Math.sqrt(u*u+f*f);this.listeners.map(g=>{g.zoom&&g.zoom(this.initialPinchDistance,m)})}}a.preventDefault()},!1);let o=a=>{if(this.touch0){var h=a.changedTouches;let c=e.getBoundingClientRect();for(var n=0;n<h.length;n++){var l=h[n];let u=l.clientX-c.left,f=l.clientY-c.top;if(this.touch0.identifier===l.identifier)if(this.touch0=null,this.mouseX=u,this.mouseY=f,this.listeners.map(m=>{m.up&&m.up(u,f)}),this.touch1)this.touch0=this.touch1,this.touch1=null,this.mouseX=this.touch0.x,this.mouseX=this.touch0.x,this.buttonDown=!0,this.listeners.map(m=>{m.down&&m.down(this.touch0.x,this.touch0.y)});else{this.buttonDown=!1;break}this.touch1&&this.touch1.identifier&&(this.touch1=null)}}a.preventDefault()};e.addEventListener("touchend",o,!1),e.addEventListener("touchcancel",o)}addListener(e){this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}class Mr{constructor(e,t,i){d(this,"identifier");d(this,"x");d(this,"y");this.identifier=e,this.x=t,this.y=i}}const fe=class fe{constructor(e,t,i){d(this,"vertexShader");d(this,"fragmentShader");d(this,"context");d(this,"vs",null);d(this,"vsSource");d(this,"fs",null);d(this,"fsSource");d(this,"program",null);d(this,"tmp2x2",new Float32Array(2*2));d(this,"tmp3x3",new Float32Array(3*3));d(this,"tmp4x4",new Float32Array(4*4));this.vertexShader=t,this.fragmentShader=i,this.vsSource=t,this.fsSource=i,this.context=e instanceof Me?e:new Me(e),this.context.addRestorable(this),this.compile()}getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}compile(){let e=this.context.gl;try{if(this.vs=this.compileShader(e.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(e.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}}compileShader(e,t){let i=this.context.gl,s=i.createShader(e);if(!s)throw new Error("Couldn't create shader.");if(i.shaderSource(s,t),i.compileShader(s),!i.getShaderParameter(s,i.COMPILE_STATUS)){let r="Couldn't compile shader: "+i.getShaderInfoLog(s);if(i.deleteShader(s),!i.isContextLost())throw new Error(r)}return s}compileProgram(e,t){let i=this.context.gl,s=i.createProgram();if(!s)throw new Error("Couldn't compile program.");if(i.attachShader(s,e),i.attachShader(s,t),i.linkProgram(s),!i.getProgramParameter(s,i.LINK_STATUS)){let r="Couldn't compile shader program: "+i.getProgramInfoLog(s);if(i.deleteProgram(s),!i.isContextLost())throw new Error(r)}return s}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(e,t){this.context.gl.uniform1i(this.getUniformLocation(e),t)}setUniformf(e,t){this.context.gl.uniform1f(this.getUniformLocation(e),t)}setUniform2f(e,t,i){this.context.gl.uniform2f(this.getUniformLocation(e),t,i)}setUniform3f(e,t,i,s){this.context.gl.uniform3f(this.getUniformLocation(e),t,i,s)}setUniform4f(e,t,i,s,r){this.context.gl.uniform4f(this.getUniformLocation(e),t,i,s,r)}setUniform2x2f(e,t){let i=this.context.gl;this.tmp2x2.set(t),i.uniformMatrix2fv(this.getUniformLocation(e),!1,this.tmp2x2)}setUniform3x3f(e,t){let i=this.context.gl;this.tmp3x3.set(t),i.uniformMatrix3fv(this.getUniformLocation(e),!1,this.tmp3x3)}setUniform4x4f(e,t){let i=this.context.gl;this.tmp4x4.set(t),i.uniformMatrix4fv(this.getUniformLocation(e),!1,this.tmp4x4)}getUniformLocation(e){let t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let i=t.getUniformLocation(this.program,e);if(!i&&!t.isContextLost())throw new Error(`Couldn't find location for uniform ${e}`);return i}getAttributeLocation(e){let t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let i=t.getAttribLocation(this.program,e);if(i==-1&&!t.isContextLost())throw new Error(`Couldn't find location for attribute ${e}`);return i}dispose(){this.context.removeRestorable(this);let e=this.context.gl;this.vs&&(e.deleteShader(this.vs),this.vs=null),this.fs&&(e.deleteShader(this.fs),this.fs=null),this.program&&(e.deleteProgram(this.program),this.program=null)}static newColoredTextured(e){let t=`
attribute vec4 ${fe.POSITION};
attribute vec4 ${fe.COLOR};
attribute vec2 ${fe.TEXCOORDS};
uniform mat4 ${fe.MVP_MATRIX};
varying vec4 v_color;
varying vec2 v_texCoords;

void main () {
	v_color = ${fe.COLOR};
	v_texCoords = ${fe.TEXCOORDS};
	gl_Position = ${fe.MVP_MATRIX} * ${fe.POSITION};
}
`,i=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_color;
varying vec2 v_texCoords;
uniform sampler2D u_texture;

void main () {
	gl_FragColor = v_color * texture2D(u_texture, v_texCoords);
}
`;return new fe(e,t,i)}static newTwoColoredTextured(e){let t=`
attribute vec4 ${fe.POSITION};
attribute vec4 ${fe.COLOR};
attribute vec4 ${fe.COLOR2};
attribute vec2 ${fe.TEXCOORDS};
uniform mat4 ${fe.MVP_MATRIX};
varying vec4 v_light;
varying vec4 v_dark;
varying vec2 v_texCoords;

void main () {
	v_light = ${fe.COLOR};
	v_dark = ${fe.COLOR2};
	v_texCoords = ${fe.TEXCOORDS};
	gl_Position = ${fe.MVP_MATRIX} * ${fe.POSITION};
}
`,i=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_light;
varying LOWP vec4 v_dark;
varying vec2 v_texCoords;
uniform sampler2D u_texture;

void main () {
	vec4 texColor = texture2D(u_texture, v_texCoords);
	gl_FragColor.a = texColor.a * v_light.a;
	gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;
}
`;return new fe(e,t,i)}static newColored(e){let t=`
attribute vec4 ${fe.POSITION};
attribute vec4 ${fe.COLOR};
uniform mat4 ${fe.MVP_MATRIX};
varying vec4 v_color;

void main () {
	v_color = ${fe.COLOR};
	gl_Position = ${fe.MVP_MATRIX} * ${fe.POSITION};
}
`,i=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_color;

void main () {
	gl_FragColor = v_color;
}
`;return new fe(e,t,i)}};d(fe,"MVP_MATRIX","u_projTrans"),d(fe,"POSITION","a_position"),d(fe,"COLOR","a_color"),d(fe,"COLOR2","a_color2"),d(fe,"TEXCOORDS","a_texCoords"),d(fe,"SAMPLER","u_texture");let Ne=fe;class Ei{constructor(e,t,i,s){d(this,"attributes");d(this,"context");d(this,"vertices");d(this,"verticesBuffer",null);d(this,"verticesLength",0);d(this,"dirtyVertices",!1);d(this,"indices");d(this,"indicesBuffer",null);d(this,"indicesLength",0);d(this,"dirtyIndices",!1);d(this,"elementsPerVertex",0);this.attributes=t,this.context=e instanceof Me?e:new Me(e),this.elementsPerVertex=0;for(let r=0;r<t.length;r++)this.elementsPerVertex+=t[r].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(s),this.context.addRestorable(this)}getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(e){this.dirtyVertices=!0,this.verticesLength=e}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(e){this.dirtyIndices=!0,this.indicesLength=e}getIndices(){return this.indices}getVertexSizeInFloats(){let e=0;for(var t=0;t<this.attributes.length;t++){let i=this.attributes[t];e+=i.numElements}return e}setVertices(e){if(this.dirtyVertices=!0,e.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(e,0),this.verticesLength=e.length}setIndices(e){if(this.dirtyIndices=!0,e.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(e,0),this.indicesLength=e.length}draw(e,t){this.drawWithOffset(e,t,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(e,t,i,s){let r=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(e),this.indicesLength>0?r.drawElements(t,s,r.UNSIGNED_SHORT,i*2):r.drawArrays(t,i,s),this.unbind(e)}bind(e){let t=this.context.gl;t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer);let i=0;for(let s=0;s<this.attributes.length;s++){let r=this.attributes[s],o=e.getAttributeLocation(r.name);t.enableVertexAttribArray(o),t.vertexAttribPointer(o,r.numElements,t.FLOAT,!1,this.elementsPerVertex*4,i*4),i+=r.numElements}this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(e){let t=this.context.gl;for(let i=0;i<this.attributes.length;i++){let s=this.attributes[i],r=e.getAttributeLocation(s.name);t.disableVertexAttribArray(r)}t.bindBuffer(t.ARRAY_BUFFER,null),this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}update(){let e=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),e.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),e.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let e=this.context.gl;e.deleteBuffer(this.verticesBuffer),e.deleteBuffer(this.indicesBuffer)}}class Jt{constructor(e,t,i){d(this,"name");d(this,"type");d(this,"numElements");this.name=e,this.type=t,this.numElements=i}}class os extends Jt{constructor(){super(Ne.POSITION,wt.Float,2)}}class Es extends Jt{constructor(e=0){super(Ne.TEXCOORDS+(e==0?"":e),wt.Float,2)}}class hs extends Jt{constructor(){super(Ne.COLOR,wt.Float,4)}}class Rr extends Jt{constructor(){super(Ne.COLOR2,wt.Float,4)}}var wt;(function(C){C[C.Float=0]="Float"})(wt||(wt={}));const je=1,Fr=769,Is=770,ks=771,Ts=774,Ke=class Ke{constructor(e,t=!0,i=10920){d(this,"context");d(this,"drawCalls",0);d(this,"isDrawing",!1);d(this,"mesh");d(this,"shader",null);d(this,"lastTexture",null);d(this,"verticesLength",0);d(this,"indicesLength",0);d(this,"srcColorBlend");d(this,"srcAlphaBlend");d(this,"dstBlend");d(this,"cullWasEnabled",!1);if(i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=e instanceof Me?e:new Me(e);let s=t?[new os,new hs,new Es,new Rr]:[new os,new hs,new Es];this.mesh=new Ei(e,s,i,i*3);let r=this.context.gl;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA}begin(e){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=e,this.lastTexture=null,this.isDrawing=!0;let t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(e,t){const i=Ke.blendModesGL[e],s=t?i.srcRgbPma:i.srcRgb,r=i.srcAlpha,o=i.dstRgb;if(this.srcColorBlend==s&&this.srcAlphaBlend==r&&this.dstBlend==o)return;this.srcColorBlend=s,this.srcAlphaBlend=r,this.dstBlend=o,this.isDrawing&&this.flush(),this.context.gl.blendFuncSeparate(s,o,r,o)}draw(e,t,i){e!=this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+t.length>this.mesh.getVertices().length||this.indicesLength+i.length>this.mesh.getIndices().length)&&this.flush();let s=this.mesh.numVertices();this.mesh.getVertices().set(t,this.verticesLength),this.verticesLength+=t.length,this.mesh.setVerticesLength(this.verticesLength);let r=this.mesh.getIndices();for(let o=this.indicesLength,a=0;a<i.length;o++,a++)r[o]=i[a]+s;this.indicesLength+=i.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){if(this.verticesLength!=0){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++,Ke.globalDrawCalls++}}end(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;let e=this.context.gl;e.disable(e.BLEND)}getDrawCalls(){return this.drawCalls}static getAndResetGlobalDrawCalls(){let e=Ke.globalDrawCalls;return Ke.globalDrawCalls=0,e}dispose(){this.mesh.dispose()}};d(Ke,"disableCulling",!1),d(Ke,"globalDrawCalls",0),d(Ke,"blendModesGL",[{srcRgb:Is,srcRgbPma:je,dstRgb:ks,srcAlpha:je},{srcRgb:Is,srcRgbPma:je,dstRgb:je,srcAlpha:je},{srcRgb:Ts,srcRgbPma:Ts,dstRgb:ks,srcAlpha:je},{srcRgb:je,srcRgbPma:je,dstRgb:Fr,srcAlpha:je}]);let Ut=Ke;class Ms{constructor(e,t=10920){d(this,"context");d(this,"isDrawing",!1);d(this,"mesh");d(this,"shapeType",Te.Filled);d(this,"color",new N(1,1,1,1));d(this,"shader",null);d(this,"vertexIndex",0);d(this,"tmp",new qe);d(this,"srcColorBlend");d(this,"srcAlphaBlend");d(this,"dstBlend");if(t>10920)throw new Error("Can't have more than 10920 triangles per batch: "+t);this.context=e instanceof Me?e:new Me(e),this.mesh=new Ei(e,[new os,new hs],t,0);let i=this.context.gl;this.srcColorBlend=i.SRC_ALPHA,this.srcAlphaBlend=i.ONE,this.dstBlend=i.ONE_MINUS_SRC_ALPHA}begin(e){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=e,this.vertexIndex=0,this.isDrawing=!0;let t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(e,t,i){this.srcColorBlend=e,this.srcAlphaBlend=t,this.dstBlend=i,this.isDrawing&&(this.flush(),this.context.gl.blendFuncSeparate(e,i,t,i))}setColor(e){this.color.setFromColor(e)}setColorWith(e,t,i,s){this.color.set(e,t,i,s)}point(e,t,i){this.check(Te.Point,1),i||(i=this.color),this.vertex(e,t,i)}line(e,t,i,s,r){this.check(Te.Line,2),this.mesh.getVertices(),this.vertexIndex,r||(r=this.color),this.vertex(e,t,r),this.vertex(i,s,r)}triangle(e,t,i,s,r,o,a,h,n,l){this.check(e?Te.Filled:Te.Line,3),this.mesh.getVertices(),this.vertexIndex,h||(h=this.color),n||(n=this.color),l||(l=this.color),e?(this.vertex(t,i,h),this.vertex(s,r,n),this.vertex(o,a,l)):(this.vertex(t,i,h),this.vertex(s,r,n),this.vertex(s,r,h),this.vertex(o,a,n),this.vertex(o,a,h),this.vertex(t,i,n))}quad(e,t,i,s,r,o,a,h,n,l,c,u,f){this.check(e?Te.Filled:Te.Line,3),this.mesh.getVertices(),this.vertexIndex,l||(l=this.color),c||(c=this.color),u||(u=this.color),f||(f=this.color),e?(this.vertex(t,i,l),this.vertex(s,r,c),this.vertex(o,a,u),this.vertex(o,a,u),this.vertex(h,n,f),this.vertex(t,i,l)):(this.vertex(t,i,l),this.vertex(s,r,c),this.vertex(s,r,c),this.vertex(o,a,u),this.vertex(o,a,u),this.vertex(h,n,f),this.vertex(h,n,f),this.vertex(t,i,l))}rect(e,t,i,s,r,o){this.quad(e,t,i,t+s,i,t+s,i+r,t,i+r,o,o,o,o)}rectLine(e,t,i,s,r,o,a){this.check(e?Te.Filled:Te.Line,8),a||(a=this.color);let h=this.tmp.set(r-i,t-s);h.normalize(),o*=.5;let n=h.x*o,l=h.y*o;e?(this.vertex(t+n,i+l,a),this.vertex(t-n,i-l,a),this.vertex(s+n,r+l,a),this.vertex(s-n,r-l,a),this.vertex(s+n,r+l,a),this.vertex(t-n,i-l,a)):(this.vertex(t+n,i+l,a),this.vertex(t-n,i-l,a),this.vertex(s+n,r+l,a),this.vertex(s-n,r-l,a),this.vertex(s+n,r+l,a),this.vertex(t+n,i+l,a),this.vertex(s-n,r-l,a),this.vertex(t-n,i-l,a))}x(e,t,i){this.line(e-i,t-i,e+i,t+i),this.line(e-i,t+i,e+i,t-i)}polygon(e,t,i,s){if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(Te.Line,i*2),s||(s=this.color),this.mesh.getVertices(),this.vertexIndex,t<<=1,i<<=1;let r=e[t],o=e[t+1],a=t+i;for(let h=t,n=t+i-2;h<n;h+=2){let l=e[h],c=e[h+1],u=0,f=0;h+2>=a?(u=r,f=o):(u=e[h+2],f=e[h+3]),this.vertex(l,c,s),this.vertex(u,f,s)}}circle(e,t,i,s,r,o=0){if(o==0&&(o=Math.max(1,6*V.cbrt(s)|0)),o<=0)throw new Error("segments must be > 0.");r||(r=this.color);let a=2*V.PI/o,h=Math.cos(a),n=Math.sin(a),l=s,c=0;if(e){this.check(Te.Filled,o*3+3),o--;for(let u=0;u<o;u++){this.vertex(t,i,r),this.vertex(t+l,i+c,r);let f=l;l=h*l-n*c,c=n*f+h*c,this.vertex(t+l,i+c,r)}this.vertex(t,i,r),this.vertex(t+l,i+c,r)}else{this.check(Te.Line,o*2+2);for(let u=0;u<o;u++){this.vertex(t+l,i+c,r);let f=l;l=h*l-n*c,c=n*f+h*c,this.vertex(t+l,i+c,r)}this.vertex(t+l,i+c,r)}l=s,c=0,this.vertex(t+l,i+c,r)}curve(e,t,i,s,r,o,a,h,n,l){this.check(Te.Line,n*2+2),l||(l=this.color);let c=1/n,u=c*c,f=c*c*c,m=3*c,g=3*u,p=6*u,b=6*f,y=e-i*2+r,w=t-s*2+o,x=(i-r)*3-e+a,A=(s-o)*3-t+h,v=e,S=t,E=(i-e)*m+y*g+x*f,I=(s-t)*m+w*g+A*f,R=y*p+x*b,F=w*p+A*b,L=x*b,B=A*b;for(;n-- >0;)this.vertex(v,S,l),v+=E,S+=I,E+=R,I+=F,R+=L,F+=B,this.vertex(v,S,l);this.vertex(v,S,l),this.vertex(a,h,l)}vertex(e,t,i){let s=this.vertexIndex,r=this.mesh.getVertices();r[s++]=e,r[s++]=t,r[s++]=i.r,r[s++]=i.g,r[s++]=i.b,r[s++]=i.a,this.vertexIndex=s}end(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();let e=this.context.gl;e.disable(e.BLEND),this.isDrawing=!1}flush(){if(this.vertexIndex!=0){if(!this.shader)throw new Error("No shader set.");this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0}}check(e,t){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==e)if(this.mesh.maxVertices()-this.mesh.numVertices()<t)this.flush();else return;else this.flush(),this.shapeType=e}dispose(){this.mesh.dispose()}}var Te;(function(C){C[C.Point=0]="Point",C[C.Line=1]="Line",C[C.Filled=4]="Filled"})(Te||(Te={}));const gt=class gt{constructor(e){d(this,"boneLineColor",new N(1,0,0,1));d(this,"boneOriginColor",new N(0,1,0,1));d(this,"attachmentLineColor",new N(0,0,1,.5));d(this,"triangleLineColor",new N(1,.64,0,.5));d(this,"pathColor",new N().setFromString("FF7F00"));d(this,"clipColor",new N(.8,0,0,2));d(this,"aabbColor",new N(0,1,0,.5));d(this,"drawBones",!0);d(this,"drawRegionAttachments",!0);d(this,"drawBoundingBoxes",!0);d(this,"drawMeshHull",!0);d(this,"drawMeshTriangles",!0);d(this,"drawPaths",!0);d(this,"drawSkeletonXY",!1);d(this,"drawClipping",!0);d(this,"premultipliedAlpha",!1);d(this,"scale",1);d(this,"boneWidth",2);d(this,"context");d(this,"bounds",new Sr);d(this,"temp",new Array);d(this,"vertices",O.newFloatArray(2*1024));this.context=e instanceof Me?e:new Me(e)}draw(e,t,i){let s=t.x,r=t.y,o=this.context.gl,a=this.premultipliedAlpha?o.ONE:o.SRC_ALPHA;e.setBlendMode(a,o.ONE,o.ONE_MINUS_SRC_ALPHA);let h=t.bones;if(this.drawBones){e.setColor(this.boneLineColor);for(let n=0,l=h.length;n<l;n++){let c=h[n];if(i&&i.indexOf(c.data.name)>-1||!c.parent)continue;let u=c.data.length*c.a+c.worldX,f=c.data.length*c.c+c.worldY;e.rectLine(!0,c.worldX,c.worldY,u,f,this.boneWidth*this.scale)}this.drawSkeletonXY&&e.x(s,r,4*this.scale)}if(this.drawRegionAttachments){e.setColor(this.attachmentLineColor);let n=t.slots;for(let l=0,c=n.length;l<c;l++){let u=n[l],f=u.getAttachment();if(f instanceof xt){let m=f,g=this.vertices;m.computeWorldVertices(u,g,0,2),e.line(g[0],g[1],g[2],g[3]),e.line(g[2],g[3],g[4],g[5]),e.line(g[4],g[5],g[6],g[7]),e.line(g[6],g[7],g[0],g[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let n=t.slots;for(let l=0,c=n.length;l<c;l++){let u=n[l];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof tt))continue;let m=f,g=this.vertices;m.computeWorldVertices(u,0,m.worldVerticesLength,g,0,2);let p=m.triangles,b=m.hullLength;if(this.drawMeshTriangles){e.setColor(this.triangleLineColor);for(let y=0,w=p.length;y<w;y+=3){let x=p[y]*2,A=p[y+1]*2,v=p[y+2]*2;e.triangle(!1,g[x],g[x+1],g[A],g[A+1],g[v],g[v+1])}}if(this.drawMeshHull&&b>0){e.setColor(this.attachmentLineColor),b=(b>>1)*2;let y=g[b-2],w=g[b-1];for(let x=0,A=b;x<A;x+=2){let v=g[x],S=g[x+1];e.line(v,S,y,w),y=v,w=S}}}}if(this.drawBoundingBoxes){let n=this.bounds;n.update(t,!0),e.setColor(this.aabbColor),e.rect(!1,n.minX,n.minY,n.getWidth(),n.getHeight());let l=n.polygons,c=n.boundingBoxes;for(let u=0,f=l.length;u<f;u++){let m=l[u];e.setColor(c[u].color),e.polygon(m,0,m.length)}}if(this.drawPaths){let n=t.slots;for(let l=0,c=n.length;l<c;l++){let u=n[l];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof nt))continue;let m=f,g=m.worldVerticesLength,p=this.temp=O.setArraySize(this.temp,g,0);m.computeWorldVertices(u,0,g,p,0,2);let b=this.pathColor,y=p[2],w=p[3],x=0,A=0;if(m.closed){e.setColor(b);let v=p[0],S=p[1],E=p[g-2],I=p[g-1];x=p[g-4],A=p[g-3],e.curve(y,w,v,S,E,I,x,A,32),e.setColor(gt.LIGHT_GRAY),e.line(y,w,v,S),e.line(x,A,E,I)}g-=4;for(let v=4;v<g;v+=6){let S=p[v],E=p[v+1],I=p[v+2],R=p[v+3];x=p[v+4],A=p[v+5],e.setColor(b),e.curve(y,w,S,E,I,R,x,A,32),e.setColor(gt.LIGHT_GRAY),e.line(y,w,S,E),e.line(x,A,I,R),y=x,w=A}}}if(this.drawBones){e.setColor(this.boneOriginColor);for(let n=0,l=h.length;n<l;n++){let c=h[n];i&&i.indexOf(c.data.name)>-1||e.circle(!0,c.worldX,c.worldY,3*this.scale,this.boneOriginColor,8)}}if(this.drawClipping){let n=t.slots;e.setColor(this.clipColor);for(let l=0,c=n.length;l<c;l++){let u=n[l];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof vt))continue;let m=f,g=m.worldVerticesLength,p=this.temp=O.setArraySize(this.temp,g,0);m.computeWorldVertices(u,0,g,p,0,2);for(let b=0,y=p.length;b<y;b+=2){let w=p[b],x=p[b+1],A=p[(b+2)%p.length],v=p[(b+3)%p.length];e.line(w,x,A,v)}}}}dispose(){}};d(gt,"LIGHT_GRAY",new N(192/255,192/255,192/255,1)),d(gt,"GREEN",new N(0,1,0,1));let cs=gt;class Yr{constructor(e,t,i){d(this,"vertices");d(this,"numVertices");d(this,"numFloats");this.vertices=e,this.numVertices=t,this.numFloats=i}}const Ht=class Ht{constructor(e,t=!0){d(this,"premultipliedAlpha",!1);d(this,"tempColor",new N);d(this,"tempColor2",new N);d(this,"vertices");d(this,"vertexSize",8);d(this,"twoColorTint",!1);d(this,"renderable",new Yr([],0,0));d(this,"clipper",new Dt);d(this,"temp",new qe);d(this,"temp2",new qe);d(this,"temp3",new N);d(this,"temp4",new N);this.twoColorTint=t,t&&(this.vertexSize+=4),this.vertices=O.newFloatArray(this.vertexSize*1024)}draw(e,t,i=-1,s=-1,r=null){let o=this.clipper,a=this.premultipliedAlpha,h=this.twoColorTint,n=null,l=this.renderable,c,u,f=t.drawOrder,m,g=t.color,p=h?12:8,b=!1;i==-1&&(b=!0);for(let y=0,w=f.length;y<w;y++){let x=o.isClipping()?2:p,A=f[y];if(!A.bone.active){o.clipEndWithSlot(A);continue}if(i>=0&&i==A.data.index&&(b=!0),!b){o.clipEndWithSlot(A);continue}s>=0&&s==A.data.index&&(b=!1);let v=A.getAttachment(),S;if(v instanceof xt){let E=v;l.vertices=this.vertices,l.numVertices=4,l.numFloats=x<<2,E.computeWorldVertices(A,l.vertices,0,x),u=Ht.QUAD_TRIANGLES,c=E.uvs,S=E.region.texture,m=E.color}else if(v instanceof tt){let E=v;l.vertices=this.vertices,l.numVertices=E.worldVerticesLength>>1,l.numFloats=l.numVertices*x,l.numFloats>l.vertices.length&&(l.vertices=this.vertices=O.newFloatArray(l.numFloats)),E.computeWorldVertices(A,0,E.worldVerticesLength,l.vertices,0,x),u=E.triangles,S=E.region.texture,c=E.uvs,m=E.color}else if(v instanceof vt){let E=v;o.clipStart(A,E);continue}else{o.clipEndWithSlot(A);continue}if(S){let E=A.color,I=this.tempColor;I.r=g.r*E.r*m.r,I.g=g.g*E.g*m.g,I.b=g.b*E.b*m.b,I.a=g.a*E.a*m.a,a&&(I.r*=I.a,I.g*=I.a,I.b*=I.a);let R=this.tempColor2;A.darkColor?(a?(R.r=A.darkColor.r*I.a,R.g=A.darkColor.g*I.a,R.b=A.darkColor.b*I.a):R.setFromColor(A.darkColor),R.a=a?1:0):R.set(0,0,0,1);let F=A.data.blendMode;if(F!=n&&(n=F,e.setBlendMode(n,a)),o.isClipping()){o.clipTriangles(l.vertices,u,u.length,c,I,R,h);let L=new Float32Array(o.clippedVertices),B=o.clippedTriangles;r&&r(L,L.length,p),e.draw(S,L,B)}else{let L=l.vertices;if(h)for(let T=2,Y=0,X=l.numFloats;T<X;T+=p,Y+=2)L[T]=I.r,L[T+1]=I.g,L[T+2]=I.b,L[T+3]=I.a,L[T+4]=c[Y],L[T+5]=c[Y+1],L[T+6]=R.r,L[T+7]=R.g,L[T+8]=R.b,L[T+9]=R.a;else for(let T=2,Y=0,X=l.numFloats;T<X;T+=p,Y+=2)L[T]=I.r,L[T+1]=I.g,L[T+2]=I.b,L[T+3]=I.a,L[T+4]=c[Y],L[T+5]=c[Y+1];let B=l.vertices.subarray(0,l.numFloats);r&&r(l.vertices,l.numFloats,p),e.draw(S,B,u)}}o.clipEndWithSlot(A)}o.clipEnd()}getSkeletonClipping(){return this.clipper}};d(Ht,"QUAD_TRIANGLES",[0,1,2,2,3,0]);let ds=Ht;const k=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],Yt=[0,1,2,2,3,0],Lt=new N(1,1,1,1);class Lr{constructor(e,t,i=!0){d(this,"context");d(this,"canvas");d(this,"camera");d(this,"batcher");d(this,"twoColorTint",!1);d(this,"batcherShader");d(this,"shapes");d(this,"shapesShader");d(this,"activeRenderer",null);d(this,"skeletonRenderer");d(this,"skeletonDebugRenderer");this.canvas=e,this.context=t instanceof Me?t:new Me(t),this.twoColorTint=i,this.camera=new Tr(e.width,e.height),this.batcherShader=i?Ne.newTwoColoredTextured(this.context):Ne.newColoredTextured(this.context),this.batcher=new Ut(this.context,i),this.shapesShader=Ne.newColored(this.context),this.shapes=new Ms(this.context),this.skeletonRenderer=new ds(this.context,i),this.skeletonDebugRenderer=new cs(this.context)}dispose(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()}begin(){this.camera.update(),this.enableRenderer(this.batcher)}drawSkeleton(e,t=!1,i=-1,s=-1,r=null){this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=t,this.skeletonRenderer.draw(this.batcher,e,i,s,r)}drawSkeletonDebug(e,t=!1,i){this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=t,this.skeletonDebugRenderer.draw(this.shapes,e,i)}drawTexture(e,t,i,s,r,o){this.enableRenderer(this.batcher),o||(o=Lt);var a=0;k[a++]=t,k[a++]=i,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=0,k[a++]=1,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a++]=0),k[a++]=t+s,k[a++]=i,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=1,k[a++]=1,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a++]=0),k[a++]=t+s,k[a++]=i+r,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=1,k[a++]=0,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a++]=0),k[a++]=t,k[a++]=i+r,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=0,k[a++]=0,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a]=0),this.batcher.draw(e,k,Yt)}drawTextureUV(e,t,i,s,r,o,a,h,n,l){this.enableRenderer(this.batcher),l||(l=Lt);var c=0;k[c++]=t,k[c++]=i,k[c++]=l.r,k[c++]=l.g,k[c++]=l.b,k[c++]=l.a,k[c++]=o,k[c++]=a,this.twoColorTint&&(k[c++]=0,k[c++]=0,k[c++]=0,k[c++]=0),k[c++]=t+s,k[c++]=i,k[c++]=l.r,k[c++]=l.g,k[c++]=l.b,k[c++]=l.a,k[c++]=h,k[c++]=a,this.twoColorTint&&(k[c++]=0,k[c++]=0,k[c++]=0,k[c++]=0),k[c++]=t+s,k[c++]=i+r,k[c++]=l.r,k[c++]=l.g,k[c++]=l.b,k[c++]=l.a,k[c++]=h,k[c++]=n,this.twoColorTint&&(k[c++]=0,k[c++]=0,k[c++]=0,k[c++]=0),k[c++]=t,k[c++]=i+r,k[c++]=l.r,k[c++]=l.g,k[c++]=l.b,k[c++]=l.a,k[c++]=o,k[c++]=n,this.twoColorTint&&(k[c++]=0,k[c++]=0,k[c++]=0,k[c]=0),this.batcher.draw(e,k,Yt)}drawTextureRotated(e,t,i,s,r,o,a,h,n){this.enableRenderer(this.batcher),n||(n=Lt);let l=t+o,c=i+a,u=-o,f=-a,m=s-o,g=r-a,p=u,b=f,y=u,w=g,x=m,A=g,v=m,S=f,E=0,I=0,R=0,F=0,L=0,B=0,T=0,Y=0;if(h!=0){let re=V.cosDeg(h),ne=V.sinDeg(h);E=re*p-ne*b,I=ne*p+re*b,T=re*y-ne*w,Y=ne*y+re*w,L=re*x-ne*A,B=ne*x+re*A,R=L+(E-T),F=B+(I-Y)}else E=p,I=b,T=y,Y=w,L=x,B=A,R=v,F=S;E+=l,I+=c,R+=l,F+=c,L+=l,B+=c,T+=l,Y+=c;var X=0;k[X++]=E,k[X++]=I,k[X++]=n.r,k[X++]=n.g,k[X++]=n.b,k[X++]=n.a,k[X++]=0,k[X++]=1,this.twoColorTint&&(k[X++]=0,k[X++]=0,k[X++]=0,k[X++]=0),k[X++]=R,k[X++]=F,k[X++]=n.r,k[X++]=n.g,k[X++]=n.b,k[X++]=n.a,k[X++]=1,k[X++]=1,this.twoColorTint&&(k[X++]=0,k[X++]=0,k[X++]=0,k[X++]=0),k[X++]=L,k[X++]=B,k[X++]=n.r,k[X++]=n.g,k[X++]=n.b,k[X++]=n.a,k[X++]=1,k[X++]=0,this.twoColorTint&&(k[X++]=0,k[X++]=0,k[X++]=0,k[X++]=0),k[X++]=T,k[X++]=Y,k[X++]=n.r,k[X++]=n.g,k[X++]=n.b,k[X++]=n.a,k[X++]=0,k[X++]=0,this.twoColorTint&&(k[X++]=0,k[X++]=0,k[X++]=0,k[X]=0),this.batcher.draw(e,k,Yt)}drawRegion(e,t,i,s,r,o){this.enableRenderer(this.batcher),o||(o=Lt);var a=0;k[a++]=t,k[a++]=i,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=e.u,k[a++]=e.v2,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a++]=0),k[a++]=t+s,k[a++]=i,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=e.u2,k[a++]=e.v2,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a++]=0),k[a++]=t+s,k[a++]=i+r,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=e.u2,k[a++]=e.v,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a++]=0),k[a++]=t,k[a++]=i+r,k[a++]=o.r,k[a++]=o.g,k[a++]=o.b,k[a++]=o.a,k[a++]=e.u,k[a++]=e.v,this.twoColorTint&&(k[a++]=0,k[a++]=0,k[a++]=0,k[a]=0),this.batcher.draw(e.page.texture,k,Yt)}line(e,t,i,s,r,o){this.enableRenderer(this.shapes),this.shapes.line(e,t,i,s,r)}triangle(e,t,i,s,r,o,a,h,n,l){this.enableRenderer(this.shapes),this.shapes.triangle(e,t,i,s,r,o,a,h,n,l)}quad(e,t,i,s,r,o,a,h,n,l,c,u,f){this.enableRenderer(this.shapes),this.shapes.quad(e,t,i,s,r,o,a,h,n,l,c,u,f)}rect(e,t,i,s,r,o){this.enableRenderer(this.shapes),this.shapes.rect(e,t,i,s,r,o)}rectLine(e,t,i,s,r,o,a){this.enableRenderer(this.shapes),this.shapes.rectLine(e,t,i,s,r,o,a)}polygon(e,t,i,s){this.enableRenderer(this.shapes),this.shapes.polygon(e,t,i,s)}circle(e,t,i,s,r,o=0){this.enableRenderer(this.shapes),this.shapes.circle(e,t,i,s,r,o)}curve(e,t,i,s,r,o,a,h,n,l){this.enableRenderer(this.shapes),this.shapes.curve(e,t,i,s,r,o,a,h,n,l)}end(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null}resize(e){let t=this.canvas;var i=window.devicePixelRatio||1,s=Math.round(t.clientWidth*i),r=Math.round(t.clientHeight*i);if((t.width!=s||t.height!=r)&&(t.width=s,t.height=r),this.context.gl.viewport(0,0,t.width,t.height),e===bt.Expand)this.camera.setViewport(s,r);else if(e===bt.Fit){let o=t.width,a=t.height,h=this.camera.viewportWidth,n=this.camera.viewportHeight,l=n/h,c=a/o,u=l<c?h/o:n/a;this.camera.setViewport(o*u,a*u)}this.camera.update()}enableRenderer(e){this.activeRenderer!==e&&(this.end(),e instanceof Ut?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Ne.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):e instanceof Ms?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Ne.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)}}var bt;(function(C){C[C.Stretch=0]="Stretch",C[C.Expand=1]="Expand",C[C.Fit=2]="Fit"})(bt||(bt={}));let St,ot,Rs=0;const Xr=1,ss=1,Fs=165,Ys=108,st=163;class Br{constructor(e){d(this,"renderer");d(this,"logo",null);d(this,"spinner",null);d(this,"angle",0);d(this,"fadeOut",0);d(this,"fadeIn",0);d(this,"timeKeeper",new Ps);d(this,"backgroundColor",new N(.135,.135,.135,1));d(this,"tempColor",new N);if(this.renderer=e,this.timeKeeper.maxDelta=9,!ot){let t=navigator.userAgent.indexOf("Safari")>-1,i=()=>Rs++;ot=new Image,ot.src=Vr,t||(ot.crossOrigin="anonymous"),ot.onload=i,St=new Image,St.src=Pr,t||(St.crossOrigin="anonymous"),St.onload=i}}dispose(){var e,t;(e=this.logo)==null||e.dispose(),(t=this.spinner)==null||t.dispose()}draw(e=!1){if(Rs<2||e&&this.fadeOut>ss)return;this.timeKeeper.update();let t=Math.abs(Math.sin(this.timeKeeper.totalTime+.25));this.angle-=this.timeKeeper.delta*200*(1+1.5*Math.pow(t,5));let i=this.tempColor,s=this.renderer,r=s.canvas,o=s.context.gl;if(s.resize(bt.Expand),s.camera.position.set(r.width/2,r.height/2,0),s.batcher.setBlendMode(kt.Normal,!0),e){if(this.fadeOut+=this.timeKeeper.delta*(this.timeKeeper.totalTime<1?2:1),this.fadeOut>ss)return;i.setFromColor(this.backgroundColor),t=1-this.fadeOut/ss,t=1-(t-1)*(t-1),i.a*=t,i.a>0&&(s.camera.zoom=1,s.begin(),s.quad(!0,0,0,r.width,0,r.width,r.height,0,r.height,i,i,i,i),s.end())}else this.fadeIn+=this.timeKeeper.delta,this.backgroundColor.a>0&&(o.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a),o.clear(o.COLOR_BUFFER_BIT)),t=1;t*=Math.min(this.fadeIn/Xr,1),i.set(t,t,t,t),this.logo||(this.logo=new Tt(s.context,ot),this.spinner=new Tt(s.context,St)),s.camera.zoom=Math.max(1,st/r.height),s.begin(),s.drawTexture(this.logo,(r.width-Fs)/2,(r.height-Ys)/2,Fs,Ys,i),this.spinner&&s.drawTextureRotated(this.spinner,(r.width-st)/2,(r.height-st)/2,st,st,st/2,st/2,this.angle,i),s.end()}}let Pr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKMAAACjCAYAAADmbK6AAAALKElEQVR42u2de2iW5R/GPzuqcwfnnKfNmafl5tTNHWzqNi3DEMQykcAoJSsySkspjSIk0iD/07Kf4R+FnVBDUTshZGpWUEJaaiWFgZlUFmXmIe3HNXthyebeZ77P9H13ffBG8Y8H7ut7vff93N/7fu4vGGPiFZiez/Qtw9lytJajfzfw9z/j+efPOv7cV8W+lUNY2a8T/ayTCRsWFLJA5rtUO1LLkV5p9LJeJizQiHeqnlOtmVFtdTGrrZkJCxYXsTgaI6r9MY4/UpNItW4mFDaXsTlaM6qVZlBq3UwofFrJp0HMWJ9DvXUzobCznJ1BzFjWlTLrZkJh/TDWBzFjTgo51s2EgnKI0Rrx+FiOWzNzVaym91Syx5qZsGBWb2ZFa0ZN6dbMhAWTcpkUrRmXD2K5NTNhgVbH0Zpxbl/mWjMTFvRIo0e0ZpzcncnWzISKtvmiMWNRJ4qslwmVXRXsas2Ix8ZwzFqZsGFREYtaM+Oaa1ljrUzYkJ9G/ok6TlzKjJWZVFor0y7c1Zu7WjLiqiGsskamXdHopyT4vALmzS9k/t19uHtKHlOSIMn6xAtARjIZ1sFcUSZ0Y4La+G6M18hS2IlCn4a+WoC0JNL0d/dUupdnUj40g6EJ2VEdMnhrOG/p5f/jUXz8SgmvaGU6KpNRNsLVQV0OdXf24s63h/P2gWoOrBjMCr2GJFQnnxnIM3q5P1PPmaYv+4ev4/C6UtbpV2gzXCkgL5W8Bwt48OIc6ul6Tp+s4+SyASxLiI4+PYCn1bHzDZxvaQW6vZzto7MYnQIpNkf7kp5EuozYUroqEjcNKHHd0Tl9mBPN1pk+hFeieGBnBtog7UXjsj9pWg+m6duecw2cay1OC/uxMC47KmP9OIYfoz1YoC20J/rzRG4quTZK2EAyJGs20qwUbYw0aNRmUxtvfUW/uEtNzc1NB1/X8LVyd15hh82F43AvD+VlXcsSJEZa1CQ3ejleAO7oxR3RDP0XN91X4+NXYb8nkv7UNTwV7e0YTdu7I3g33t7tuaEbNwSZpps2fSyvs4M2Tjhot+jb0Xzbltj8r5j/xVt/6Z1Ob93U1ZYO691EhhzchcHeXosVjcNZysyezLw4xRZt05R+fTeuj8vOj+zKyG0j2aZcVVs6v+QalnjrMFZASQYl2nBoSyz06e3j/Xk8rgWYmMvEICu2pm1HOTuc7okV8FgRj0XukwzanhvCc/F+72TjoQjdObN1OFuDLmh0xP+WHtxiI10ukJlCprb4guiv1fP+avZrS1C7NAkliHZjDtZwMMgqbukAltpMlwuMy2FcEBPqvfLLar5Uqi0hBdEwryy+Mv5n6zkbjTBa+dlMlwvUZFETZKGiFM7tvbhdJ3gSVRO0wzIjnxmvl/J6a6JsGMYGrahtpssFeqbR841S3mhN80OjOaSDEdqd6SjaMKgzgzRK7q1ib3PT9sYyNo7JZoyNFNvRcVMZmy7WOvIuryv/Zvdmdt90+nY0bRp3AvROohFwdwW7dTG7RFlbwlqdrbOBYg005NAQmZU0HWt1rXMBH1Xw0dQ8pmqzoaPmdhun7bHZjNVe9qP9eFQfO1VkUmHjhAVUZ1GtnKFSbjrkrPfy4i4UW5t/6ZxM54J0CqxFe81KpGsQyE4h23oYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjLna+bdOy+IiFquIpGq16Pb79cNYv3IIK/X/ugx+Ui6TVKvYVU9Nc8gX8od8Ir/IN/KPfCQ/yVfyl/6/pfJvLChkQdD6wyqntquCXYuKWJSfRr6D0dEAxV3xlw/khyD+kd/ku/88cHo+09tS3LBpO1HHCVUqcIA6CqB4K+6X6x35L/JM2loXurlWmUmlA5XogOIcK8/If5HncrSWo7F6cKIWPjT/RXGOlWfkv8hzaWsN4uaaysE6WIkOKM6x8oz8F3kusXqo2vxC5jtYiQ4ozrH0TeS5qIZcrB7qkrwdA8U5Vp6R/yLPZV8V+2L14Cl5THGwEh1QnGPlGfkv8lyUlIzFQ1cNYVVHrcjZ0VCcFe9Y+Eb+izy3ceclUl43aFN52DXXssYpnY6a4qFS8ZcP2uIf+e7inRh6pdFrdTGrm8uiHx/L8T2V7NGWzvJBLJ/bl7mTuzO5qBNFDoiJID/IF/KHfCK/yDfyT3O7d/KbfNfS80hNIrU0g9L6HOq1x5iTQo6FNpeLfCQ/yVfyl3xmXYwxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHNk9z4JwJ0SqKTdQkbyEwhU393T6V7zzR6pieR3tE1ITeVXImhe6BXDGZFdRbVeank2TBhcaEMr0rwbixj49IBLL2/L/ffmMuNHfqO9tFZjJYBd1ewO3Lx+IcVfKhqna5nHZYR6XFPH+5R3eeI5t9fx/fvjeC9Jdew5OKZKqFR/RDVKL6vL/f9PJafmyvHsL+a/ff24V6NmjZQbGchVbY6UM2BluqHv1rCqzVZ1KQlkZboepCdQvacPsz5bjTfXao+yMEaDt7Wk9tSIMVGig3TejCtJSM2bSpkPjWPqd1S6Zao+lORSYWmgkOjORRNwZqd5ezMSiHLRooNr5XwWjS6/1XHX9vL2T67N7M1iyXa9JCrYjVrS1gbpJyw6hBfsmiNCYT0P9/A+Wj1/6qGr5YNYFlJBiWJogEzezLz/ZG8/9s4fgtSyuvNYbyp1IONFBtu7sHNv4/j9yAxUHWrdaWsG9+N8XHd+YxkMpSy+aySz841cC5oXbmHCnnI74yxAgZ3YbDeB4PEQCOpBpFNZWwa2ZWRcdnxLsl00crtRB0n2lLg8JNRfDKoM4NsolgBSmw/UMADba1+qpmqfyf6x1u/0a/og3I+aEunP6/i86osqmygcGarF4p54dex/Bo0LqfqOfVwIQ/HW5/RSkwV1oN2WLlHTc82TljAwM4M1O5LWwYKZTjibYXNS0N5KcjKTe10PadfLObFuJwK4ozp+UzXDBTUjL+M5ZcBnRkQV53dMIwNQTu6bSTbVEzbi5awuVByd2E/FgaN0Tc1fKOzBHHV2aAdVSdv6s5NNkp7cSH/++xAng2yyHx+CM/H21YhfdPp+0U1X0TbSZnXx8faG9Aop0MS0cToh1p+iLcpOkLj9t/JOk5eqoPHxnDsyf486an5yqCDK7XZ1O4oZ4dWyy3FSXHUAYq47uyYbMZoGmhpG3DlEFb6uNiVBhpyaHhnBO8oJmfqOROJjzIiP43hJ8UxITqqX56S2Hur2KsOnq3nrE6PPNKPRwrSKbAZrjTQNZmuE7oxYXMZmxWbw9dxWFu4W4ezVedOE6qzI7oyYkY+M7TPeWsPbk2UX1qioSN+E3OZqOR2cReKE+qQRFN0Pi7y73g/UawU1KzezJpXwLz5hczX1ueUPKYkNb6GJQZ+j7/aAfRZREsv+quGsMoamXZBW2Gt5eU0alorEzYsKmJRa/m4NdeyxlqZsCGa84DKnVorEzboC7podis69DfIJmwufHMc7famvvmxZiYsKOtKWbRm1OcW1syEBboSJFozLh/EcmtmwgIluaM14/phrLdmJixYXMTiaM24p5I91syEBTphFOR7Y2tmwgJNvUFOr+tov3UzoaAv44KYUatv62ZCoemdhtG0+hzqrZsJBR08DWLG0gxKrZu50qvpxos3U5NItW4mFPp1ot+lPlpq2lYXs9qamVBZUMiC1ox4pJYjvlfStAu6GmTLcLboMtPIV4/6im5fFfuUi9QIap2MiWP+D96R1vPmsD/fAAAAAElFTkSuQmCC",Vr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKUAAABsCAYAAAALzHKmAAAQ7klEQVR42u3da4xdVRUA4D0zd2Y6nZY59DVtZ1puS9+lzC0YAi2UQ8AAQczFpPgA9VIeIQbirRqJ0cBUBVGjDr/QCKSNRSMmpuODxAdxqhgwxkhFjf6Sxh/+UUNVNGJCzR7uTvas7LXX2q9zzp3em6y0gTN3Zu75utZe5+yztxC9V+/Ve5X9En1Vjd7J6SFbLNF7naPw+l2jh7YHMBWssqMHtlsRdim4qsLtIawaPiHEQOLoNrA9iIkQDnRrVA1qD2LZ8ISoxYqKo13sQAtBWBayQWZUAXGRQM9JjCngDVY0UqJNDbQrMcaGmArdUKpIjbYiQLsCZCyIMQBy8QwnilR4Q5AuCpxFYvRFmBLbEiwKwpsSaWycVQGZBKMrwBjA9BhxDe57u2L2hOoKNCbOrgAZitEVYUxoKSMErQvSxYIzCkguRg5EF4AUhqUlhy/YUKSxcRaKsioYOQhD4I0yYxkR3PcJBcuFysmgsXAWBTMJyBCMIQh9kGGxXIXvexCQXbHGAMrBWTbM2CCpMSMLIxehC77lSJwXGth7M0FzoVJIXXDWQnGmhOkL0ic7YhhtWdGGkAuPAjUWGoF4faCmwBkbZmyUqUCyMqMLRA4+E6IsdTjidUHKBYrh9CnpRcH0ypKxsyOGEYNIIeTCOz91OIJ1QYoB5eAMyZo+MFNnyVTZ0YiRC9EGEMOyAgshxErHsL2XK1gOUgwohtM1a5YNM7Rsu4K0ZkcbRm4mpPBRwFZ5hg9eCqkrUB+csWGGogzNkqEgrdnRhpGLkINudaLgwvVB6oqzCjCTZElb2Y4B0gUjBtEG0ARnDRLjjoG9DwcshtQGlIPTljVjwUySLWNkyRCQVHa0ZUUTRAwgF91a33BEy0VKAcVwwqwZC2bqbOlUurllOxQkJzNyINoAYqjWhYYjWg5SCiiG05Q1U8FMjTIoS8YE6YORi1BHtJ4KIcQEEtTXUWAxpK44YVlPBdO1jCdFWTZIE8bVGEYMIRPcZGBw4HKQcoBiOE1ZMzbMgVQwU6JMAdKEEcuIJogUvg1YCCE2gsCO42DlIIVAKZwpYJaSLVNnSU6XjYHUmxhTmXaFaMO3EYkLqMC+FsLlIoVAKZzMrEnBhJeLfLNlKMrYWRIDCbOkFSSVHbHM6AKRC6/ODUewNqQ+OLlZkxpjUmV8MBbMUJSxyzY3Q1IgTRgxiBRCHdem0KDAUkBh9sRwwjEnAXMMgTnKhFlUtiwkS5rGka4g9SaGgxFmRC7AzTCEEBcyA36dDSsXqAtOLkysjGMwY5XxVChjZ0kuSCo7YlkRQsQQYtDEFsegsLoCxUp7Kpgps2UslFGzJGccSYHUmxhOZqwzEZqAbfUMCisHKIZzgsCpl3MTzMwTpi1bYp2477gyFKUxS7qWbdjY2EBS2dGE0QQRA7gNCyHEdhjE8RhUDlBT9tzgmjWZMFNlSy+Urk1OzCyJlW0XkK4YOQh1cDtcgwBrQmoDWkdgboBZE8mYsJSHlnFbJ+5bwmOPJ7lZkirbC8aRsMvmgtTHjBhGE0QbwJ2egUE1ITVlUC5OmDVdYNrKuN70xM6WoShjlW4464dbtiFIWK6x7GjESEHUUe0iYncnbMdQSE0Z1ITTNOb0hRmjjLtmS9dmJ2rp1jtuKktyyrb6YLEMCUHq2dGG0QQRQ7f72kzc+cJecerne8Wvv7JNPHPvenEkz8Sh3UtFc92QyGt9Yko/HgOLAIUZlItTz5ouMF3KuE+2jFLCQ1D6lm6fLMkBacuOJowYRBUXyfjuHjF3NhdnsfjvAfH6E9vFt9XxKgikEKgJZyyYalzOLeMu2bLbULI6bh+QGwmQ+rgRlumdGEQAao+K56bEL2woVUwOiev0r8OAUjiJrMmFCbvykGxZRAmPitK1dHM7bohyMsuyi/I8f0+e57fJYIKEZXpXo9E4mOf5XTKyLLvCBLETF8uY2SKepkC+dpX4T02Ivepr4HvZcOZ5fmee54fyPL+DmTUhzAs6n4n8bN5dr9f3YdkSg8nsxG0lPBVKVpNjG0/aGhzfLDmRZdnumZmZp8+c+cdZPV555fSr7Xb7s0jJ3i5Pcue4MxKkPPkvvXTqz/B92u32l0wYOzG1fkhcd/py8Rcbyq/vFM/KY1WA95h/3zzP71bfU6JsNpsfgj+P/FlbrdaDGExYyuXvLz8H+DudODH700ajcSM3W6Yu4alQ1spCOTd38jcKocTZbh9+9NixY99XJ8AEUkcpo9W64yH197m5k7+bnZ19QT+J09NHntQhwji/Jg58qi6++ofLxJ8gSFneVw2Ka4QQDfh1Ok4dZavVmtZ/nrm5k7/Vf55O1tRhboUw5+ZOvqyOl5+R/FyOHj32PYVU/tloNG5IXcKrhJIzngwp3fNjomazea/64BuNxts646f50lWv169utw9/DmtqdJQyZFaSJVuV6nq9fqMEof5/vV6/CYBqgJDlee+yAbF/+4i4ZWqZeNfaIfHWzn+Hx0KcEuU9+s8jv3ej0bhVlXOZydX/k0iRMeb8P0D5e6tj8zy/Xb9UJIc56h/yqVOnXul8lmuZ2bJslKmbHG7XrbpCmCXFRLvdfqQD6jTS3Jiy5I4OykM6ADV+1Eu1DmV6evopBORexzDi1L+X/HnGxsb2w3Hm9PSRJ9QxWPOTZdmlKht2hi+w6dkox5bqffI8fye3hDteGqKaHVsHXihKl0tB+h0cY+lute54AGRKDCW89LNTRynHb7ChUWVVjetOnJh9EYBUyPZeNCoOtsbFQwdXi4/esELcd+tq8cCHJ8UXp+viy9efLz7AgamjlKXc1AA1m83DoIRDlFubzeb96hhZLVTlgJ24gttutx+ONa50bHZKRenaeTs1OfpAfnr6yOOdE7EZdNwmlKocntXLNkA5JTGq47Ds+Lf94lWsyfnXleLfnIwJUN4DOnNYwuUxh2A3Ln9XULrfK8t3J27Tu3BVwiOjXJqoAy8UZej1yclGo3GTLN+gu3w+z/P3YaWbQqk3Ne12e4ZC+c8rxWsYytcPiP9RpZxCqWDKnxOiBNlyAUpOnGsoh4tA2Rm8X9xqtT6md5wyZmYe+0YRKL+1S/wYQ3n8zctBl5SBUv5djivfjMOPduIzcizeiYfr9foVvUwZG+XCuzibZKnSceZ5/v4QlKp8y7ElhnJlTeTP7BI/kllRYfzrfvHqFy4UX1vaL/aVlSmROzwbwdS29T2UcEwZF+V8ozM2lu1VY812u/15akypGh3TmFJesJbHHD167IdUxz3YJy5bNySuX1mbvy55CbMLtzU6tjGlsdFptVqfUMc0Go23F4wy1l2dSnbfvpMwVPe9WWVLDsrOJaF9MFu2Wq1PqmNkGce67xiXhTjdNwdlvV6/BgxfbPfBfVCetxi6b9/rlCup65QzM48dl2OjLMv26CibzeZ96sTIzEFdpwQXz9U1yrtVlpR/Zll2Fec65Y6l4pbbx8XHH9kknvzJlPjlHy8Tp29eKT5ou0aJoIT3w3dBlLDzVpfAJEZ1XOdaJZxnOSlvPMjPzxFljIvng914RwebsjYO7uhMyHu46sOfnf3Oz2TXDW6vvYxdFoIXz3Wc8J5zs9n8iOn2IrxTc2BM3Glqdp7dI553uaOjxrhwcob+MyuUpjs6WZZdon8OcigjPx8V+u+GTWFTSWEx3WYcdJ225jNDSE4q0GHCzlueHOyujn6bUWYgeb9ZZUaQPe+GzQ+Gc8+oOGhC+c1d4gfI16n3XDAhQ7+9qE9l01E2Go132GYKyXE1NiFDTcpoNpv3LOYJGWXNErJNW9sEp63p2RKiVPMn1bS1DgxsyhoGdGpmizj+xtXiDYnx7/vFmce3iWdW1cTVGEY4hQ2ZW0nNq8Qm/M6XbXm3S100lwGedFybuvNOibLI+ZS2ceU4eAxiEuvCkfmU8ycToDxETe6FgCBQHeqyAbFvfEhcO7BwDuXFCEbTZF840XeHK0jYcbs2OIGle0mVJ/mmnClEPQqxyTY5I8/zFhif7fSZee4bnrPOU4AssnRXHaVTCTd14dRDY3UbTIiSeFhsN/aMjgnqthFx880rxX3yATL5p3y4LPXzOaBkUyBjZMlYpbtQlIOBD475ZEusjMNSvkXe6VEoJVDkeZ2dzIfIFsRzU+JF2OyM9M9fTC/6SUYOyFQPjQ2nWiUjxnPfw5EeHqMWIqAeIFsAU847lJM2JM6xsewt1OIDLs99P7ZFHNdB/upS8XtPiD7PfLuCXJNolYyyFiNI/Zit65ItrOVafFbHcFohY7hPTN21Tjz4uc3iqfsnxKdX1MTl1OoYRFaMsToGB6Trw2JFP/OdZC2hJZ7ZkrMoAbbSGmelDJ91hFKuJeS7jlBMkJnrAqqJlgMUZS/dArPlGHNdSg5M3xXXtvquuEatvIYtDRhpxbUJuIgqsU5lGWtUploK0KuEU9mSW8YpmFQ556xNuYW7NiW13B+FkMiKHIy+C6eGgBxJvMR0oSv5hi6+z4HJyZoU0M2RVvDlrOQbcxVfX5AhZbuqy0v7ZstYMLHlAVlLTF9ALLbvu9Y5Zylpn/XOsd0ibIvxr2KCLHpp6SCUIdnSZSF+WzfOhem6GD+1KwR3Z4jNjrtDpNoZwmWd8yrupZN6Hx3fbMmFSe0Swdq2ZIPjxk1112Duo8OBGLrBkw/IoncdK2XHsdC9dHz204m50xh3tzFq1zFqtzHXrfCw7OgDsqyNnZLszVijsmXgrmNcmGtS78lIoMX2aJz03fKO2sDJddPQSCDPiQ1DfWBycY6XtXstc2PQKuxgG2McmXTPb9/9vmuJYXKyJrWjbeg+3xPM4O73nWqvbyw7xgZZSJbEUBa157cNJjdr2vb+5iA1YV3HxYscj30PDCEHIgcjtfm8K8hSsmRotkwFk5s1TTghUAopB6xrjHMBBkI0YYTZ0dZlxwLpkiWDULpmy5gwqayZgZNkA7oKQQCxctByYg0XIIEQQuRitGVHblMTA2ShKGPDpC6wu+DEgJqg2rDGDBtAF4Q6RAojp1xXGmSMbImVcR+YWNY04eQCtUG1ofUJ2/uvcETIgUhhdAE5GAlkKShjwHTNmhhODKgJqQ2sC14uOgyfD0IbRF+MlQaZAiZWyn2yJsTJATqGnHQO2Jhh+xlsACFCG0QbRtdyzQFZCZSxYPpmTS7Q5cjJHYNBYIkZpu99HoUQ/o4QIYSIZUZfjJ4ZMjZI32wZBDMU5yhy8pZTULl4XYP5fagMyEVoy4oupTpGduwnkloSlKEwY+AcQU4MhRTD6ovXBRwFzwWgCSEF0QVjJUGmgEllTS5OLlCIlIN1mS9mx/cZ5eLDALpCTI2RAhkTZQqYoTgpoCPECbaBHQ2ETL3PUl98ECAXYijG0OyYAmQoTG7W5ODkAF1CnVgm2JQx4okPA+gCMTbGskBGgRmaOblAh5GTORIrfKFx4VH4EIAxIXIxlg2SBbMvECY3e7oApbDaIgQu5/2HmeEKEINYiwSRi7EQkLFgumZOCuggctKGI4ULZN/vMeSLj0AYMytWEqMLzFg4fYDaoKaC6wvOFR4FkIPQFaILxrJAOsHsc/zlfYDWXE8qF22s8Pz5KHxcgEVALBtjJXBSSEOwFhk1Zgy4hitCT4hVw+gFs8/zwxqIBbUgyK7fcyA0PD9XX4iVxhiC0xdof6STWCsoBmKF7+cVCWFXQYyBMxRpf+STX1b0x45AhN0OMSrOGEirhrY/dfQAdjvS7oy+WCF6r1RIFxXWvlTRg1YVqFWBmxZbD99ig9pt0YPQw9rD1nstVri9V+/Ve3XrS/wfim4P5fIFxLoAAAAASUVORK5CYII=";class Or{constructor(e,t){d(this,"config");d(this,"parent");d(this,"dom");d(this,"canvas",null);d(this,"context",null);d(this,"sceneRenderer",null);d(this,"loadingScreen",null);d(this,"assetManager",null);d(this,"bg",new N);d(this,"bgFullscreen",new N);d(this,"playerControls",null);d(this,"timelineSlider",null);d(this,"playButton",null);d(this,"skinButton",null);d(this,"animationButton",null);d(this,"playTime",0);d(this,"selectedBones",[]);d(this,"cancelId",0);d(this,"popup",null);d(this,"error",!1);d(this,"skeleton",null);d(this,"animationState",null);d(this,"paused",!0);d(this,"speed",1);d(this,"time",new Ps);d(this,"stopRequestAnimationFrame",!1);d(this,"disposed",!1);d(this,"viewport",{});d(this,"currentViewport",{});d(this,"previousViewport",{});d(this,"viewportTransitionStart",0);d(this,"eventListeners",[]);this.config=t;let i=typeof e=="string"?document.getElementById(e):e;if(i==null)throw new Error("SpinePlayer parent not found: "+e);this.parent=i,t.showControls===void 0&&(t.showControls=!0);let s=t.showControls?`
<div class="spine-player-controls spine-player-popup-parent spine-player-controls-hidden">
<div class="spine-player-timeline"></div>
<div class="spine-player-buttons">
<button class="spine-player-button spine-player-button-icon-pause"></button>
<div class="spine-player-button-spacer"></div>
<button class="spine-player-button spine-player-button-icon-speed"></button>
<button class="spine-player-button spine-player-button-icon-animations"></button>
<button class="spine-player-button spine-player-button-icon-skins"></button>
<button class="spine-player-button spine-player-button-icon-settings"></button>
<button class="spine-player-button spine-player-button-icon-fullscreen"></button>
<img class="spine-player-button-icon-spine-logo" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20104%2031.16%22%3E%3Cpath%20d%3D%22M104%2012.68a1.31%201.31%200%200%201-.37%201%201.28%201.28%200%200%201-.85.31H91.57a10.51%2010.51%200%200%200%20.29%202.55%204.92%204.92%200%200%200%201%202%204.27%204.27%200%200%200%201.64%201.26%206.89%206.89%200%200%200%202.6.44%2010.66%2010.66%200%200%200%202.17-.2%2012.81%2012.81%200%200%200%201.64-.44q.69-.25%201.14-.44a1.87%201.87%200%200%201%20.68-.2.44.44%200%200%201%20.27.04.43.43%200%200%201%20.16.2%201.38%201.38%200%200%201%20.09.37%204.89%204.89%200%200%201%200%20.58%204.14%204.14%200%200%201%200%20.43v.32a.83.83%200%200%201-.09.26%201.1%201.1%200%200%201-.17.22%202.77%202.77%200%200%201-.61.34%208.94%208.94%200%200%201-1.32.46%2018.54%2018.54%200%200%201-1.88.41%2013.78%2013.78%200%200%201-2.28.18%2010.55%2010.55%200%200%201-3.68-.59%206.82%206.82%200%200%201-2.66-1.74%207.44%207.44%200%200%201-1.63-2.89%2013.48%2013.48%200%200%201-.55-4%2012.76%2012.76%200%200%201%20.57-3.94%208.35%208.35%200%200%201%201.64-3%207.15%207.15%200%200%201%202.58-1.87%208.47%208.47%200%200%201%203.39-.65%208.19%208.19%200%200%201%203.41.64%206.46%206.46%200%200%201%202.32%201.73%207%207%200%200%201%201.3%202.54%2011.17%2011.17%200%200%201%20.43%203.13zm-3.14-.93a5.69%205.69%200%200%200-1.09-3.86%204.17%204.17%200%200%200-3.42-1.4%204.52%204.52%200%200%200-2%20.44%204.41%204.41%200%200%200-1.47%201.15A5.29%205.29%200%200%200%2092%209.75a7%207%200%200%200-.36%202zM80.68%2021.94a.42.42%200%200%201-.08.26.59.59%200%200%201-.25.18%201.74%201.74%200%200%201-.47.11%206.31%206.31%200%200%201-.76%200%206.5%206.5%200%200%201-.78%200%201.74%201.74%200%200%201-.47-.11.59.59%200%200%201-.25-.18.42.42%200%200%201-.08-.26V12a9.8%209.8%200%200%200-.23-2.35%204.86%204.86%200%200%200-.66-1.53%202.88%202.88%200%200%200-1.13-1%203.57%203.57%200%200%200-1.6-.34%204%204%200%200%200-2.35.83A12.71%2012.71%200%200%200%2069.11%2010v11.9a.42.42%200%200%201-.08.26.59.59%200%200%201-.25.18%201.74%201.74%200%200%201-.47.11%206.51%206.51%200%200%201-.78%200%206.31%206.31%200%200%201-.76%200%201.88%201.88%200%200%201-.48-.11.52.52%200%200%201-.25-.18.46.46%200%200%201-.07-.26v-17a.53.53%200%200%201%20.03-.21.5.5%200%200%201%20.23-.19%201.28%201.28%200%200%201%20.44-.11%208.53%208.53%200%200%201%201.39%200%201.12%201.12%200%200%201%20.43.11.6.6%200%200%201%20.22.19.47.47%200%200%201%20.07.26V7.2a10.46%2010.46%200%200%201%202.87-2.36%206.17%206.17%200%200%201%202.88-.75%206.41%206.41%200%200%201%202.87.58%205.16%205.16%200%200%201%201.88%201.54%206.15%206.15%200%200%201%201%202.26%2013.46%2013.46%200%200%201%20.31%203.11z%22%20fill%3D%22%23fff%22%2F%3E%3Cpath%20d%3D%22M43.35%202.86c.09%202.6%201.89%204%205.48%204.61%203%20.48%205.79.24%206.69-2.37%201.75-5.09-2.4-3.82-6-4.39s-6.31-2.03-6.17%202.15zm1.08%2010.69c.33%201.94%202.14%203.06%204.91%203s4.84-1.16%205.13-3.25c.53-3.88-2.53-2.38-5.3-2.3s-5.4-1.26-4.74%202.55zM48%2022.44c.55%201.45%202.06%202.06%204.1%201.63s3.45-1.11%203.33-2.76c-.21-3.06-2.22-2.1-4.26-1.66S47%2019.6%2048%2022.44zm1.78%206.78c.16%201.22%201.22%202%202.88%201.93s2.92-.67%203.13-2c.4-2.43-1.46-1.53-3.12-1.51s-3.17-.82-2.89%201.58z%22%20fill%3D%22%23ff4000%22%2F%3E%3Cpath%20d%3D%22M35.28%2013.16a15.33%2015.33%200%200%201-.48%204%208.75%208.75%200%200%201-1.42%203%206.35%206.35%200%200%201-2.32%201.91%207.14%207.14%200%200%201-3.16.67%206.1%206.1%200%200%201-1.4-.15%205.34%205.34%200%200%201-1.26-.47%207.29%207.29%200%200%201-1.24-.81q-.61-.49-1.29-1.15v8.51a.47.47%200%200%201-.08.26.56.56%200%200%201-.25.19%201.74%201.74%200%200%201-.47.11%206.47%206.47%200%200%201-.78%200%206.26%206.26%200%200%201-.76%200%201.89%201.89%200%200%201-.48-.11.49.49%200%200%201-.25-.19.51.51%200%200%201-.07-.26V4.91a.57.57%200%200%201%20.06-.27.46.46%200%200%201%20.23-.18%201.47%201.47%200%200%201%20.44-.1%207.41%207.41%200%200%201%201.3%200%201.45%201.45%200%200%201%20.43.1.52.52%200%200%201%20.24.18.51.51%200%200%201%20.07.27V7.2a18.06%2018.06%200%200%201%201.49-1.38%209%209%200%200%201%201.45-1%206.82%206.82%200%200%201%201.49-.59%207.09%207.09%200%200%201%204.78.52%206%206%200%200%201%202.13%202%208.79%208.79%200%200%201%201.2%202.9%2015.72%2015.72%200%200%201%20.4%203.51zm-3.28.36a15.64%2015.64%200%200%200-.2-2.53%207.32%207.32%200%200%200-.69-2.17%204.06%204.06%200%200%200-1.3-1.51%203.49%203.49%200%200%200-2-.57%204.1%204.1%200%200%200-1.2.18%204.92%204.92%200%200%200-1.2.57%208.54%208.54%200%200%200-1.28%201A15.77%2015.77%200%200%200%2022.76%2010v6.77a13.53%2013.53%200%200%200%202.46%202.4%204.12%204.12%200%200%200%202.44.83%203.56%203.56%200%200%200%202-.57A4.28%204.28%200%200%200%2031%2018a7.58%207.58%200%200%200%20.77-2.12%2011.43%2011.43%200%200%200%20.23-2.36zM12%2017.3a5.39%205.39%200%200%201-.48%202.33%204.73%204.73%200%200%201-1.37%201.72%206.19%206.19%200%200%201-2.12%201.06%209.62%209.62%200%200%201-2.71.36%2010.38%2010.38%200%200%201-3.21-.5A7.63%207.63%200%200%201%201%2021.82a3.25%203.25%200%200%201-.66-.43%201.09%201.09%200%200%201-.3-.53%203.59%203.59%200%200%201-.04-.93%204.06%204.06%200%200%201%200-.61%202%202%200%200%201%20.09-.4.42.42%200%200%201%20.16-.22.43.43%200%200%201%20.24-.07%201.35%201.35%200%200%201%20.61.26q.41.26%201%20.56a9.22%209.22%200%200%200%201.41.55%206.25%206.25%200%200%200%201.87.26%205.62%205.62%200%200%200%201.44-.17%203.48%203.48%200%200%200%201.12-.5%202.23%202.23%200%200%200%20.73-.84%202.68%202.68%200%200%200%20.26-1.21%202%202%200%200%200-.37-1.21%203.55%203.55%200%200%200-1-.87%208.09%208.09%200%200%200-1.36-.66l-1.56-.61a16%2016%200%200%201-1.57-.73%206%206%200%200%201-1.37-1%204.52%204.52%200%200%201-1-1.4%204.69%204.69%200%200%201-.37-2%204.88%204.88%200%200%201%20.39-1.87%204.46%204.46%200%200%201%201.16-1.61%205.83%205.83%200%200%201%201.94-1.11A8.06%208.06%200%200%201%206.53%204a8.28%208.28%200%200%201%201.36.11%209.36%209.36%200%200%201%201.23.28%205.92%205.92%200%200%201%20.94.37%204.09%204.09%200%200%201%20.59.35%201%201%200%200%201%20.26.26.83.83%200%200%201%20.09.26%201.32%201.32%200%200%200%20.06.35%203.87%203.87%200%200%201%200%20.51%204.76%204.76%200%200%201%200%20.56%201.39%201.39%200%200%201-.09.39.5.5%200%200%201-.16.22.35.35%200%200%201-.21.07%201%201%200%200%201-.49-.21%207%207%200%200%200-.83-.44%209.26%209.26%200%200%200-1.2-.44%205.49%205.49%200%200%200-1.58-.16%204.93%204.93%200%200%200-1.4.18%202.69%202.69%200%200%200-1%20.51%202.16%202.16%200%200%200-.59.83%202.43%202.43%200%200%200-.2%201%202%202%200%200%200%20.38%201.24%203.6%203.6%200%200%200%201%20.88%208.25%208.25%200%200%200%201.38.68l1.58.62q.8.32%201.59.72a6%206%200%200%201%201.39%201%204.37%204.37%200%200%201%201%201.36%204.46%204.46%200%200%201%20.37%201.8z%22%20fill%3D%22%23fff%22%2F%3E%3C%2Fsvg%3E">
</div></div>`:"";this.parent.appendChild(this.dom=$e(`<div class="spine-player" style="position:relative;height:100%"><canvas class="spine-player-canvas" style="display:block;width:100%;height:100%"></canvas>${s}</div>`));try{this.validateConfig(t)}catch(r){this.showError(r.message,r)}this.initialize(),this.addEventListener(window,"resize",()=>this.drawFrame(!1)),requestAnimationFrame(()=>this.drawFrame())}dispose(){var i,s,r;(i=this.sceneRenderer)==null||i.dispose(),(s=this.loadingScreen)==null||s.dispose(),(r=this.assetManager)==null||r.dispose();for(var e=0;e<this.eventListeners.length;e++){var t=this.eventListeners[e];t.target.removeEventListener(t.event,t.func)}this.parent.removeChild(this.dom),this.disposed=!0}addEventListener(e,t,i){this.eventListeners.push({target:e,event:t,func:i}),e.addEventListener(t,i)}validateConfig(e){if(!e)throw new Error("A configuration object must be passed to to new SpinePlayer().");if(e.skelUrl&&(e.skeleton=e.skelUrl),!e.skeleton&&!e.jsonUrl&&!e.binaryUrl)throw new Error("A URL must be specified for the skeleton JSON or binary file.");if(e.scale||(e.scale=1),!e.atlas&&!e.atlasUrl)throw new Error("A URL must be specified for the atlas file.");if(e.jsonUrl&&!e.skeleton&&(e.skeleton=e.jsonUrl),e.binaryUrl&&!e.skeleton&&(e.skeleton=e.binaryUrl),e.atlasUrl&&!e.atlas&&(e.atlas=e.atlasUrl),e.backgroundColor||(e.backgroundColor=e.alpha?"00000000":"000000"),e.fullScreenBackgroundColor||(e.fullScreenBackgroundColor=e.backgroundColor),e.backgroundImage&&!e.backgroundImage.url&&(e.backgroundImage=void 0),e.premultipliedAlpha===void 0&&(e.premultipliedAlpha=!0),e.preserveDrawingBuffer===void 0&&(e.preserveDrawingBuffer=!1),e.mipmaps===void 0&&(e.mipmaps=!0),e.debug||(e.debug={bones:!1,clipping:!1,bounds:!1,hulls:!1,meshes:!1,paths:!1,points:!1,regions:!1}),e.animations&&e.animation&&e.animations.indexOf(e.animation)<0)throw new Error("Animation '"+e.animation+"' is not in the config animation list: "+is(e.animations));if(e.skins&&e.skin&&e.skins.indexOf(e.skin)<0)throw new Error("Default skin '"+e.skin+"' is not in the config skins list: "+is(e.skins));e.viewport||(e.viewport={}),e.viewport.animations||(e.viewport.animations={}),e.viewport.debugRender===void 0&&(e.viewport.debugRender=!1),e.viewport.transitionTime===void 0&&(e.viewport.transitionTime=.25),e.controlBones||(e.controlBones=[]),e.showLoading===void 0&&(e.showLoading=!0),e.defaultMix===void 0&&(e.defaultMix=.25)}initialize(){let e=this.config,t=this.dom;if(!e.alpha){let i=e.backgroundColor;this.dom.style.backgroundColor=(i.charAt(0)=="#"?i:"#"+i).substr(0,7)}try{this.canvas=Ze(t,"spine-player-canvas"),this.context=new Me(this.canvas,{alpha:e.alpha,preserveDrawingBuffer:e.preserveDrawingBuffer}),this.sceneRenderer=new Lr(this.canvas,this.context,!0),e.showLoading&&(this.loadingScreen=new Br(this.sceneRenderer))}catch(i){return this.showError(`Sorry, your browser does not support WebGL, or you have disabled WebGL in your browser settings.
Please use the latest version of Firefox, Chrome, Edge, or Safari.`,i),null}if(this.assetManager=new kr(this.context,"",e.downloader),e.rawDataURIs)for(let i in e.rawDataURIs)this.assetManager.setRawDataURI(i,e.rawDataURIs[i]);if(e.skeleton.endsWith(".json")?this.assetManager.loadJson(e.skeleton):this.assetManager.loadBinary(e.skeleton),this.assetManager.loadTextureAtlas(e.atlas),e.backgroundImage&&this.assetManager.loadTexture(e.backgroundImage.url),this.bg.setFromString(e.backgroundColor),this.bgFullscreen.setFromString(e.fullScreenBackgroundColor),e.showControls){this.playerControls=t.children[1];let i=this.playerControls.children,s=i[0],r=i[1].children;this.playButton=r[0];let o=r[2];this.animationButton=r[3],this.skinButton=r[4];let a=r[5],h=r[6],n=r[7];this.timelineSlider=new Ls,s.appendChild(this.timelineSlider.create()),this.timelineSlider.change=g=>{this.pause();let b=this.animationState.getCurrent(0).animation.duration*g;this.animationState.update(b-this.playTime),this.animationState.apply(this.skeleton),this.skeleton.update(b-this.playTime),this.skeleton.updateWorldTransform(Oe.update),this.playTime=b},this.playButton.onclick=()=>this.paused?this.play():this.pause(),o.onclick=()=>this.showSpeedDialog(o),this.animationButton.onclick=()=>this.showAnimationsDialog(this.animationButton),this.skinButton.onclick=()=>this.showSkinsDialog(this.skinButton),a.onclick=()=>this.showSettingsDialog(a);let l=this.canvas.clientWidth,c=this.canvas.clientHeight,u=this.canvas.style.width,f=this.canvas.style.height,m=!1;h.onclick=()=>{let g=()=>{m=!m,m||(this.canvas.style.width=l+"px",this.canvas.style.height=c+"px",this.drawFrame(!1),requestAnimationFrame(()=>{this.canvas.style.width=u,this.canvas.style.height=f}))},p=t;p.onfullscreenchange=g,p.onwebkitfullscreenchange=g;let b=document;b.fullscreenElement||b.webkitFullscreenElement||b.mozFullScreenElement||b.msFullscreenElement?b.exitFullscreen?b.exitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitExitFullscreen?b.webkitExitFullscreen():b.msExitFullscreen&&b.msExitFullscreen():(l=this.canvas.clientWidth,c=this.canvas.clientHeight,u=this.canvas.style.width,f=this.canvas.style.height,p.requestFullscreen?p.requestFullscreen():p.webkitRequestFullScreen?p.webkitRequestFullScreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.msRequestFullscreen&&p.msRequestFullscreen())},n.onclick=()=>window.open("http://esotericsoftware.com")}return t}loadSkeleton(){var c;if(this.error)return;this.assetManager.hasErrors()&&this.showError(`Error: Assets could not be loaded.
`+is(this.assetManager.getErrors()));let e=this.config,t=this.assetManager.require(e.atlas),i=this.context.gl,s=i.getExtension("EXT_texture_filter_anisotropic"),r=i.getParameter(i.VERSION).indexOf("WebGL 1.0")!=-1;for(let u of t.pages){let f=u.minFilter;var o=e.mipmaps,a=V.isPowerOfTwo(u.width)&&V.isPowerOfTwo(u.height);r&&!a&&(o=!1),o&&(s?(i.texParameterf(i.TEXTURE_2D,s.TEXTURE_MAX_ANISOTROPY_EXT,8),f=be.MipMapLinearLinear):f=be.Linear,u.texture.setFilters(f,be.Nearest)),f!=be.Nearest&&f!=be.Linear&&u.texture.update(!0)}let h;try{let u,f,m=new Oi(t);if(e.skeleton.endsWith(".json")){if(f=this.assetManager.remove(e.skeleton),!f)throw new Error("Empty JSON data.");if(e.jsonField&&(f=f[e.jsonField],!f))throw new Error("JSON field does not exist: "+e.jsonField);u=new Er(m)}else f=this.assetManager.remove(e.skeleton),u=new qi(m);u.scale=e.scale,h=u.readSkeletonData(f)}catch(u){this.showError(`Error: Could not load skeleton data.
${u.message}`,u);return}this.skeleton=new as(h);let n=new Yi(h);n.defaultMix=e.defaultMix,this.animationState=new rs(n),e.controlBones.forEach(u=>{h.findBone(u)||this.showError(`Error: Control bone does not exist in skeleton: ${u}`)}),!e.skin&&h.skins.length&&(e.skin=h.skins[0].name),e.skins&&e.skin.length&&e.skins.forEach(u=>{this.skeleton.data.findSkin(u)||this.showError(`Error: Skin in config list does not exist in skeleton: ${u}`)}),e.skin&&(this.skeleton.data.findSkin(e.skin)||this.showError(`Error: Skin does not exist in skeleton: ${e.skin}`),this.skeleton.setSkinByName(e.skin),this.skeleton.setSlotsToSetupPose()),Object.getOwnPropertyNames(e.viewport.animations).forEach(u=>{h.findAnimation(u)||this.showError(`Error: Animation for which a viewport was specified does not exist in skeleton: ${u}`)}),e.animations&&e.animations.length&&(e.animations.forEach(u=>{this.skeleton.data.findAnimation(u)||this.showError(`Error: Animation in config list does not exist in skeleton: ${u}`)}),e.animation||(e.animation=e.animations[0])),e.animation&&!h.findAnimation(e.animation)&&this.showError(`Error: Animation does not exist in skeleton: ${e.animation}`),this.setupInput(),e.showControls&&((h.skins.length==1||e.skins&&e.skins.length==1)&&this.skinButton.classList.add("spine-player-hidden"),(h.animations.length==1||e.animations&&e.animations.length==1)&&this.animationButton.classList.add("spine-player-hidden")),e.success&&e.success(this);let l=this.animationState.getCurrent(0);l?(this.currentViewport.x===void 0&&this.setViewport(l.animation),e.animation||(e.animation=(c=l.animation)==null?void 0:c.name),this.play()):e.animation?(l=this.setAnimation(e.animation),this.play()):(l=this.animationState.setEmptyAnimation(0),l.trackEnd=1e8,this.skeleton.updateWorldTransform(Oe.update),this.setViewport(l.animation),this.pause())}setupInput(){let e=this.config,t=e.controlBones;if(!t.length&&!e.showControls)return;let i=this.selectedBones=new Array(t.length),s=this.canvas,r=null,o=new qe,a=new et,h=new et,n=new qe,l=this.skeleton,c=this.sceneRenderer,u=function(f,m){h.set(f,s.clientHeight-m,0),o.x=o.y=0;let g=24,p=0,b=null;for(let y=0;y<t.length;y++){i[y]=null;let w=l.findBone(t[y]);if(!w)continue;let x=c.camera.worldToScreen(a.set(w.worldX,w.worldY,0),s.clientWidth,s.clientHeight).distance(h);x<g&&(g=x,b=w,p=y,o.x=a.x-h.x,o.y=a.y-h.y)}return b&&(i[p]=b),b};if(new Si(s).addListener({down:(f,m)=>{r=u(f,m)},up:()=>{r?r=null:e.showControls&&(this.paused?this.play():this.pause())},dragged:(f,m)=>{r&&(f=V.clamp(f+o.x,0,s.clientWidth),m=V.clamp(m-o.y,0,s.clientHeight),c.camera.screenToWorld(a.set(f,m,0),s.clientWidth,s.clientHeight),r.parent?(r.parent.worldToLocal(n.set(a.x-l.x,a.y-l.y)),r.x=n.x,r.y=n.y):(r.x=a.x-l.x,r.y=a.y-l.y))},moved:(f,m)=>u(f,m)}),e.showControls){this.addEventListener(document,"mousemove",b=>{b instanceof MouseEvent&&p(b.clientX,b.clientY)}),this.addEventListener(document,"touchmove",b=>{if(b instanceof TouchEvent){let y=b.changedTouches;if(y.length){let w=y[0];p(w.clientX,w.clientY)}}});let f=(b,y,w)=>{let x=b-w.left,A=y-w.top;return x>=0&&x<=w.width&&A>=0&&A<=w.height},m=!0,g=!1,p=(b,y)=>{let w=Ze(this.dom,"spine-player-popup");m=f(b,y,this.playerControls.getBoundingClientRect()),g=f(b,y,s.getBoundingClientRect()),clearTimeout(this.cancelId),!w&&!m&&!g&&!this.paused?this.playerControls.classList.add("spine-player-controls-hidden"):this.playerControls.classList.remove("spine-player-controls-hidden"),!m&&!w&&!this.paused&&(this.cancelId=setTimeout(()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")},1e3))}}}play(){this.paused=!1;let e=this.config;e.showControls&&(this.cancelId=setTimeout(()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")},1e3),this.playButton.classList.remove("spine-player-button-icon-play"),this.playButton.classList.add("spine-player-button-icon-pause"),e.animation||(e.animations&&e.animations.length?e.animation=e.animations[0]:this.skeleton.data.animations.length&&(e.animation=this.skeleton.data.animations[0].name),e.animation&&this.setAnimation(e.animation)))}pause(){this.paused=!0,this.config.showControls&&(this.playerControls.classList.remove("spine-player-controls-hidden"),clearTimeout(this.cancelId),this.playButton.classList.remove("spine-player-button-icon-pause"),this.playButton.classList.add("spine-player-button-icon-play"))}setAnimation(e,t=!0){return e=this.setViewport(e),this.animationState.setAnimationWith(0,e,t)}addAnimation(e,t=!0,i=0){return e=this.setViewport(e),this.animationState.addAnimationWith(0,e,t,i)}setViewport(e){if(typeof e=="string"){let r=this.skeleton.data.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);e=r}this.previousViewport=this.currentViewport;let t=this.config.viewport,i=this.currentViewport={padLeft:t.padLeft!==void 0?t.padLeft:"10%",padRight:t.padRight!==void 0?t.padRight:"10%",padTop:t.padTop!==void 0?t.padTop:"10%",padBottom:t.padBottom!==void 0?t.padBottom:"10%"};t.x!==void 0&&t.y!==void 0&&t.width&&t.height?(i.x=t.x,i.y=t.y,i.width=t.width,i.height=t.height):this.calculateAnimationViewport(e,i);let s=this.config.viewport.animations[e.name];return s&&(s.x!==void 0&&s.y!==void 0&&s.width&&s.height&&(i.x=s.x,i.y=s.y,i.width=s.width,i.height=s.height),s.padLeft!==void 0&&(i.padLeft=s.padLeft),s.padRight!==void 0&&(i.padRight=s.padRight),s.padTop!==void 0&&(i.padTop=s.padTop),s.padBottom!==void 0&&(i.padBottom=s.padBottom)),i.padLeft=this.percentageToWorldUnit(i.width,i.padLeft),i.padRight=this.percentageToWorldUnit(i.width,i.padRight),i.padBottom=this.percentageToWorldUnit(i.height,i.padBottom),i.padTop=this.percentageToWorldUnit(i.height,i.padTop),this.viewportTransitionStart=performance.now(),e}percentageToWorldUnit(e,t){return typeof t=="string"?e*parseFloat(t.substr(0,t.length-1))/100:t}calculateAnimationViewport(e,t){this.skeleton.setToSetupPose();let i=100,s=e.duration?e.duration/i:0,r=0,o=1e8,a=-1e8,h=1e8,n=-1e8,l=new qe,c=new qe;const u=new Array(2);for(let f=0;f<i;f++,r+=s)e.apply(this.skeleton,r,r,!1,[],1,P.setup,Ce.mixIn),this.skeleton.updateWorldTransform(Oe.update),this.skeleton.getBounds(l,c,u,this.sceneRenderer.skeletonRenderer.getSkeletonClipping()),!isNaN(l.x)&&!isNaN(l.y)&&!isNaN(c.x)&&!isNaN(c.y)?(o=Math.min(l.x,o),a=Math.max(l.x+c.x,a),h=Math.min(l.y,h),n=Math.max(l.y+c.y,n)):this.showError("Animation bounds are invalid: "+e.name);t.x=o,t.y=h,t.width=a-o,t.height=n-h}drawFrame(e=!0){try{if(this.error||this.disposed)return;e&&!this.stopRequestAnimationFrame&&requestAnimationFrame(()=>this.drawFrame());let t=document,s=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement?this.bgFullscreen:this.bg;this.time.update();let r=this.time.delta,o=!this.assetManager.isLoadingComplete();!this.skeleton&&!o&&this.loadSkeleton();let a=this.skeleton,h=this.config;if(a){let n=this.sceneRenderer;n.resize(bt.Expand);let l=this.paused?0:r*this.speed;if(h.frame&&h.frame(this,l),!this.paused&&(a.update(l),this.animationState.update(l),this.animationState.apply(a),h.updateWorldTransform?h.updateWorldTransform(this,l):a.updateWorldTransform(Oe.update),h.showControls)){this.playTime+=l;let g=this.animationState.getCurrent(0);if(g){let p=g.animation.duration;for(;this.playTime>=p&&p!=0;)this.playTime-=p;this.playTime=Math.max(0,Math.min(this.playTime,p)),this.timelineSlider.setValue(this.playTime/p)}}let c=this.viewport;if(c.x=this.currentViewport.x-this.currentViewport.padLeft,c.y=this.currentViewport.y-this.currentViewport.padBottom,c.width=this.currentViewport.width+this.currentViewport.padLeft+this.currentViewport.padRight,c.height=this.currentViewport.height+this.currentViewport.padBottom+this.currentViewport.padTop,this.previousViewport){let g=(performance.now()-this.viewportTransitionStart)/1e3/h.viewport.transitionTime;if(g<1){let p=this.previousViewport.x-this.previousViewport.padLeft,b=this.previousViewport.y-this.previousViewport.padBottom,y=this.previousViewport.width+this.previousViewport.padLeft+this.previousViewport.padRight,w=this.previousViewport.height+this.previousViewport.padBottom+this.previousViewport.padTop;c.x=p+(c.x-p)*g,c.y=b+(c.y-b)*g,c.width=y+(c.width-y)*g,c.height=w+(c.height-w)*g}}n.camera.zoom=this.canvas.height/this.canvas.width>c.height/c.width?c.width/this.canvas.width:c.height/this.canvas.height,n.camera.position.x=c.x+c.width/2,n.camera.position.y=c.y+c.height/2;let u=this.context.gl;u.clearColor(s.r,s.g,s.b,s.a),u.clear(u.COLOR_BUFFER_BIT),h.update&&h.update(this,l),n.begin();let f=h.backgroundImage;if(f){let g=this.assetManager.require(f.url);f.x!==void 0&&f.y!==void 0&&f.width&&f.height?n.drawTexture(g,f.x,f.y,f.width,f.height):n.drawTexture(g,c.x,c.y,c.width,c.height)}n.drawSkeleton(a,h.premultipliedAlpha),Number(n.skeletonDebugRenderer.drawBones=h.debug.bones??!1)+Number(n.skeletonDebugRenderer.drawBoundingBoxes=h.debug.bounds??!1)+Number(n.skeletonDebugRenderer.drawClipping=h.debug.clipping??!1)+Number(n.skeletonDebugRenderer.drawMeshHull=h.debug.hulls??!1)+Number(n.skeletonDebugRenderer.drawPaths=h.debug.paths??!1)+Number(n.skeletonDebugRenderer.drawRegionAttachments=h.debug.regions??!1)+Number(n.skeletonDebugRenderer.drawMeshTriangles=h.debug.meshes??!1)>0&&n.drawSkeletonDebug(a,h.premultipliedAlpha);let m=h.controlBones;if(m.length){let g=this.selectedBones;u.lineWidth(2);for(let p=0;p<m.length;p++){let b=a.findBone(m[p]);if(!b)continue;let y=g[p]?Dr:zr,w=g[p]?Ur:Wr;n.circle(!0,a.x+b.worldX,a.y+b.worldY,20,y),n.circle(!1,a.x+b.worldX,a.y+b.worldY,20,w)}}h.viewport.debugRender&&(u.lineWidth(1),n.rect(!1,this.currentViewport.x,this.currentViewport.y,this.currentViewport.width,this.currentViewport.height,N.GREEN),n.rect(!1,c.x,c.y,c.width,c.height,N.RED)),n.end(),h.draw&&h.draw(this,l)}h.showLoading&&(this.loadingScreen.backgroundColor.setFromColor(s),this.loadingScreen.draw(!o)),o&&h.loading&&h.loading(this,r)}catch(t){this.showError(`Error: Unable to render skeleton.
${t.message}`,t)}}startRendering(){this.stopRequestAnimationFrame=!1,requestAnimationFrame(()=>this.drawFrame())}stopRendering(){this.stopRequestAnimationFrame=!0}hidePopup(e){return this.popup!=null&&this.popup.hide(e)}showSpeedDialog(e){let t="speed";if(this.hidePopup(t))return;let i=new Xt(t,e,this,this.playerControls,`
<div class="spine-player-popup-title">Speed</div>
<hr>
<div class="spine-player-row" style="align-items:center;padding:8px">
<div class="spine-player-column">
	<div class="spine-player-speed-slider" style="margin-bottom:4px"></div>
	<div class="spine-player-row" style="justify-content:space-between"><div>0.1x</div><div>1x</div><div>2x</div></div>
</div>
</div>`),s=new Ls(2,.1,!0);Ze(i.dom,"spine-player-speed-slider").appendChild(s.create()),s.setValue(this.speed/2),s.change=r=>this.speed=r*2,i.show()}showAnimationsDialog(e){let t="animations";if(this.hidePopup(t)||!this.skeleton||!this.skeleton.data.animations.length)return;let i=new Xt(t,e,this,this.playerControls,'<div class="spine-player-popup-title">Animations</div><hr><ul class="spine-player-list"></ul>'),s=Ze(i.dom,"spine-player-list");this.skeleton.data.animations.forEach(r=>{if(this.config.animations&&this.config.animations.indexOf(r.name)<0)return;let o=$e('<li class="spine-player-list-item selectable"><div class="selectable-circle"></div><div class="selectable-text"></div></li>');r.name==this.config.animation&&o.classList.add("selected"),Ze(o,"selectable-text").innerText=r.name,s.appendChild(o),o.onclick=()=>{Xs(s.children,"selected"),o.classList.add("selected"),this.config.animation=r.name,this.playTime=0,this.setAnimation(r.name),this.play()}}),i.show()}showSkinsDialog(e){let t="skins";if(this.hidePopup(t)||!this.skeleton||!this.skeleton.data.animations.length)return;let i=new Xt(t,e,this,this.playerControls,'<div class="spine-player-popup-title">Skins</div><hr><ul class="spine-player-list"></ul>'),s=Ze(i.dom,"spine-player-list");this.skeleton.data.skins.forEach(r=>{if(this.config.skins&&this.config.skins.indexOf(r.name)<0)return;let o=$e('<li class="spine-player-list-item selectable"><div class="selectable-circle"></div><div class="selectable-text"></div></li>');r.name==this.config.skin&&o.classList.add("selected"),Ze(o,"selectable-text").innerText=r.name,s.appendChild(o),o.onclick=()=>{Xs(s.children,"selected"),o.classList.add("selected"),this.config.skin=r.name,this.skeleton.setSkinByName(this.config.skin),this.skeleton.setSlotsToSetupPose()}}),i.show()}showSettingsDialog(e){let t="settings";if(this.hidePopup(t)||!this.skeleton||!this.skeleton.data.animations.length)return;let i=new Xt(t,e,this,this.playerControls,'<div class="spine-player-popup-title">Debug</div><hr><ul class="spine-player-list"></li>'),s=Ze(i.dom,"spine-player-list"),r=(o,a)=>{let h=$e('<li class="spine-player-list-item"></li>'),n=new Nr(o);h.appendChild(n.create());let l=this.config.debug;n.setEnabled(l[a]),n.change=c=>l[a]=c,s.appendChild(h)};r("Bones","bones"),r("Regions","regions"),r("Meshes","meshes"),r("Bounds","bounds"),r("Paths","paths"),r("Clipping","clipping"),r("Points","points"),r("Hulls","hulls"),i.show()}showError(e,t){if(this.error){if(t)throw t}else throw this.error=!0,this.dom.appendChild($e('<div class="spine-player-error" style="background:#000;color:#fff;position:absolute;top:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;overflow:auto;z-index:999">'+e.replace(`
`,"<br><br>")+"</div>")),this.config.error&&this.config.error(this,e),t||new Error(e)}}class Xt{constructor(e,t,i,s,r){d(this,"id");d(this,"button");d(this,"player");d(this,"dom");d(this,"className");d(this,"windowClickListener");this.id=e,this.button=t,this.player=i,this.dom=$e('<div class="spine-player-popup spine-player-hidden"></div>'),this.dom.innerHTML=r,s.appendChild(this.dom),this.className="spine-player-button-icon-"+e+"-selected"}dispose(){}hide(e){return this.dom.remove(),this.button.classList.remove(this.className),this.id==e?(this.player.popup=null,!0):!1}show(){this.player.popup=this,this.button.classList.add(this.className),this.dom.classList.remove("spine-player-hidden");let e=!1,t=()=>{e||requestAnimationFrame(t);let r=this.player.dom,o=Math.abs(r.getBoundingClientRect().bottom-r.getBoundingClientRect().bottom),a=Math.abs(r.getBoundingClientRect().right-r.getBoundingClientRect().right);this.dom.style.maxHeight=r.clientHeight-o-a+"px"};requestAnimationFrame(t);let i=!0,s=r=>{if(i||this.player.popup!=this){i=!1;return}this.dom.contains(r.target)||(this.dom.remove(),window.removeEventListener("click",s),this.button.classList.remove(this.className),this.player.popup=null,e=!0)};this.player.addEventListener(window,"click",s)}}class Nr{constructor(e){d(this,"text");d(this,"switch",null);d(this,"enabled",!1);d(this,"change",()=>{});this.text=e}create(){return this.switch=$e(`
<div class="spine-player-switch">
	<span class="spine-player-switch-text">${this.text}</span>
	<div class="spine-player-switch-knob-area">
		<div class="spine-player-switch-knob"></div>
	</div>
</div>`),this.switch.addEventListener("click",()=>{this.setEnabled(!this.enabled),this.change&&this.change(this.enabled)}),this.switch}setEnabled(e){var t,i;e?(t=this.switch)==null||t.classList.add("active"):(i=this.switch)==null||i.classList.remove("active"),this.enabled=e}isEnabled(){return this.enabled}}class Ls{constructor(e=0,t=.1,i=!1){d(this,"snaps");d(this,"snapPercentage");d(this,"big");d(this,"slider",null);d(this,"value",null);d(this,"knob",null);d(this,"change",()=>{});this.snaps=e,this.snapPercentage=t,this.big=i}create(){this.slider=$e(`
<div class="spine-player-slider ${this.big?"big":""}">
	<div class="spine-player-slider-value"></div>
	<!--<div class="spine-player-slider-knob"></div>-->
</div>`),this.value=Ze(this.slider,"spine-player-slider-value"),this.setValue(0);let e=!1;return new Si(this.slider).addListener({down:(t,i)=>{var s;e=!0,(s=this.value)==null||s.classList.add("hovering")},up:(t,i)=>{var s;e=!1,this.change&&this.change(this.setValue(t/this.slider.clientWidth)),(s=this.value)==null||s.classList.remove("hovering")},moved:(t,i)=>{e&&this.change&&this.change(this.setValue(t/this.slider.clientWidth))},dragged:(t,i)=>{this.change&&this.change(this.setValue(t/this.slider.clientWidth))}}),this.slider}setValue(e){if(e=Math.max(0,Math.min(1,e)),this.snaps){let t=1/this.snaps,i=e%t;i<t*this.snapPercentage?e=e-i:i>t-t*this.snapPercentage&&(e=e-i+t),e=Math.max(0,Math.min(1,e))}return this.value.style.width=""+e*100+"%",e}}function Ze(C,e){return C.getElementsByClassName(e)[0]}function $e(C){let e=document.createElement("div");return e.innerHTML=C,e.children[0]}function Xs(C,e){for(let t=0;t<C.length;t++)C[t].classList.remove(e)}function is(C){return JSON.stringify(C).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").replace(/'/g,"&#39;")}const Dr=new N(.478,0,0,.25),Ur=new N(1,1,1,1),zr=new N(.478,0,0,.5),Wr=new N(1,0,0,.8),dt=(C,e)=>new Promise(t=>{const i=new FileReader;i.onload=s=>{const r=s.target.result,o=typeof r=="string"?new TextEncoder().encode(r):new Uint8Array(r);let a="";o.forEach(h=>a+=String.fromCharCode(h)),t(`data:${e};base64,${btoa(a)}`)},C.type.startsWith("text/")?i.readAsText(C):i.readAsArrayBuffer(C)});async function qr(C){const e=new Map,t=(s,r)=>{e.has(s)||e.set(s,[]),e.get(s).push(r)},i=async s=>{if(s.isFile){const r=await new Promise(a=>s.file(a)),o=r.name.split(".").pop();console.log("Collected file:",r.name),t(o,r)}else if(s.isDirectory){const r=s.createReader(),o=await new Promise(a=>r.readEntries(a));for(const a of o)await i(a)}};for(const s of C){const r=s.webkitGetAsEntry&&s.webkitGetAsEntry();r&&await i(r)}if(e.has("json")||e.has("skel")){const s=e.has("json")?"json":"skel",r=e.get(s)[0],o=new FileReader;o.onload=async a=>{const h=a.target.result;await Promise.all([...(e.get("atlas")||[]).map(n=>dt(n,"text/plain")),...(e.get("png")||[]).map(n=>dt(n,"image/png"))]),Gr(h,e,s)},s==="json"?o.readAsText(r):o.readAsArrayBuffer(r)}}async function Gr(C,e,t){const i={[`${e.get(t)[0].name}`]:t==="json"?await dt(e.get(t)[0],"application/json"):await dt(e.get(t)[0],"application/octet-stream"),...e.has("atlas")?{[e.get("atlas")[0].name]:await dt(e.get("atlas")[0],"text/plain")}:{},...Object.fromEntries(await Promise.all(Array.from(e.get("png")||[]).map(async r=>[r.name,await dt(r,"image/png")])))},s={skeleton:e.get(t)[0].name,atlas:e.get("atlas")[0].name,premultipliedAlpha:!e.has("atlas"),debug:{bones:!1,regions:!1},rawDataURIs:i,format:t==="skel"?"binary":"json",success:r=>{}};new Or("player-container",s)}const yt=document.getElementById("drop-area");["dragenter","dragover","dragleave","drop"].forEach(C=>{yt.addEventListener(C,Hr,!1)});function Hr(C){C.preventDefault(),C.stopPropagation()}["dragenter","dragover"].forEach(C=>{yt.addEventListener(C,()=>yt.classList.add("highlight"),!1)});["dragleave","drop"].forEach(C=>{yt.addEventListener(C,()=>yt.classList.remove("highlight"),!1)});yt.addEventListener("drop",jr,!1);function jr(C){const t=[...C.dataTransfer.items];qr(t)}
